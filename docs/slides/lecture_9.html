<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 9</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="lecture-9-practical-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Lecture 9: <br> Practical regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-lecture-9" class="slide level2 smaller">
<h2>Outline of Lecture 9</h2>
<ol type="1">
<li>Plotting variables in R
<ul>
<li>Cross-check formal statistical results with graphical analyses</li>
<li>Important in practical research work</li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li>Coefficient of determination <span class="math inline">R^2</span>
<ul>
<li><span class="math inline">R^2</span> measures proportion of variability in the data explained by the model</li>
<li><span class="math inline">R^2</span> close to <span class="math inline">1 \implies</span> Model exaplains data well</li>
<li>Any <span class="math inline">R^2</span> larger than <span class="math inline">0.3</span> is potentially interesting</li>
</ul></li>
</ol>
</section>
<section id="outline-of-lecture-9-1" class="slide level2 smaller">
<h2>Outline of Lecture 9</h2>
<ol start="3" type="1">
<li>t-test for simple regression
<ul>
<li>Test the significance of the slope parameter</li>
</ul></li>
<li>t-test for general regression
<ul>
<li>Test the significance of regression parameters</li>
</ul></li>
<li>F-test for multiple regression
<ul>
<li>Test the Overall Significance of the parameters</li>
</ul></li>
<li>Worked Example: The Longley dataset
<ul>
<li>Classic example of highly collinear dataset</li>
</ul></li>
</ol>
</section></section>
<section>
<section id="part-1-plotting-variables-in-r" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Plotting variables in R</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="plotting-variables-in-r" class="slide level2 smaller">
<h2>Plotting variables in R</h2>
<p>Interested in relationship between 2 variables</p>
<ul>
<li><p>Want to plot the 2 variables together</p></li>
<li><p>Cross-check the results of a formal statistical analysis</p></li>
<li><p>Very important in real project work</p></li>
</ul>
</section>
<section id="example-stock-and-gold-prices" class="slide level2">
<h2>Example: Stock and Gold prices</h2>
<div style="font-size: 0.75em">
<p>Dataset with <span class="math inline">33</span> entries for Stock and Gold price pairs</p>
</div>
<div style="font-size: 0.55em">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<table class="kable_wrapper caption-top" data-quarto-postprocess="true">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><table class="table simple table-striped table-hover caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Stock Price</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gold Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">3.230426</td>
<td style="text-align: right;">9.402434</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">2.992937</td>
<td style="text-align: right;">8.987918</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">2.194025</td>
<td style="text-align: right;">10.120387</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.602475</td>
<td style="text-align: right;">9.367327</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">2.963497</td>
<td style="text-align: right;">8.708742</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">4.224242</td>
<td style="text-align: right;">8.494215</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">7.433981</td>
<td style="text-align: right;">8.739684</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">5.060836</td>
<td style="text-align: right;">8.609681</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">3.903316</td>
<td style="text-align: right;">7.552746</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">4.260542</td>
<td style="text-align: right;">9.834538</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">3.469490</td>
<td style="text-align: right;">9.406448</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table class="table simple table-striped table-hover caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Stock Price</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gold Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">2.948513</td>
<td style="text-align: right;">10.62240</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: right;">3.354562</td>
<td style="text-align: right;">13.12062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: right;">3.930106</td>
<td style="text-align: right;">15.05097</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: right;">3.693491</td>
<td style="text-align: right;">13.39932</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: right;">3.076129</td>
<td style="text-align: right;">15.34968</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: right;">2.934277</td>
<td style="text-align: right;">14.83910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: right;">2.658664</td>
<td style="text-align: right;">16.01850</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: right;">2.450606</td>
<td style="text-align: right;">17.25952</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: right;">2.489758</td>
<td style="text-align: right;">18.26270</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: right;">2.591093</td>
<td style="text-align: right;">18.13104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22</td>
<td style="text-align: right;">2.520800</td>
<td style="text-align: right;">20.20052</td>
</tr>
</tbody>
</table></td>
<td style="text-align: left;"><table class="table simple table-striped table-hover caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Stock Price</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gold Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23</td>
<td style="text-align: right;">2.471447</td>
<td style="text-align: right;">24.13767</td>
</tr>
<tr class="even">
<td style="text-align: left;">24</td>
<td style="text-align: right;">2.062430</td>
<td style="text-align: right;">30.07695</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: right;">1.805153</td>
<td style="text-align: right;">35.69485</td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: right;">1.673950</td>
<td style="text-align: right;">39.29658</td>
</tr>
<tr class="odd">
<td style="text-align: left;">27</td>
<td style="text-align: right;">1.620848</td>
<td style="text-align: right;">39.52317</td>
</tr>
<tr class="even">
<td style="text-align: left;">28</td>
<td style="text-align: right;">1.547374</td>
<td style="text-align: right;">36.12564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">29</td>
<td style="text-align: right;">1.721679</td>
<td style="text-align: right;">31.01106</td>
</tr>
<tr class="even">
<td style="text-align: left;">30</td>
<td style="text-align: right;">1.974891</td>
<td style="text-align: right;">29.60810</td>
</tr>
<tr class="odd">
<td style="text-align: left;">31</td>
<td style="text-align: right;">2.168978</td>
<td style="text-align: right;">35.00593</td>
</tr>
<tr class="even">
<td style="text-align: left;">32</td>
<td style="text-align: right;">2.277214</td>
<td style="text-align: right;">37.62929</td>
</tr>
<tr class="odd">
<td style="text-align: left;">33</td>
<td style="text-align: right;">2.993353</td>
<td style="text-align: right;">41.45828</td>
</tr>
</tbody>
</table></td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="example-stock-and-gold-prices-1" class="slide level2 smaller">
<h2>Example: Stock and Gold prices</h2>
<ul>
<li><p>The data is stored in a <code>.txt</code> file</p></li>
<li><p>The file can be downloaded here <a href="datasets/stock_gold.txt">stock_gold.txt</a></p></li>
</ul>
<div class="column" style="width:54%;">
<ul>
<li>The text file looks like this <img data-src="images/stock_gold.png" style="width:73.0%"></li>
</ul>
</div><div class="column" style="width:44%;">
<ul>
<li>Remarks:
<ul>
<li>There is a Header</li>
<li>1st column lists <em>Stock Price</em></li>
<li>2nd column lists <em>Gold Price</em></li>
</ul></li>
</ul>
</div></section>
<section id="reading-data-into-r" class="slide level2 smaller">
<h2>Reading data into R</h2>
<p>To read <code>stock_gold.txt</code> into R proceed as follows:</p>
<ol type="1">
<li><p>Download <a href="datasets/stock_gold.txt">stock_gold.txt</a> and move file to Desktop</p></li>
<li><p>Open the R Console and change working directory to <strong>Desktop</strong></p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># In MacOS type</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/Desktop"</span>)</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># In Windows type</span></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/YourUsername/Desktop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="reading-data-into-r-1" class="slide level2 smaller">
<h2>Reading data into R</h2>
<ol start="3" type="1">
<li>Read <code>stock_gold.txt</code> into R and store it in data-frame <code>prices</code> with code</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a>prices <span class="ot">=</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"stock_gold.txt"</span>,</span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p><strong>Note:</strong> We are telling <code>read.table()</code> that</p>
<ul>
<li><code>stock_gold.txt</code> has a header</li>
<li>Headers are <em>optional</em></li>
<li>Headers are good practice to describe data</li>
</ul>
</section>
<section id="reading-data-into-r-2" class="slide level2 smaller">
<h2>Reading data into R</h2>
<ol start="4" type="1">
<li>Double check that we loaded the correct data file</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   stock_price gold_price
1     3.230426   9.402434
2     2.992937   8.987918
3     2.194025  10.120387
4     2.602475   9.367327
5     2.963497   8.708742
6     4.224242   8.494215
7     7.433981   8.739684
8     5.060836   8.609681
9     3.903316   7.552746
10    4.260542   9.834538
11    3.469490   9.406449
12    2.948513  10.622398
13    3.354562  13.120620
14    3.930106  15.050968
15    3.693491  13.399324
16    3.076129  15.349677
17    2.934277  14.839097
18    2.658664  16.018502
19    2.450606  17.259515
20    2.489758  18.262699
21    2.591093  18.131039
22    2.520801  20.200525
23    2.471447  24.137667
24    2.062430  30.076947
25    1.805153  35.694847
26    1.673950  39.296579
27    1.620848  39.523171
28    1.547374  36.125635
29    1.721679  31.011062
30    1.974891  29.608098
31    2.168978  35.005929
32    2.277215  37.629288
33    2.993353  41.458284</code></pre>
</div>
</div>
</section>
<section id="store-data-into-vectors" class="slide level2 smaller">
<h2>Store data into vectors</h2>
<ul>
<li>We now store Stock and Gold prices in 2 vectors
<ul>
<li>Stock prices are in 1st column of <code>prices</code></li>
<li>Gold prices are in 2nd column of <code>prices</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a>stock.price <span class="ot">&lt;-</span> prices[ , <span class="dv">1</span>]</span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>gold.price <span class="ot">&lt;-</span> prices[ , <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>Alternatively the same can be achieved with</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>stock.price <span class="ot">&lt;-</span> prices<span class="sc">$</span>stock_price</span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a>gold.price <span class="ot">&lt;-</span> prices<span class="sc">$</span>gold_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="plot-stock-price-vs-gold-price" class="slide level2 smaller">
<h2>Plot Stock Price vs Gold Price</h2>
<div class="columns" style="display: flex !important; height: 80%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stock.price, </span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>     gold.price, </span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Stock Price"</span>, </span>
<span id="cb7-4"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Gold Price"</span>,</span>
<span id="cb7-5"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb7-6"><a aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_9_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="plot-stock-price-vs-gold-price-1" class="slide level2 smaller">
<h2>Plot Stock Price vs Gold Price</h2>
<div class="columns" style="display: flex !important; height: 80%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p><code>xlab</code> and <code>ylab</code> specify axes labels</p></li>
<li><p><code>pch</code> specifies type of points</p></li>
<li><p>Scaling is achieved with</p>
<ul>
<li><code>xlim = c(lower, upper)</code></li>
<li><code>ylim = c(lower, upper)</code></li>
</ul></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_9_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="examining-the-graph" class="slide level2 smaller">
<h2>Examining the graph</h2>
<div class="columns" style="display: flex !important; height: 80%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p>Graph suggests that the 2 variables are negatively correlated</p></li>
<li><p>Need to cross-check with the results of a formal statistical regression analysis</p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_9_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="part-2-coefficient-of-determination-r2" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Coefficient of <br> determination <span class="math inline">R^2</span></h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="coefficient-of-determination-r2" class="slide level2 smaller">
<h2>Coefficient of determination <span class="math inline">R^2</span></h2>
<ul>
<li><span class="math inline">R^2</span> is defined as</li>
</ul>
<p><span class="math display">
R^2  = 1 - \frac{ \mathop{\mathrm{RSS}}}{ \mathop{\mathrm{TSS}}}
</span></p>
<ul>
<li><p><span class="math inline">R^2</span> measures proportion of variability in the data explained by the model</p></li>
<li><p>Recall that <span class="math inline">R^2 \leq 1</span></p></li>
</ul>
<div id="Important*-3.1" class="Important">
<details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div>
<ul>
<li><span class="math inline">R^2</span> is automatically computed by R when using <code>lm</code></li>
<li><strong>High</strong> values of <span class="math inline">R^2</span> are <strong>better</strong>! (that is, values of <span class="math inline">R^2</span> close to <span class="math inline">1</span>)</li>
</ul>
</div></details>
</div>
</section>
<section id="some-observations-about-r2" class="slide level2 smaller">
<h2>Some observations about <span class="math inline">R^2</span></h2>
<div id="Warning*-3.2" class="Warning">
<p></p><details class="Warning fbx-simplebox fbx-default" open=""><summary><strong>Warning</strong></summary><div><span class="math inline">R^2</span> increases as more <span class="math inline">X</span> variables are added to a regression model<p></p>
</div></details>
</div>
<p>This is not necessarily good</p>
<ul>
<li><p>One can add lots of variables and make <span class="math inline">R^2 \approx 1</span></p></li>
<li><p>This way the model explains the data really well <span class="math display">
  y_i \approx \hat y_i \,, \quad \forall \,\, i = 1 , \ldots, n
  </span></p></li>
<li><p>Problem: the model will not make good predictions on new data</p></li>
<li><p>This is known as <strong>overfitting</strong> and it should be avoided<br>
(more on this later)</p></li>
</ul>
</section>
<section id="some-observations-about-r2-1" class="slide level2 smaller">
<h2>Some observations about <span class="math inline">R^2</span></h2>
<ul>
<li><p>For multiple regression <span class="math inline">R^2</span> lies between <span class="math inline">0</span> and <span class="math inline">1</span></p>
<ul>
<li><span class="math inline">R^2 = 0</span> model explains nothing</li>
<li><span class="math inline">R^2 = 1</span> model explains everything</li>
</ul></li>
<li><p><strong>Warning:</strong> <span class="math inline">R^2</span> can be negative for general linear regression (no intercept)</p></li>
<li><p>Generally: the higher the value of <span class="math inline">R^2</span> the better the model</p>
<ul>
<li>Textbook examples often have high values <span class="math display">
  R^2 \geq 0.7
  </span></li>
<li><strong>Example:</strong> In the <em>Unemployment</em> example of Lecture 8 we found <span class="math display">
  R^2 = 0.8655401
  </span></li>
</ul></li>
</ul>
</section>
<section id="some-observations-about-r2-2" class="slide level2 smaller">
<h2>Some observations about <span class="math inline">R^2</span></h2>
<div id="Important*-3.3" class="Important">
<p></p><details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div>In practice values <span class="math display">
R^2 \geq 0.3
</span> imply there is a nontrivial amount of variation in the data explained by the model<p></p>
</div></details>
</div>
<p><strong>Example:</strong> In the <em>Stock Price</em> Vs <em>Gold Price</em> example we have <span class="math display">
R^2 = 0.395325
</span></p>
<ul>
<li>This shows that <em>Stock Price</em> affects <em>Gold Price</em></li>
<li>Since <span class="math inline">R^2</span> is not too large, also other factors may affect <em>Gold Price</em></li>
</ul>
</section>
<section id="regression-in-r" class="slide level2 smaller">
<h2>Regression in R</h2>
<ul>
<li>The basic R command used to run regression is</li>
</ul>
<div class="r-stack">
<p><code>lm(formula)</code></p>
</div>
<p><br></p>
<ul>
<li><code>lm</code> stands for <strong>linear model</strong></li>
</ul>
</section>
<section id="simple-linear-regression-in-r" class="slide level2 smaller">
<h2>Simple linear regression in R</h2>
<p>For simple linear regression</p>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i
</span></p>
<p>the command is</p>
<div class="r-stack">
<p><code>lm(y ~ x)</code></p>
</div>
<p><br></p>
<ul>
<li><p>Symbol <code>y ~ x</code> reads as <em><span class="math inline">y</span> modelled as function of <span class="math inline">x</span></em></p></li>
<li><p><code>y</code> is vector containing the data <span class="math inline">y_1, \ldots, y_n</span></p></li>
<li><p><code>x</code> is vector containing the data <span class="math inline">x_1, \ldots, x_n</span></p></li>
</ul>
</section>
<section id="multiple-linear-regression-in-r" class="slide level2 smaller">
<h2>Multiple linear regression in R</h2>
<p>For multiple linear regression</p>
<p><span class="math display">
Y_i = \beta_1 + \beta_2 \, x_{i2} + \ldots + \beta_p \, x_{ip} + \varepsilon_i
</span></p>
<p>the command is</p>
<div class="r-stack">
<p><code>lm (y ~ x2 + x3 + ... + xp)</code></p>
</div>
<p><br></p>
<ul>
<li><p><code>y</code> is vector containing the data <span class="math inline">y_1, \ldots, y_n</span></p></li>
<li><p><code>xj</code> is vector containing the data <span class="math inline">x_{1j}, \ldots , x_{jp}</span></p></li>
</ul>
</section>
<section id="general-commands-for-regression-in-r" class="slide level2 smaller">
<h2>General commands for regression in R</h2>
<p>The best way to run regression is</p>
<ol type="1">
<li>Run the regression analysis and store the results in a variable</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>fit.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ol start="2" type="1">
<li>Use command <code>summary</code> to read output of regression</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Note:</strong> If you are running the code from <code>.R</code> file you need to print output</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">summary</span>(fit.model) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-stock-and-gold-prices-2" class="slide level2 smaller">
<h2>Example: Stock and Gold prices</h2>
<ul>
<li>Stock price is stored in vector
<ul>
<li><code>stock.price</code></li>
</ul></li>
<li>Gold price is stored in vector
<ul>
<li><code>gold.price</code></li>
</ul></li>
<li>We want to fit the simple linear model <span class="math display">
\text{gold.price } = \alpha + \beta \, \times ( \text{ stock.price }) + \text{ error}
</span></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit simple linear regression model</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>fit.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gold.price <span class="sc">~</span> stock.price)</span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print result to screen</span></span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The full code can be downloaded here <a href="codes/simple_regression.R">simple_regression.R</a></li>
</ul>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output.png" style="width:78.0%"></p>
</div></div>
<ul>
<li><p>There is a lot of information here!</p></li>
<li><p>We will make sense of most of it in this lecture</p></li>
</ul>
</section>
<section id="interesting-parts-of-output" class="slide level2 smaller">
<h2>Interesting parts of Output</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut.png" style="width:79.0%"></p>
</div></div>
<ul>
<li>The MLE are under <code>estimate</code>
<ul>
<li><code>(Intercept)</code> refers to the coefficient <span class="math inline">\hat \alpha \qquad \implies  \qquad  \hat \alpha = 37.917</span></li>
<li><code>stock.price</code> refers to the coefficient <span class="math inline">\hat \beta \qquad \implies  \qquad  \hat \beta = - 6.169</span></li>
</ul></li>
</ul>
</section>
<section id="interesting-parts-of-output-1" class="slide level2 smaller">
<h2>Interesting parts of Output</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut.png" style="width:79.0%"></p>
</div></div>
<ul>
<li>Other quantities of interest are:</li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Coefficient <span class="math inline">R^2</span></th>
<th style="text-align: left;"><span class="math inline">\texttt{Multiple R-squared:  0.3953}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>t-statistic for</strong> <code>stock.price</code></td>
<td style="text-align: left;"><span class="math inline">\texttt{stock.price t-value:  -4.502}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>F-statistic</strong></td>
<td style="text-align: left;"><span class="math inline">\texttt{F-statistic: 20.27}</span></td>
</tr>
</tbody>
</table>
</section>
<section id="plotting-the-regression-line" class="slide level2 smaller">
<h2>Plotting the regression line</h2>
<div class="columns" style="display: flex !important; height: 80%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Data stored in stock.price </span></span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># and gold.price</span></span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stock.price, gold.price, </span>
<span id="cb12-5"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Stock Price"</span>, </span>
<span id="cb12-6"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"Gold Price"</span>,</span>
<span id="cb12-7"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb12-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Model stored in fit.model</span></span>
<span id="cb12-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the regression line</span></span>
<span id="cb12-11"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit.model, </span>
<span id="cb12-12"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, </span>
<span id="cb12-13"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_9_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="conclusion" class="slide level2 smaller">
<h2>Conclusion</h2>
<ul>
<li><p>We fit a simple linear model to <em>Stock Price</em> Vs <em>Gold Price</em></p></li>
<li><p>We obtained the regression line</p></li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | x] = \hat \alpha + \hat \beta x =  37.917 -  6.169 \times x
</span></p>
<ul>
<li>The coefficient of determination is</li>
</ul>
<p><span class="math display">
R^2 = 0.395325 \geq 0.3
</span></p>
<ul>
<li>Hence the linear model explains the data to a reasonable extent:
<ul>
<li><em>Stock Price</em> affects <em>Gold Price</em></li>
<li>Since <span class="math inline">R^2</span> is not too large, also other factors may affect <em>Gold Price</em></li>
</ul></li>
</ul>
</section>
<section id="t-test-and-f-test-for-regression" class="slide level2 smaller">
<h2>t-test and F-test for regression</h2>
<ul>
<li>From <code>lm</code> we also obtained</li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>t-statistic for</strong> <code>stock.price</code></th>
<th style="text-align: left;"><span class="math inline">\texttt{stock.price t-value:  -4.502}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>F-statistic</strong></td>
<td style="text-align: left;"><span class="math inline">\texttt{F-statistic: 20.27}</span></td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li><p>t-statistic and F-statistic for regression are mathematically <strong>DIFFICULT</strong> topic</p></li>
<li><p>In the next two parts we explain what they mean</p>
<ul>
<li>We however omit mathematical details</li>
<li>If interested check out Section 11.3 of <span class="citation" data-cites="casella-berger">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span> and Chapter 11 of <span class="citation" data-cites="degroot">[<a href="#/references" role="doc-biblioref" onclick="">2</a>]</span></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="part-3-t-test-for-simple-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>t-test for simple regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="t-test-for-simple-regression" class="slide level2 smaller">
<h2>t-test for simple regression</h2>
<ul>
<li>Consider the simple linear regression model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta X_i + \varepsilon_i
</span></p>
<ul>
<li>We have that</li>
</ul>
<p><span class="math display">
X \,\, \text{ affects } \,\, Y \qquad \iff \qquad
\beta \neq 0
</span></p>
<ul>
<li><p><span class="math inline">\beta</span> is a random quantity which depends on the sample</p></li>
<li><p>To see if <span class="math inline">X</span> affects <span class="math inline">Y</span>, we can test the hypothesis</p></li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon  &amp; \beta = 0 \\
H_1 \colon &amp; \beta \neq 0
\end{align*}</span></p>
</section>
<section id="construction-of-t-test" class="slide level2 smaller">
<h2>Construction of t-test</h2>
<ul>
<li>More in general, consider the hypothesis</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon  &amp; \beta = b \\
H_1 \colon &amp; \beta \neq b
\end{align*}</span></p>
<ul>
<li><p>Our best guess for <span class="math inline">\beta</span> is the ML Estimator <span class="math display">
\hat \beta = \frac{ S_{xy} }{ S_{xx} }
</span></p></li>
<li><p>To test above hypotheses, we therefore need to</p>
<ul>
<li>Know the <strong>distribution</strong> of <span class="math inline">\hat \beta</span></li>
<li>Construct <strong>t-statistic</strong> involving <span class="math inline">\hat \beta</span></li>
</ul></li>
</ul>
</section>
<section id="distribution-of-hat-beta" class="slide level2 smaller">
<h2>Distribution of <span class="math inline">\hat \beta</span></h2>
<div id="Theorem*-4.1" class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Consider the linear regression model<p></p>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i  \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0, \sigma^2)
</span></p>
<p>The MLE <span class="math inline">\hat{\beta}</span> is normally distributed</p>
<p><span class="math display">
\hat \beta \sim N \left(\beta , \frac{ \sigma^2 }{ S_{xx} } \right)
</span></p>
</div></details>
</div>
<p><strong>Proof:</strong> Quite difficult. If interested see Theorem 11.3.3 in <span class="citation" data-cites="casella-berger">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span></p>
</section>
<section id="construction-of-t-statistic-for-hat-beta" class="slide level2 smaller">
<h2>Construction of t-statistic for <span class="math inline">\hat \beta</span></h2>
<ul>
<li><p>From the previous Theorem, we know that <span class="math display">
\hat \beta \sim N \left(\beta , \frac{ \sigma^2 }{ S_{xx} } \right)
</span></p></li>
<li><p>In particular <span class="math inline">\hat \beta</span> is an unbiased estimator for <span class="math inline">\beta</span> <span class="math display">
{\rm I\kern-.3em E}[ \hat \beta ] = \beta
</span></p></li>
<li><p>This means <span class="math inline">\hat \beta</span> is the <em>Estimate</em> for the unknown parameter <span class="math inline">\beta</span></p></li>
<li><p>The t-statistic is therefore <span class="math display">
t = \frac{\text{Estimate } - \text{ Hypothesised Value}}{\mathop{\mathrm{e.s.e.}}}
= \frac{ \hat \beta - \beta }{ \mathop{\mathrm{e.s.e.}}}
</span></p></li>
</ul>
</section>
<section id="estimated-standard-error-for-hat-beta" class="slide level2 smaller">
<h2>Estimated Standard Error for <span class="math inline">\hat \beta</span></h2>
<ul>
<li><p>From the Theorem in Slide 30, we know that <span class="math display">
{\rm Var}[\hat \beta] = \frac{ \sigma^2 }{ S_{xx}} \quad \implies \quad {\rm SD}[\hat \beta] = \frac{ \sigma }{ \sqrt{S_{xx}} }
</span></p></li>
<li><p>The standard deviation <span class="math inline">{\rm SD}</span> cannot be used as error, since <span class="math inline">\sigma^2</span> is unknown<br>
(Recall that <span class="math inline">\sigma^2</span> is the unknown variance of the error <span class="math inline">\varepsilon_i</span>)</p></li>
<li><p>We however have an estimate for <span class="math inline">\sigma^2</span> <span class="math display">
\hat \sigma^2 = \frac{1}{n} \mathop{\mathrm{RSS}}= \frac1n \sum_{i=1}^n (y_i - \hat y_i)^2
</span></p></li>
<li><p><span class="math inline">\hat \sigma^2</span> was obtained from maximization of the likelihood function (Lecture 8)</p></li>
</ul>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>It can be shown that <span class="math display">
{\rm I\kern-.3em E}[ \hat\sigma^2 ] = \frac{n-2}{n} \, \sigma^2
</span> (for a proof, see Section 11.3.4 in <span class="citation" data-cites="casella-berger">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span>)</p></li>
<li><p>Therefore <span class="math inline">\hat\sigma^2</span> is not unbiased estimator of <span class="math inline">\sigma^2</span></p></li>
<li><p>To obtain an unbiased estimator, we rescale <span class="math inline">\hat\sigma^2</span> and introduce <span class="math inline">S^2</span> <span class="math display">
S^2 := \frac{n}{n-2} \, \hat\sigma^2 = \frac{\mathop{\mathrm{RSS}}}{n-2}
</span></p></li>
<li><p>This way, <span class="math inline">S^2</span> is unbiased estimator for <span class="math inline">\sigma^2</span> <span class="math display">
{\rm I\kern-.3em E}[S^2] =  \frac{n}{n-2}  \, {\rm I\kern-.3em E}[\hat\sigma^2] =  \frac{n}{n-2} \,\cdot \, \frac{n-2}{n} \, \cdot \, \sigma^2 = \sigma^2
</span></p></li>
</ul>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Recall that the standard deviation of <span class="math inline">\hat \beta</span> is</li>
</ul>
<p><span class="math display">
{\rm SD}[\hat \beta] = \frac{ \sigma }{ \sqrt{S_{xx}} }
</span></p>
<ul>
<li><p>We replace the unknown <span class="math inline">\sigma</span> with its unbiased estimator <span class="math inline">S</span></p></li>
<li><p>This gives the <strong>estimated standard error</strong></p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}:= \frac{S}{\sqrt{S_{xx}}} \,, \qquad S = \sqrt{\frac{\mathop{\mathrm{RSS}}}{n-2}}
</span></p>
</section>
<section id="t-statistic-for-testing-hat-beta" class="slide level2 smaller">
<h2>t-statistic for testing <span class="math inline">\hat \beta</span></h2>
<p>The t-statistic for <span class="math inline">\hat \beta</span> is then</p>
<p><span class="math display">
t = \frac{\text{Estimate } - \text{ Hypothesised Value}}{\mathop{\mathrm{e.s.e.}}}
  = \frac{ \hat \beta - \beta }{ S / \sqrt{S_{xx}} }
</span></p>
<div id="Theorem*-4.2" class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Consider the linear regression model<p></p>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0, \sigma^2)
</span></p>
<p>The t-statistic for <span class="math inline">\hat{\beta}</span> follows a t-distribution</p>
<p><span class="math display">
t = \frac{ \hat \beta - \beta }{ S / \sqrt{S_{xx}} }  
\, \sim \,
t_{n-2}
</span></p>
</div></details>
</div>
</section>
<section id="how-to-prove-the-theorem" class="slide level2 smaller">
<h2>How to prove the Theorem</h2>
<ul>
<li><p>Proof of this Theorem is quite difficult and we omit it</p></li>
<li><p>If you are interested in the proof, see Section 11.3.4 in <span class="citation" data-cites="casella-berger">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span></p></li>
<li><p>The main idea is that t-statistic can be rewritten as</p></li>
</ul>
<p><span class="math display">
t = \frac{ \hat \beta - \beta }{ S / \sqrt{S_{xx}} }  
  = \frac{ U }{ \sqrt{ V/(n-2) } }  
</span></p>
<ul>
<li>Here we defined</li>
</ul>
<p><span class="math display">
U := \frac{ \hat \beta - \beta }{ \sigma / \sqrt{S_{xx}} } \,, \qquad \quad V := \frac{ (n-2) S^2 }{ \sigma^2 }
</span></p>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>We know that <span class="math display">
\hat \beta \sim N \left(\beta , \frac{ \sigma^2 }{ S_{xx} } \right)
</span></p></li>
<li><p>Therefore <span class="math display">
U = \frac{ \hat \beta - \beta }{ \sigma / \sqrt{S_{xx}} } \, \sim \, N(0,1)
</span></p></li>
<li><p>Moreover, it can be shown that <span class="math display">
V = \frac{(n-2) S^2}{\sigma^2} \, \sim \, \chi_{n-2}^2
</span></p></li>
<li><p>It can also be shown that <span class="math inline">U</span> and <span class="math inline">V</span> are independent</p></li>
</ul>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>
<ul>
<li>In summary, we have</li>
</ul>
<p><span class="math display">
t = \frac{ \hat \beta - \beta }{ S / \sqrt{S_{xx}} }  
  = \frac{ U }{ \sqrt{ V/(n-2) } }  
</span></p>
<ul>
<li><span class="math inline">U</span> and <span class="math inline">V</span> are independent, with</li>
</ul>
<p><span class="math display">
U \sim N(0,1) \,, \qquad \quad V \sim \chi_{n-2}^2
</span></p>
<ul>
<li>From the Theorem on t-distribution in Lecture 2, we conclude</li>
</ul>
<p><span class="math display">
t \sim t_{n-2}
</span></p>
</section>
<section id="the-t-test-for-beta" class="slide level2 smaller">
<h2>The t-test for <span class="math inline">\beta</span></h2>
<p><strong>Assumption:</strong> Given data points <span class="math inline">(x_1, y_1), \ldots, (x_n,y_n)</span>, consider the simple linear regression model <span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0,\sigma^2)
</span></p>
<p><strong>Goal</strong>: Statistical inference on the slope <span class="math inline">\beta</span></p>
<p><strong>Hypotheses</strong>: If <span class="math inline">b</span> is guess for <span class="math inline">\beta</span>, the two-sided hypothesis is <span class="math display">
H_0 \colon \beta = b \,, \quad \qquad
H_1 \colon \beta \neq b
</span> The one-sided alternative hypotheses are <span class="math display">
H_1 \colon \beta &lt; b \quad  \text{ or } \quad
H_1 \colon \beta &gt; b
</span></p>
</section>
<section id="procedure-3-steps" class="slide level2 smaller">
<h2>Procedure: 3 Steps</h2>
<ol type="1">
<li><strong>Calculation</strong>: Compute the MLE <span class="math inline">\hat{\alpha}, \hat{\beta}</span> and the predictions <span class="math inline">\hat{y}_i</span> <span class="math display">
\hat \beta = \frac{ S_{xy} }{ S_{xx} }  \,, \qquad
\hat \alpha = \overline{y} - \hat \beta \overline{x} \,, \qquad \hat{y}_i = \hat{\alpha} + \hat{\beta} x_i
</span> Compute the <em>Residual Sum of Squares</em> and the estimator <span class="math inline">S^2</span> <span class="math display">
\mathop{\mathrm{RSS}}= \sum_{i=1}^n (y_i - \hat{y}_i)^2 \,, \qquad  S^2 := \frac{\mathop{\mathrm{RSS}}}{n-2}
</span> Finally, compute the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> and t-statistic <span class="math display">
\mathop{\mathrm{e.s.e.}}= \frac{S}{\sqrt{S_{xx}} } \,, \qquad t = \frac{\hat \beta - b }{ \mathop{\mathrm{e.s.e.}}}  \ \sim \ t_{n-2}
</span></li>
</ol>
</section>
<section id="section-5" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>: Find either
<ul>
<li>Critical value <span class="math inline">t^*</span> in <a href="files/Statistics_Tables.pdf">Table 1</a></li>
<li>p-value in R</li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" type="1">
<li><strong>Interpretation</strong>: Reject <span class="math inline">H_0</span> when either <span class="math display">
p &lt; 0.05 \qquad \text{ or } \qquad t \in \,\,\text{Rejection Region}
\qquad \qquad \qquad \qquad
(T \, \sim \, t_{n-2})
</span></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>Rejection Region</th>
<th><span class="math inline">t^*</span></th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\beta \neq b</span></td>
<td><span class="math inline">|t| &gt; t^*</span></td>
<td><span class="math inline">t_{n-2}(0.025)</span></td>
<td><span class="math inline">2P(T &gt; |t|)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\beta &lt; b</span></td>
<td><span class="math inline">t &lt; - t^*</span></td>
<td><span class="math inline">t_{n-2}(0.05)</span></td>
<td><span class="math inline">P(T &lt; t)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\beta &gt; b</span></td>
<td><span class="math inline">t &gt; t^*</span></td>
<td><span class="math inline">t_{n-2}(0.05)</span></td>
<td><span class="math inline">P(T &gt; t)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="worked-example-stock-and-gold-prices" class="slide level2 smaller">
<h2>Worked Example: Stock and Gold prices</h2>
<ul>
<li><p>Recall that</p>
<ul>
<li><span class="math inline">X =</span> Stock Price</li>
<li><span class="math inline">Y =</span> Gold Price</li>
</ul></li>
<li><p><strong>Goal:</strong> Test if <em>Gold Price</em> affects <em>Stock Price</em> at level <span class="math inline">0.05</span></p></li>
<li><p><strong>Procedure:</strong> Consider the linear model <span class="math display">
Y_i =  \alpha + \beta x_i + \varepsilon_i  \,, \quad \varepsilon_i \,\, \text{ iid } \,\, N(0,\sigma^2)
</span> Test the hypotheses with two-sided alternative <span class="math display">\begin{align*}
H_0 &amp; \colon \beta = 0 \\
H_1 &amp; \colon \beta \neq 0
\end{align*}</span></p></li>
</ul>
</section>
<section id="testing-for-beta-0" class="slide level2 smaller">
<h2>Testing for <span class="math inline">\beta = 0</span></h2>
<ul>
<li>Recall that Stock Prices and Gold Prices are stored in R vectors
<ul>
<li><code>stock.price</code></li>
<li><code>gold.price</code></li>
</ul></li>
<li>Fit the simple linear model with the following commands</li>
</ul>
<p><span class="math display">
\text{gold.price } = \alpha + \beta \, \times  (\text{ stock.price }) + \text{ error}
</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit simple linear regression model</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>fit.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gold.price <span class="sc">~</span> stock.price)</span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print result to screen</span></span>
<span id="cb13-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li><p><span class="math inline">\texttt{(Intercept)}</span>: 1st row of the table contains information related to <span class="math inline">\hat \alpha</span></p></li>
<li><p><span class="math inline">\texttt{stock.price}</span>: 2nd row of the table contains information related to <span class="math inline">\hat \beta</span></p></li>
<li><p>For larger models, there will be additional rows below the 2nd</p>
<ul>
<li>These will be <strong>informative</strong> about additional regression parameters</li>
</ul></li>
</ul>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-1" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li>The 2nd row of the table has to be interpreted as follows</li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\texttt{Estimate}</span></th>
<th style="text-align: left;"><span class="math inline">\text{The value of } \hat \beta</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{Std. Error}</span></td>
<td style="text-align: left;">Estimated standard error <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat \beta</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{t value}</span></td>
<td style="text-align: left;">t-statistic <span class="math inline">\, t = \dfrac{\hat \beta - 0 }{\mathop{\mathrm{e.s.e.}}}</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{Pr(&gt;|t|)}</span></td>
<td style="text-align: left;">p-value <span class="math inline">\, p = 2 P( t_{n-2} &gt; |t| )</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{***}</span>, <span class="math inline">\, \texttt{**}</span>, <span class="math inline">\, \texttt{*}</span>, <span class="math inline">\, \texttt{.}</span></td>
<td style="text-align: left;">Significance (how large is p-value) – More stars is better</td>
</tr>
</tbody>
</table>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-2" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li>The above table then gives</li>
</ul>
<p><span class="math display">
\hat \beta = -6.169 \,, \qquad \mathop{\mathrm{e.s.e.}}= 1.37 \, , \qquad t = - 4.502 \,, \qquad
p = 8.9 \times 10^{-5} \
</span></p>
<ul>
<li>The <span class="math inline">t</span>-statistic computed by R can also be computed by hand</li>
</ul>
<p><span class="math display">
  t   = \frac{\hat \beta - 0}{ \mathop{\mathrm{e.s.e.}}}
      = \frac{-6.169}{1.37} = -4.502
</span></p>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-3" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li><p>The p-value computed by R is <span class="math inline">p = 8.9 \times 10^{-5}</span></p></li>
<li><p>We can also compute it by hand: The degrees of freedom are</p></li>
</ul>
<p><span class="math display">
n = \text{No. of data points} = 33 \,, \qquad  \text{df} = n - 2 = 31
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fl">4.502</span> </span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="at">df =</span> <span class="dv">31</span>)</span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The p-value is"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is 8.901425e-05</code></pre>
</div>
</div>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-4" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li>In alternative, we can find critical value in <a href="files/Statistics_Tables.pdf">Table 1</a></li>
</ul>
<p><span class="math display">
n = \text{No. of data points} = 33 \,, \qquad  \text{df} = n - 2 = 31
</span></p>
<ul>
<li>For two-sided test, the critical value is <span class="math inline">\, t_{31}(0.025) = 2.040</span></li>
</ul>
<p><span class="math display">
|t| = 4.502 &gt; 2.040 = t_{31}(0.025) \quad \implies \quad  p &lt; 0.05
</span></p>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-5" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<p><strong>Interpretation:</strong> <span class="math inline">\, p</span> is very small (hence the <span class="math inline">\, \texttt{***} \,</span> rating)</p>
<ul>
<li><p>Therefore, we reject the null hypothesis <span class="math inline">H_0</span>, and the real parameter is <span class="math inline">\beta \neq 0</span></p></li>
<li><p>Since <span class="math inline">\beta \neq 0</span>, we have that <em>Stock Prices</em> affect <em>Gold Prices</em></p></li>
<li><p>The best estimate for <span class="math inline">\beta</span> is the MLE <span class="math inline">\hat \beta = -6.169</span></p></li>
<li><p><span class="math inline">\hat \beta &lt; 0</span> and statistically significant:<br>
<span class="math inline">\,\,</span> As <em>Stock Prices</em> increase <em>Gold Prices</em> decrease</p></li>
</ul>
</section>
<section id="warning" class="slide level2 smaller">
<h2>Warning</h2>
<p>The t-statistic and p-value in the <em>summary</em> refer to the two-sided test <span class="math display">
H_0 \colon \beta = 0 \,, \qquad
H_1 \colon \beta \neq 0
</span> In such case the t-statistic and p-value given in <em>summary are</em> <span class="math display">
t = \frac{\hat \beta - 0}{\mathop{\mathrm{e.s.e.}}} \,, \qquad p = 2P(t_{n- 2} &gt; |t|)
</span></p>
</section>
<section id="section-6" class="slide level2 smaller">
<h2></h2>
<p>If instead you are required to test <span class="math display">
H_0 \colon \beta = b \,, \qquad
H_1 \colon \beta \neq b \,, \quad
\beta &lt; b\,, \quad  \text{ or } \,\,
\beta &gt; b
</span></p>
<ol type="1">
<li>The t-statistic has to be computed by hand <span class="math display">
t = \frac{\hat \beta - b}{\mathop{\mathrm{e.s.e.}}}
</span>
<ul>
<li><span class="math inline">\, \mathop{\mathrm{e.s.e.}}</span> is in the 2nd row under <span class="math inline">\,\, \texttt{Std. Error}</span></li>
</ul></li>
<li>The p-value must be computed by hand, according to the table</li>
</ol>
<table class="caption-top" style="width:95%;">
<colgroup>
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>p-value</th>
<th>R command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\beta \neq b</span></td>
<td><span class="math inline">2P(t_{n-2} &gt; |t|)</span></td>
<td><code>2 - 2 * pt(abs(t), df = n - 2)</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\beta &lt; b</span></td>
<td><span class="math inline">P(t_{n-2} &lt; t)</span></td>
<td><code>pt(t, df = n - 2)</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\beta &gt; b</span></td>
<td><span class="math inline">P(t_{n-2} &gt; t)</span></td>
<td><code>1 - pt(t, df = n - 2)</code></td>
</tr>
</tbody>
</table>
</section></section>
<section>
<section id="part-4-t-test-for-general-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>t-test for general regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="recall-the-t-test-for-simple-regression" class="slide level2 smaller">
<h2>Recall: The t-test for simple regression</h2>
<ul>
<li>In the previous Part, we have considered the simple linear regression model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0,\sigma^2)
</span></p>
<ul>
<li>We have that</li>
</ul>
<p><span class="math display">
X \,\, \text{ affects } \,\, Y \qquad \iff \qquad
\beta \neq 0
</span></p>
<ul>
<li>To see if <span class="math inline">X</span> affects <span class="math inline">Y</span>, we have developed a t-test for the hypothesis</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon  &amp; \beta = b \\
H_1 \colon &amp; \beta \neq b
\end{align*}</span></p>
</section>
<section id="the-t-test-for-general-regression" class="slide level2 smaller">
<h2>The t-test for general regression</h2>
<ul>
<li>Now, consider the <em>general linear regression model</em></li>
</ul>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \ldots + \beta_{ip} z_{ip} + \varepsilon_i \,, \qquad
\varepsilon_i \, \text{ iid } \, N(0, \sigma^2)
</span></p>
<ul>
<li>We have that</li>
</ul>
<p><span class="math display">
Z_j \,\, \text{ affects } \,\, Y \qquad \iff \qquad
\beta_j \neq 0
</span></p>
<ul>
<li>To see if <span class="math inline">Z_j</span> affects <span class="math inline">Y</span> we can test the hypothesis</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon  &amp; \beta_j = 0 \\
H_1 \colon &amp; \beta_j \neq 0
\end{align*}</span></p>
</section>
<section id="construction-of-t-test-1" class="slide level2 smaller">
<h2>Construction of t-test</h2>
<ul>
<li>More in general, consider the hypothesis</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon  &amp; \beta_j = b_j \\
H_1 \colon &amp; \beta_j \neq b_j
\end{align*}</span></p>
<ul>
<li><p>Our best guess for <span class="math inline">\beta_j</span> is the ML Estimator <span class="math display">
\hat{\beta}_j = (\hat \beta)_j \,, \qquad \hat \beta = (Z^T Z)^{-1} Z^T y
</span> (<span class="math inline">\beta_j</span> is the j-th component of the vector <span class="math inline">\beta</span>)</p></li>
<li><p>To test above hypotheses, we therefore need to</p>
<ul>
<li>Know the <strong>distribution</strong> of <span class="math inline">\hat{\beta}_j</span></li>
<li>Construct <strong>t-statistic</strong> involving <span class="math inline">\hat{\beta}_j</span></li>
</ul></li>
</ul>
</section>
<section id="distribution-of-hat-beta_j" class="slide level2 smaller">
<h2>Distribution of <span class="math inline">\hat \beta_j</span></h2>
<div style="font-size: 0.92em">
<div class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Consider the general linear regression model <span class="math display">
Y_i = \beta_1 z_{i1} + \ldots + \beta_{ip} z_{ip} + \varepsilon_i \,, \qquad
\varepsilon_i \, \text{ iid } \, N(0, \sigma^2)
</span> The MLE <span class="math inline">\hat{\beta}_j</span> is normally distributed <span class="math display">
\hat \beta_j \sim N \left( \beta_j ,  \xi_{jj} \sigma^2 \right) \,,
</span> where the numbers <span class="math inline">\xi_{jj}</span> are the diagonal entries of the <span class="math inline">p \times p</span> matrix <span class="math display">
(Z^T Z)^{-1} =
\left(
\begin{array}{ccc}
\xi_{11} &amp; \ldots &amp; \xi_{1p} \\
\ldots   &amp; \ldots &amp; \ldots \\
\xi_{p1} &amp; \ldots &amp; \xi_{pp} \\
\end{array}
\right)
</span><p></p>
</div></details>
</div>
<p><strong>Proof:</strong> Quite difficult. If interested, see see Section 11.5 in <span class="citation" data-cites="degroot">[<a href="#/references" role="doc-biblioref" onclick="">2</a>]</span></p>
</div>
</section>
<section id="construction-of-the-t-statistic-for-hatbeta_j" class="slide level2 smaller">
<h2>Construction of the t-statistic for <span class="math inline">\hat{\beta}_j</span></h2>
<ul>
<li><p>From the previous Theorem, we know that <span class="math display">
\hat \beta_j \sim N \left( \beta_j ,  \xi_{jj} \sigma^2 \right)
</span></p></li>
<li><p>In particular, <span class="math inline">\hat{\beta}_j</span> is an unbiased estimator for <span class="math inline">\beta_j</span> <span class="math display">
{\rm I\kern-.3em E}[ \hat{\beta}_j ] = \beta_j
</span></p></li>
<li><p>This means <span class="math inline">\hat{\beta}_j</span> is the <em>Estimate</em> for the unknown parameter <span class="math inline">\beta</span></p></li>
<li><p>The t-statistic is therefore <span class="math display">
t = \frac{\text{Estimate } - \text{ Hypothesised Value}}{\mathop{\mathrm{e.s.e.}}}
= \frac{ \hat{\beta}_j - \beta_j }{ \mathop{\mathrm{e.s.e.}}}
</span></p></li>
</ul>
</section>
<section id="estimated-standard-error-for-hatbeta_j" class="slide level2 smaller">
<h2>Estimated Standard Error for <span class="math inline">\hat{\beta}_j</span></h2>
<ul>
<li><p>From the Theorem, we know that <span class="math display">
{\rm Var}[\hat{\beta}_j] =  \xi_{jj} \, \sigma^2  \qquad \implies \qquad
{\rm SD}[\hat \beta_j] =  \xi_{jj}^{1/2} \, \sigma
</span></p></li>
<li><p>The standard deviation <span class="math inline">{\rm SD}</span> cannot be used as error, since <span class="math inline">\sigma^2</span> is unknown</p></li>
<li><p>We however have an estimate for <span class="math inline">\sigma^2</span> <span class="math display">
\hat \sigma^2 = \frac{1}{n} \mathop{\mathrm{RSS}}= \frac1n \sum_{i=1}^n (y_i - \hat y_i)^2
</span></p></li>
<li><p><span class="math inline">\hat \sigma^2</span> was obtained from maximization of the likelihood function (Lecture 8)</p></li>
</ul>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>It can be shown that (see Section 11.5 in <span class="citation" data-cites="degroot">[<a href="#/references" role="doc-biblioref" onclick="">2</a>]</span>) <span class="math display">
{\rm I\kern-.3em E}[ \hat\sigma^2 ] = \frac{n-p}{n} \, \sigma^2
</span></p></li>
<li><p>Therefore <span class="math inline">\hat\sigma^2</span> is not unbiased estimator of <span class="math inline">\sigma^2</span></p></li>
<li><p>To obtain unbiased estimator, we rescale <span class="math inline">\hat\sigma^2</span> and introduce <span class="math inline">S^2</span> <span class="math display">
S^2 := \frac{n}{n-p} \, \hat\sigma^2 = \frac{\mathop{\mathrm{RSS}}}{n-p}
</span></p></li>
<li><p>This way, <span class="math inline">S^2</span> is unbiased estimator for <span class="math inline">\sigma^2</span></p></li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[S^2] =  \frac{n}{n-p}  \, {\rm I\kern-.3em E}[\hat\sigma^2] =  \frac{n}{n-p} \, \frac{n-p}{n} \, \sigma^2 = \sigma^2
</span></p>
</section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Recall that the standard deviation of <span class="math inline">\hat{\beta}_j</span> is</li>
</ul>
<p><span class="math display">
{\rm SD}[\hat{\beta}_j] = \xi_{jj}^{1/2} \, \sigma
</span></p>
<ul>
<li><p>We replace the unknown <span class="math inline">\sigma</span> with its unbiased estimator <span class="math inline">S</span></p></li>
<li><p>This gives the <strong>estimated standard error</strong></p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}=\xi_{jj}^{1/2} \,  S \,, \qquad S = \sqrt{\frac{\mathop{\mathrm{RSS}}}{n-2}}
</span></p>
</section>
<section id="t-statistic-for-testing-beta_j" class="slide level2 smaller">
<h2>t-statistic for testing <span class="math inline">\beta_j</span></h2>
<div id="Theorem*-5.1" class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Consider the general linear regression model<p></p>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \ldots +\beta_p z_{ip} + \varepsilon_i \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0, \sigma^2)
</span></p>
<p>The t-statistic for <span class="math inline">\hat{\beta}</span> follows a t-distribution</p>
<p><span class="math display">
t = \frac{\text{Estimate } - \text{ Hypothesised Value}}{\mathop{\mathrm{e.s.e.}}} = \frac{ \hat \beta_j - \beta_j }{ \xi_{jj}^{1/2} \, S}  
\, \sim \,
t_{n-p}
</span></p>
</div></details>
</div>
<p><strong>Proof:</strong> See section 11.5 in <span class="citation" data-cites="degroot">[<a href="#/references" role="doc-biblioref" onclick="">2</a>]</span></p>
</section>
<section id="the-t-test-for-beta_j" class="slide level2 smaller">
<h2>The t-test for <span class="math inline">\beta_j</span></h2>
<p><strong>Assumption:</strong> Given data points <span class="math inline">(z_{1i}, \ldots, z_{pi}, y_i)</span>, consider the general model <span class="math display">
Y_i = \beta_1 z_{i1} + \ldots + \beta_p z_{ip} + \varepsilon_i \,, \qquad \varepsilon_i \, \text{ iid } \, N(0,\sigma^2)
</span></p>
<p><strong>Goal</strong>: Statistical inference on the coefficients <span class="math inline">\beta_j</span></p>
<p><strong>Hypotheses</strong>: If <span class="math inline">b_j</span> is guess for <span class="math inline">\beta_j</span>, the two-sided hypotheses is <span class="math display">
H_0 \colon \beta_j = b_j \,, \quad \qquad
H_1 \colon \beta_j \neq b_j
</span> The one-sided alternative hypotheses are <span class="math display">
H_1 \colon \beta_j &lt; b_j \quad  \text{ or } \quad
H_1 \colon \beta_j &gt; b_j
</span></p>
</section>
<section id="procedure-3-steps-1" class="slide level2 smaller">
<h2>Procedure: 3 Steps</h2>
<ol type="1">
<li><strong>Calculation</strong>: Write down the design matrix <span class="math inline">Z</span> and compute <span class="math inline">(Z^TZ)^{-1}</span> <span class="math display">
Z :=
\left(
\begin{array}{ccc}
z_{11} &amp; \ldots &amp; z_{1p} \\
\ldots &amp; \ldots &amp; \ldots \\
z_{n1} &amp; \ldots &amp; z_{np} \\
\end{array}
\right) \,, \qquad
(Z^T Z)^{-1} =
\left(
\begin{array}{ccc}
\xi_{11} &amp; \ldots &amp; \xi_{1p} \\
\ldots   &amp; \ldots &amp; \ldots \\
\xi_{p1} &amp; \ldots &amp; \xi_{pp} \\
\end{array}
\right)
</span> Compute the MLE <span class="math inline">\hat{\beta}</span>, predictions <span class="math inline">\hat{y}</span>, RSS and <span class="math inline">S^2</span> <span class="math display">
\hat \beta = (Z^TZ)^{-1} Z^T y  \,, \qquad
\hat{y} = Z \hat{\beta} \,, \qquad
\mathop{\mathrm{RSS}}= \sum_{i=1}^n (y_i - \hat{y}_i)^2 \,, \qquad  S^2 := \frac{\mathop{\mathrm{RSS}}}{n-2}
</span> Finally, compute the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> and the t-statistic <span class="math display">
\mathop{\mathrm{e.s.e.}}= \xi_{jj}^{1/2} \, S\,, \qquad  t = \frac{\hat \beta_j - b_j }{ \mathop{\mathrm{e.s.e.}}} \ \sim \ t_{n-p}
</span></li>
</ol>
</section>
<section id="section-9" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>: Find either
<ul>
<li>Critical value <span class="math inline">t^*</span> in <a href="files/Statistics_Tables.pdf">Table 1</a></li>
<li>p-value in R</li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" type="1">
<li><strong>Interpretation</strong>: Reject <span class="math inline">H_0</span> when either <span class="math display">
p &lt; 0.05 \qquad \text{ or } \qquad t \in \,\,\text{Rejection Region}
\qquad \qquad \qquad \qquad
(T \, \sim \, t_{n-p})
</span></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>Rejection Region</th>
<th><span class="math inline">t^*</span></th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\beta_j \neq b_j</span></td>
<td><span class="math inline">|t| &gt; t^*</span></td>
<td><span class="math inline">t_{n-p}(0.025)</span></td>
<td><span class="math inline">2P(T &gt; |t|)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\beta_j &lt; b_j</span></td>
<td><span class="math inline">t &lt; - t^*</span></td>
<td><span class="math inline">t_{n-p}(0.05)</span></td>
<td><span class="math inline">P(T &lt; t)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\beta_j &gt; b_j</span></td>
<td><span class="math inline">t &gt; t^*</span></td>
<td><span class="math inline">t_{n-p}(0.05)</span></td>
<td><span class="math inline">P(T &gt; t)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="the-t-test-for-beta_j-in-r" class="slide level2 smaller">
<h2>The t-test for <span class="math inline">\beta_j</span> in R</h2>
<ul>
<li><p>First, fit general regression model with <code>lm</code></p></li>
<li><p>Then read the <em>summary</em></p></li>
</ul>
<p>Assume the hypotheses to test are <span class="math display">
H_0 \colon \beta_j = 0 \,, \qquad
H_1 \colon \beta_j \neq 0
</span> In such case, the t-statistic and p-value are explicitly given in the <em>summary</em> <span class="math display">
t = \frac{\hat \beta_j - 0}{\mathop{\mathrm{e.s.e.}}} \,, \qquad p = 2P(t_{n- p} &gt; |t|)
</span></p>
<ul>
<li><p>Read the t-statistic in <span class="math inline">j</span>-th variable row under <span class="math inline">\,\, \texttt{t value}</span></p></li>
<li><p>Read the p-value in <span class="math inline">j</span>-th variable row under <span class="math inline">\,\, \texttt{Pr(&gt;|t|)}</span></p></li>
</ul>
</section>
<section id="section-10" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<p>If instead you are required to test <span class="math display">
H_0 \colon \beta_j = b_j \,, \qquad
H_1 \colon \beta_j \neq b_j \,, \quad
\beta_j &lt; b_j \,, \quad  \text{ or } \,\,
\beta_j &gt; b_j
</span></p>
<ol type="1">
<li>The t-statistic has to be computed by hand <span class="math display">
t = \frac{\hat{\beta}_j - b_j}{\mathop{\mathrm{e.s.e.}}}
</span>
<ul>
<li><span class="math inline">\,\, \hat \beta_j</span> is in <span class="math inline">j</span>-th variable row under <span class="math inline">\,\, \texttt{Estimate}</span></li>
<li><span class="math inline">\,\, \mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat \beta_j</span> is in <span class="math inline">j</span>-th variable row under <span class="math inline">\,\, \texttt{Std. Error}</span></li>
</ul></li>
<li>The p-value must be computed by hand, according to the table</li>
</ol>
<table class="caption-top" style="width:95%;">
<colgroup>
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>p-value</th>
<th>R command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\beta_j \neq b_j</span></td>
<td><span class="math inline">2P(t_{n-p} &gt; |t|)</span></td>
<td><code>2 - 2 * pt(abs(t), df = n - p)</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\beta_j &lt; b_j</span></td>
<td><span class="math inline">P(t_{n-p} &lt; t)</span></td>
<td><code>pt(t, df = n - p)</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\beta_j &gt; b_j</span></td>
<td><span class="math inline">P(t_{n-p} &gt; t)</span></td>
<td><code>1 - pt(t, df = n - p)</code></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="worked-example-stock-and-gold-prices-1" class="slide level2 smaller">
<h2>Worked Example: Stock and Gold prices</h2>
<ul>
<li><p>Recall that</p>
<ul>
<li><span class="math inline">X =</span> Stock Price</li>
<li><span class="math inline">Y =</span> Gold Price</li>
</ul></li>
<li><p><strong>Goal:</strong> Test if an <em>intercept is present</em>, at level <span class="math inline">0.05</span></p></li>
<li><p><strong>Procedure:</strong> Consider the linear model <span class="math display">
Y_i =  \alpha + \beta x_i + \varepsilon_i  \,, \quad \varepsilon_i \,\, \text{ iid } \,\, N(0,\sigma^2)
</span> Test the hypotheses with two-sided alternative <span class="math display">\begin{align*}
H_0 &amp; \colon \alpha = 0 \\
H_1 &amp; \colon \alpha \neq 0
\end{align*}</span></p></li>
</ul>
</section>
<section id="testing-for-alpha-0" class="slide level2 smaller">
<h2>Testing for <span class="math inline">\alpha= 0</span></h2>
<ul>
<li>Recall that Stock Prices and Gold Prices are stored in R vectors
<ul>
<li><code>stock.price</code></li>
<li><code>gold.price</code></li>
</ul></li>
<li>Fit the simple linear model with the following commands</li>
</ul>
<p><span class="math display">
\text{gold.price } = \alpha + \beta \, \times  (\text{ stock.price }) + \text{ error}
</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit simple linear regression model</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>fit.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gold.price <span class="sc">~</span> stock.price)</span>
<span id="cb16-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print result to screen</span></span>
<span id="cb16-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-6" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li><span class="math inline">\texttt{(Intercept)}</span>: 1st row of the table contains information related to <span class="math inline">\hat \alpha</span></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\texttt{Estimate}</span></th>
<th style="text-align: left;"><span class="math inline">\text{The value of } \hat \alpha</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{Std. Error}</span></td>
<td style="text-align: left;">Estimated standard error <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat \alpha</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{t value}</span></td>
<td style="text-align: left;">t-statistic <span class="math inline">\, t = \dfrac{\hat \alpha - 0 }{\mathop{\mathrm{e.s.e.}}}</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{Pr(&gt;|t|)}</span></td>
<td style="text-align: left;">p-value <span class="math inline">\, p = 2 P( t_{n-2} &gt; |t| )</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{***}</span>, <span class="math inline">\, \texttt{**}</span>, <span class="math inline">\, \texttt{*}</span>, <span class="math inline">\, \texttt{.}</span></td>
<td style="text-align: left;">Significance (how large is p-value) – More stars is better</td>
</tr>
</tbody>
</table>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-7" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li>The above table then gives</li>
</ul>
<p><span class="math display">
\hat \alpha = 37.917 \,, \qquad \mathop{\mathrm{e.s.e.}}= 4.336 \, , \qquad t =  8.744 \,, \qquad
p = 7.14 \times 10^{-10} \
</span></p>
<ul>
<li>The <span class="math inline">t</span>-statistic computed by R can also be computed by hand</li>
</ul>
<p><span class="math display">
  t   = \frac{\hat \alpha - 0}{ \mathop{\mathrm{e.s.e.}}}
      = \frac{37.917}{4.336} = 8.744
</span></p>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-8" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li><p>The p-value computed by R is <span class="math inline">p = 7.14 \times 10^{-10}</span></p></li>
<li><p>We can also compute it by hand: The degrees of freedom are</p></li>
</ul>
<p><span class="math display">
n = \text{No. of data points} = 33 \,, \qquad  \text{df} = n - 2 = 31
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fl">8.744</span></span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="at">df =</span> <span class="dv">31</span>)</span>
<span id="cb17-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The p-value is"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is 7.135255e-10</code></pre>
</div>
</div>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-9" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<ul>
<li>In alternative, we can find the critical value in <a href="files/Statistics_Tables.pdf">Table 1</a></li>
</ul>
<p><span class="math display">
n = \text{No. of data points} = 33 \,, \qquad  \text{df} = n - 2 = 31
</span></p>
<ul>
<li>For two-sided test, the critical value is <span class="math inline">\, t_{31}(0.025) = 2.040</span></li>
</ul>
<p><span class="math display">
|t| = 8.744 &gt; 2.040 = t_{31}(0.025) \quad \implies \quad  p &lt; 0.05
</span></p>
</section>
<section id="output-mathopmathrme.s.e.-t-statistic-p-value-10" class="slide level2 smaller">
<h2>Output: <span class="math inline">\mathop{\mathrm{e.s.e.}}</span>, t-statistic, p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_2.png" style="width:70.0%"></p>
</div></div>
<p><strong>Interpretation:</strong> <span class="math inline">\, p</span> is very small (hence the <span class="math inline">\, \texttt{***} \,</span> rating)</p>
<ul>
<li><p>Therefore, we reject the null hypothesis <span class="math inline">H_0</span>, and the real parameter is <span class="math inline">\alpha \neq 0</span></p></li>
<li><p>Since <span class="math inline">\alpha \neq 0</span>, we deduce that the model has to <em>include an intercept</em></p></li>
<li><p>The best estimate for <span class="math inline">\alpha</span> is the MLE <span class="math inline">\hat \alpha = 37.917</span></p></li>
</ul>
</section>
<section id="theoretical-example" class="slide level2 smaller">
<h2>Theoretical Example</h2>
<h3 id="deriving-mathopmathrme.s.e.-for-simple-linear-regression">Deriving <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for simple linear regression</h3>
<ul>
<li>Consider the simple regression model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i
</span></p>
<ul>
<li>We have seen in the previous part that the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat{\beta}</span> is</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}= \frac{S}{\sqrt{S_{xx}}} \,, \qquad S = \sqrt{ \frac{\mathop{\mathrm{RSS}}}{n-2} }
</span></p>
<ul>
<li>However, we have not computed the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat{\alpha}</span></li>
</ul>
<p><strong>Goal:</strong> Compute <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat{\alpha}</span> using the theory developed for general regression</p>
</section>
<section id="section-11" class="slide level2 smaller">
<h2></h2>
<p><strong>Theory developed so far:</strong></p>
<ul>
<li><p>Consider the general linear model <span class="math display">
Y_i = \beta_1 z_{i1} + \ldots +\beta_p z_{ip} + \varepsilon_i \,, \qquad \varepsilon_i \,\, \text{ iid } \,\, N(0, \sigma^2)
</span></p></li>
<li><p>We have shown that the estimated standard error for <span class="math inline">\hat{\beta}_j</span> is <span class="math display">
\mathop{\mathrm{e.s.e.}}= \xi_{jj}^{1/2} \, S \,, \qquad
S = \sqrt{ \frac{\mathop{\mathrm{RSS}}}{n-2} }
</span> where <span class="math inline">\xi_{jj}</span> are the diagonal entries of the matrix <span class="math display">
(Z^T Z)^{-1} =
\left(
\begin{array}{ccc}
\xi_{11} &amp; \ldots &amp; \xi_{1p} \\
\ldots   &amp; \ldots &amp; \ldots \\
\xi_{p1} &amp; \ldots &amp; \xi_{pp} \\
\end{array}
\right)
</span></p></li>
</ul>
</section>
<section id="section-12" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Let us go back to the linear regression model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i
</span></p>
<ul>
<li>The design matrix is</li>
</ul>
<p><span class="math display">
Z = \left(
\begin{array}{cc}
1 &amp; x_1 \\
\ldots &amp; \ldots \\
1 &amp; x_n \\
\end{array}
\right)
</span></p>
</section>
<section id="section-13" class="slide level2 smaller">
<h2></h2>
<ul>
<li>We have computed in Lecture 8 that</li>
</ul>
<p><span class="math display">
(Z^T Z)^{-1} =
\frac{1}{n S_{xx} }
\left(
\begin{array}{cc}
\sum_{i=1}^n x^2_i &amp; -n \overline{x}\\
-n\overline{x} &amp; n
\end{array}
\right)
</span></p>
<ul>
<li>Hence the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> for <span class="math inline">\hat \alpha</span> and <span class="math inline">\hat \beta</span> are</li>
</ul>
<p><span class="math display">\begin{align*}
\mathop{\mathrm{e.s.e.}}(\hat \alpha) &amp; = \xi_{11}^{1/2} \, S = \sqrt{ \frac{ \sum_{i=1}^n x_i^2 }{ n S_{xx} } } \, S \\[7pt]
\mathop{\mathrm{e.s.e.}}(\hat \beta) &amp; = \xi_{22}^{1/2} \, S = \frac{ S }{ \sqrt{ S_{xx} } }
\end{align*}</span></p>
<ul>
<li><strong>Note:</strong> <span class="math inline">\, \mathop{\mathrm{e.s.e.}}(\hat\beta)</span> coincides with the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> in Slide 35</li>
</ul>
</section></section>
<section>
<section id="part-5-f-test-for-multiple-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br>F-test for multiple regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="f-test-for-overall-significance" class="slide level2 smaller">
<h2>F-test for Overall Significance</h2>
<ul>
<li>Want to test the <strong>Overall Significance</strong> of the model</li>
</ul>
<p><span class="math display">
Y_i = \beta_1  + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \varepsilon_i
</span></p>
<ul>
<li>This means answering the question:</li>
</ul>
<p><span class="math display">
\text{ Does at least one } X_i \text{ affect } Y \text{ ?}
</span></p>
<ul>
<li>How to do this?
<ul>
<li>Could perform a sequence of t-tests on the <span class="math inline">\beta_j</span></li>
<li>For statistical reasons this is not really desirable</li>
<li>To assess <strong>overall</strong> significance we can perform <strong>F-test</strong></li>
</ul></li>
</ul>
</section>
<section id="f-test-for-overall-significance-1" class="slide level2 smaller">
<h2>F-test for Overall Significance</h2>
<p>The F-test for Overall Significance has 3 steps:</p>
<ol type="1">
<li><p>Define a larger <strong>Full Model</strong> (with more parameters)</p></li>
<li><p>Define a smaller nested <strong>Reduced Model</strong> (with fewer parameters)</p></li>
<li><p>Use an F-statistic to decide between larger or smaller model</p></li>
</ol>
</section>
<section id="overall-significance-for-multiple-regression" class="slide level2 smaller">
<h2>Overall Significance for multiple regression</h2>
<ul>
<li>Model 1 is the smaller <strong>Reduced Model</strong></li>
<li>Model 2 is the larger <strong>Full Model</strong></li>
</ul>
<p><span class="math display">\begin{align*}
\textbf{Model 1:} &amp; \quad Y_i = \beta_1 + \varepsilon_i \\[15pt]
\textbf{Model 2:} &amp; \quad Y_i = \beta_1  + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \varepsilon_i
\end{align*}</span></p>
<ul>
<li>Choosing the Full Model 2 is equivalent to rejecting <span class="math inline">H_0</span></li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \, \beta_2 = \beta_3 = \ldots = \beta_p = 0 \\
H_1 &amp; \colon \text{ At least one of the } \beta_i \text{ is non-zero}
\end{align*}</span></p>
</section>
<section id="overall-significance-for-simple-regression" class="slide level2 smaller">
<h2>Overall Significance for simple regression</h2>
<ul>
<li>Model 1 is the smaller <strong>Reduced Model</strong></li>
<li>Model 2 is the larger <strong>Full Model</strong></li>
</ul>
<p><span class="math display">\begin{align*}
\textbf{Model 1:} &amp; \quad Y_i = \alpha + \varepsilon_i \\[15pt]
\textbf{Model 2:} &amp; \quad Y_i = \alpha  + \beta x_i  + \varepsilon_i
\end{align*}</span></p>
<ul>
<li>Choosing the Full Model 2 is equivalent to rejecting <span class="math inline">H_0</span></li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \beta = 0 \\
H_1 &amp; \colon \beta \neq 0
\end{align*}</span></p>
</section>
<section id="rss-for-the-full-model" class="slide level2 smaller">
<h2>RSS for the Full Model</h2>
<ul>
<li>Consider the Full Model with <span class="math inline">p</span> parameters</li>
</ul>
<p><span class="math display">
\textbf{Model 2:}  \quad Y_i = \beta_1  + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \varepsilon_i
</span></p>
<ul>
<li>Denote by <span class="math inline">\hat \beta</span> the MLE for the Full Model. Therefore, predictions are</li>
</ul>
<p><span class="math display">
\hat y_i := \hat{\beta}_1  + \hat{\beta}_2 x_{i2} + \ldots + \hat{\beta}_p x_{ip} \,, \quad \forall \, i = 1 , \ldots, n \,,
</span></p>
<ul>
<li>Define the <em>Residual Sum of Squares</em> for the Full Model</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(p) := \sum_{i=1}^n (y_i - \hat y_i)^2
</span></p>
</section>
<section id="rss-for-the-reduced-model" class="slide level2 smaller">
<h2>RSS for the Reduced Model</h2>
<ul>
<li>Consider now the Reduced Model</li>
</ul>
<p><span class="math display">
\textbf{Model 1:} \quad Y_i = \beta_1 + \varepsilon_i
</span></p>
<ul>
<li>Denote by <span class="math inline">\hat{\beta}_1</span> the MLE for the Reduced Model. Therefore, predictions are</li>
</ul>
<p><span class="math display">
\hat y_i = \hat{\beta}_1 \,, \quad \forall \, i = 1 , \ldots, n
</span></p>
<ul>
<li>Define the <em>Residual Sum of Squares</em> for the Reduced Model</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(1) := \sum_{i=1}^n (y_i - \hat{\beta}_1)^2
</span></p>
</section>
<section id="property-of-the-rss" class="slide level2 smaller">
<h2>Property of the RSS</h2>
<ul>
<li><p>Recall that <span class="math inline">\mathop{\mathrm{RSS}}</span> is defined via <strong>minimization</strong> <span class="math display">
\mathop{\mathrm{RSS}}(k) := \min_{\beta_1 , \ldots , \beta_k} \ \sum_{i=1}^n ( y_i - \hat y_i)^2 \,, \qquad
\hat y_i := \beta_1 + \beta_2 x_{i2} + \ldots + \beta_k x_{ik}
</span> with minumum achieved when <span class="math inline">\beta</span> coincides with the MLE <span class="math inline">\hat \beta = (Z^TZ)^{-1}Z^Ty</span></p></li>
<li><p>Therefore <span class="math inline">\mathop{\mathrm{RSS}}</span> cannot increase if we add parameters to the model</p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(1) \geq \mathop{\mathrm{RSS}}(p)
</span></p>
<ul>
<li>In particular, we have that</li>
</ul>
<p><span class="math display">
\frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{RSS}}(p)} \geq 0
</span></p>
</section>
<section id="deciding-between-the-two-models" class="slide level2 smaller">
<h2>Deciding between the two models</h2>
<div style="font-size: 0.95em">
<p>The hypothesis for deciding between the two model is <span class="math display">\begin{align*}
H_0 &amp; \colon \, \beta_2 = \beta_3 = \ldots = \beta_p = 0 \\
H_1 &amp; \colon \text{ At least one of the } \beta_i \text{ is non-zero}
\end{align*}</span></p>
<ul>
<li><p>Suppose the null hypothesis <span class="math inline">H_0</span> holds</p></li>
<li><p>In this case, the Reduced Model and Full models are the same</p></li>
<li><p>Therefore, predictions of Full and Reduced Model will be similar</p></li>
<li><p>Hence, the <span class="math inline">\mathop{\mathrm{RSS}}</span> for the 2 models are similar</p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(1) \, \approx \, \mathop{\mathrm{RSS}}(p)
</span></p>
</div>
</section>
<section id="deciding-between-the-two-models-1" class="slide level2 smaller">
<h2>Deciding between the two models</h2>
<div style="font-size: 0.95em">
<p>The hypothesis for deciding between the two model is <span class="math display">\begin{align*}
H_0 &amp; \colon \, \beta_2 = \beta_3 = \ldots = \beta_p = 0 \\
H_1 &amp; \colon \text{ At least one of the } \beta_i \text{ is non-zero}
\end{align*}</span></p>
<ul>
<li><p>Suppose instead that the alternative hypothesis <span class="math inline">H_1</span> holds</p></li>
<li><p>In this case the predictions of Full and Reduced Model will be different</p></li>
<li><p>As already noted, in general it holds that <span class="math display">
\mathop{\mathrm{RSS}}(1) \geq \mathop{\mathrm{RSS}}(p)
</span></p></li>
<li><p>From <span class="math inline">H_1</span>, we know that some of the extra parameters <span class="math inline">\beta_2 , \ldots, \beta_p</span> are non zero</p></li>
<li><p>Thus, Full Model will give better predictions <span class="math inline">\implies \mathop{\mathrm{RSS}}(p)</span> is <strong>much smaller</strong> <span class="math display">
\mathop{\mathrm{RSS}}(1) \gg \mathop{\mathrm{RSS}}(p)
</span></p></li>
</ul>
</div>
</section>
<section id="conclusion-2-cases" class="slide level2 smaller">
<h2>Conclusion: 2 cases</h2>
<div style="font-size: 0.95em">
<ol type="1">
<li>Choose the Reduced Model:</li>
</ol>
<p><span class="math display">\begin{align*}
H_0 \,\, \text{ holds } &amp; \, \iff \,  \beta_2 = \ldots =  \beta_p = 0 \\[15pt]
&amp; \, \iff \, \mathop{\mathrm{RSS}}(1) \approx \mathop{\mathrm{RSS}}(p) \, \iff \, \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{RSS}}(p)} \approx 0
\end{align*}</span></p>
<ol start="2" type="1">
<li>Choose the Full Model:</li>
</ol>
<p><span class="math display">\begin{align*}
H_1 \,\, \text{ holds } &amp; \, \iff \, \exists \,\, i \, \text{ s.t.  } \, \beta_i \neq 0 \\[15pt]
&amp; \, \iff \, \mathop{\mathrm{RSS}}(1) \gg \mathop{\mathrm{RSS}}(p) \, \iff \, \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{RSS}}(p)} \gg 0
\end{align*}</span></p>
</div>
</section>
<section id="construction-of-f-statistic" class="slide level2 smaller">
<h2>Construction of F-statistic</h2>
<ul>
<li>Thus, the quantity below could be used as statistic to decide between the 2 models</li>
</ul>
<p><span class="math display">
\frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{RSS}}(p)}
</span></p>
<ul>
<li><p>However, in order to obtain a known distribution, we need to rescale</p></li>
<li><p>Note that the degrees of freedom of Reduced Model (1 parameter) are</p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{df}}(1) = n - 1
</span></p>
<ul>
<li>The degrees of freedom of the Full Model (p parameters) are</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{df}}(p) = n - p
</span></p>
</section>
<section id="f-statistic-for-overall-significance" class="slide level2 smaller">
<h2>F-statistic for Overall Significance</h2>
<div id="Definition*-6.1" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>The <strong>F-statistic</strong> for Overall Significance is<p></p>
<p><span class="math display">\begin{align*}
F &amp; := \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{ \mathop{\mathrm{df}}(1) - \mathop{\mathrm{df}}(p) } \bigg/
\frac{\mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{df}}(p)}  \\[15pt]
  &amp; = \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{ p - 1 } \bigg/
\frac{\mathop{\mathrm{RSS}}(p)}{n - p}
\end{align*}</span></p>
</div></details>
</div>
<p><strong>Theorem:</strong> The F-statistic for Overall Significance has F-distribution</p>
<p><span class="math display">
F \, \sim \, F_{p-1,n-p}
</span></p>
</section>
<section id="rewriting-the-f-statistic" class="slide level2 smaller">
<h2>Rewriting the F-statistic</h2>
<div id="Proposition*-6.2" class="Proposition">
<p></p><details class="Proposition fbx-simplebox fbx-default" open=""><summary><strong>Proposition</strong></summary><div>The F-statistic can be rewritten as<p></p>
<p><span class="math display">\begin{align*}
F &amp; = \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{ p - 1 } \bigg/
\frac{\mathop{\mathrm{RSS}}(p)}{n - p}  \\[15pt]
  &amp; = \frac{R^2}{1 - R^2} \, \cdot \, \frac{n - p}{p - 1}
\end{align*}</span></p>
</div></details>
</div>
</section>
<section id="proof-of-proposition" class="slide level2 smaller">
<h2>Proof of Proposition</h2>
<ul>
<li><p>Recall the definition of <em>Total Sum of Squares</em> <span class="math display">
\mathop{\mathrm{TSS}}= \sum_{i=1}^n (y_i - \overline{y})^2
</span></p></li>
<li><p>Notice that the definition of <span class="math inline">\mathop{\mathrm{TSS}}</span> does not depend on <span class="math inline">p</span></p></li>
<li><p>Recall the definition of <span class="math inline">R^2</span> for the Full Model (which has p parameters) <span class="math display">
R^2 = 1 - \frac{\mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{TSS}}}
</span></p></li>
<li><p>From the above, we obtain</p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(p) = (1 - R^2) \mathop{\mathrm{TSS}}
</span></p>
</section>
<section id="section-14" class="slide level2 smaller">
<h2></h2>
<ul>
<li>By definition, we have that</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(1) = \min_{\beta_1} \ \sum_{i=1}^n (y_i - \beta_1)^2
</span></p>
<ul>
<li><strong>Exercise:</strong> Check that the unique solution to the above problem is</li>
</ul>
<p><span class="math display">
\beta_1 = \overline{y}
</span></p>
<ul>
<li>Therefore, we have</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(1) =  \sum_{i=1}^n (y_i - \overline{y})^2 = \mathop{\mathrm{TSS}}
</span></p>
</section>
<section id="section-15" class="slide level2 smaller">
<h2></h2>
<ul>
<li>We just obtained the two identities</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}(p) = (1 - R^2) \mathop{\mathrm{TSS}}\,, \qquad \quad \mathop{\mathrm{RSS}}(1) = \mathop{\mathrm{TSS}}
</span></p>
<ul>
<li>From the above, we conclude the proof</li>
</ul>
<p><span class="math display">\begin{align*}
F &amp; = \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{ p - 1 } \bigg/
\frac{\mathop{\mathrm{RSS}}(p)}{n - p}  \\[15pt]
  &amp; = \frac{\mathop{\mathrm{TSS}}- (1 - R^2) \mathop{\mathrm{TSS}}}{ p - 1 } \bigg/
\frac{(1 - R^2) \mathop{\mathrm{TSS}}}{n - p}\\[15pt]
  &amp; = \frac{R^2}{1 - R^2} \, \cdot \, \frac{n - p}{p - 1}
\end{align*}</span></p>
</section>
<section id="testing-overall-significance" class="slide level2 smaller">
<h2>Testing Overall Significance</h2>
<ul>
<li><p><strong>Recall:</strong> We want to test the <em>Overall Significance</em> of the parameters <span class="math inline">\beta_2,\ldots, \beta_p</span></p></li>
<li><p>This means deciding which model gives better predictions between <span class="math display">\begin{align*}
\textbf{Model 1:} &amp; \quad Y_i = \beta_1 + \varepsilon_i  &amp; \text{Reduced Model}\\[15pt]
\textbf{Model 2:} &amp; \quad Y_i = \beta_1  + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \varepsilon_i &amp; \text{Full Model}
\end{align*}</span></p></li>
<li><p>To make a decision, we have formulated the hypothesis <span class="math display">\begin{align*}
H_0 &amp; \colon \, \beta_2 = \beta_3 = \ldots = \beta_p = 0 \\
H_1 &amp; \colon \text{ At least one of the } \beta_i \text{ is non-zero}
\end{align*}</span></p></li>
<li><p><span class="math inline">H_0</span> favors Model 1</p></li>
<li><p><span class="math inline">H_1</span> favors Model 2</p></li>
</ul>
</section>
<section id="section-16" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.95em">
<p>We use the F-statistic to decide between the two models <span class="math display">
F = \frac{\mathop{\mathrm{RSS}}(1) - \mathop{\mathrm{RSS}}(p)}{ p - 1 } \bigg/
\frac{\mathop{\mathrm{RSS}}(p)}{n - p}
</span></p>
<ol type="1">
<li><p>Choose the Reduced Model: <span class="math display">\begin{align*}
H_0 \,\, \text{ holds }  \, \iff \,  \beta_2 = \ldots =  \beta_p = 0
  \, \iff \, \mathop{\mathrm{RSS}}(1) \approx \mathop{\mathrm{RSS}}(p) \, \iff \, F \approx 0
\end{align*}</span></p></li>
<li><p>Choose the Full Model: <span class="math display">\begin{align*}
H_1 \,\, \text{ holds }  \, \iff \, \exists \,\, i \, \text{ s.t.  } \, \beta_i \neq 0
  \, \iff \, \mathop{\mathrm{RSS}}(1) \gg \mathop{\mathrm{RSS}}(p) \, \iff \, F \gg 0
\end{align*}</span></p></li>
</ol>
<p><strong>Therefore, the test is one-sided: <span class="math inline">\,\,</span> Reject <span class="math inline">H_0 \iff F \gg 0</span></strong></p>
</div>
</section>
<section id="the-f-test-for-overall-significance" class="slide level2 smaller">
<h2>The F-test for Overall Significance</h2>
<p><strong>Assumption:</strong> Given data points <span class="math inline">(x_{i2},\ldots , x_{ip},  y_i)</span>, consider the nested models</p>
<p><span class="math display">\begin{align*}
\textbf{Model 1:} &amp; \quad Y_i = \beta_1 + \varepsilon_i  &amp; \text{Reduced Model}\\[15pt]
\textbf{Model 2:} &amp; \quad Y_i = \beta_1  + \beta_2 x_{i2} + \ldots + \beta_p x_{ip} + \varepsilon_i &amp; \text{Full Model}
\end{align*}</span></p>
<p><strong>Goal:</strong> Testing the <em>Overall Significance</em> of the parameters <span class="math inline">\beta_2,\ldots, \beta_p</span><br>
(i.e.&nbsp;decide which model gives better predictions)</p>
<p><strong>Hypothesis:</strong> Choosing the Full Model 2, is equivalent to rejecting <span class="math inline">H_0</span></p>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \, \beta_2 = \beta_3 = \ldots = \beta_p = 0 \\
H_1 &amp; \colon \text{ At least one of the } \beta_i \text{ is non-zero}
\end{align*}</span></p>
</section>
<section id="procedure-3-steps-2" class="slide level2 smaller">
<h2>Procedure: 3 Steps</h2>
<ol type="1">
<li><strong>Calculation</strong>: Write design matrix <span class="math inline">Z</span>, and compute MLE <span class="math inline">\hat{\beta}</span> and predictions <span class="math inline">\hat{y}_i</span> <span class="math display">
Z =
\left(
\begin{array}{cccc}
1 &amp; x_{12} &amp; \ldots &amp; x_{1p} \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
1 &amp; x_{n2} &amp; \ldots &amp; x_{np} \\
\end{array}
\right) \,, \qquad \hat{\beta} = (Z^TZ)^{-1} Z^T y \,, \qquad \hat{y} = Z \hat{\beta}
</span> Compute the <span class="math inline">\mathop{\mathrm{RSS}}</span>, <span class="math inline">\mathop{\mathrm{TSS}}</span> and <span class="math inline">R^2</span> coefficient for the Full Model <span class="math display">
\mathop{\mathrm{RSS}}(p) = \sum_{i=1}^n (y_i - \hat{y}_i)^2 \,, \qquad
\mathop{\mathrm{TSS}}= \sum_{i=1}^n (y_i - \overline{y})^2\,, \qquad
R^2 = 1 - \frac{\mathop{\mathrm{RSS}}(p)}{\mathop{\mathrm{TSS}}}
</span> Finally, compute the F-statistic for <em>Overall Significance</em> <span class="math display">
F = \frac{R^2}{1 - R^2} \, \cdot \, \frac{n - p}{p - 1} \ \sim \ F_{p-1, n - p}
</span></li>
</ol>
</section>
<section id="section-17" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>: Find either
<ul>
<li>Critical value <span class="math inline">F^*</span> in <a href="files/Statistics_Tables.pdf">Table 3</a></li>
<li>p-value in R</li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" type="1">
<li><strong>Interpretation</strong>: Reject <span class="math inline">H_0</span> when either <span class="math display">
p &lt; 0.05 \qquad \text{ or } \qquad F \in \,\,\text{Rejection Region}
</span></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>Rejection Region</th>
<th><span class="math inline">F^*</span></th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>At least one of the <span class="math inline">\beta_i</span> is non-zero</td>
<td><span class="math inline">F &gt; F^*</span></td>
<td><span class="math inline">F_{p-1,n-p}(0.05)</span></td>
<td><span class="math inline">P(F_{p-1,n-p} &gt; F)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="the-f-test-for-overall-significance-in-r" class="slide level2 smaller">
<h2>The F-test for Overall Significance in R</h2>
<ol type="1">
<li><p>Fit the Full Model with <code>lm</code></p></li>
<li><p>Read the <em>Summary</em></p>
<ul>
<li>F-statistic is listed in the summary</li>
<li>p-value is listed in the summary</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Full Model</span></span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> ... <span class="sc">+</span> xp)</span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Read the summary</span></span>
<span id="cb19-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(full.model)</span>
<span id="cb19-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic for simple regression {.smaller}</span></span>
<span id="cb19-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> Proposition</span>
<span id="cb19-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> The <span class="sc">$</span>F<span class="sc">$-</span>statistic <span class="cf">for</span> Overall Significance <span class="cf">in</span> simple regression is</span>
<span id="cb19-15"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-16"><a aria-hidden="true" tabindex="-1"></a>F <span class="ot">=</span> t<span class="sc">^</span><span class="dv">2</span> \,, \qquad \quad t <span class="ot">=</span> \frac{\hat \beta}{ S <span class="sc">/</span> \sqrt{S_{xx}}}</span>
<span id="cb19-17"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-18"><a aria-hidden="true" tabindex="-1"></a>where <span class="sc">$</span>t<span class="sc">$</span> is the t<span class="sc">-</span>statistic <span class="cf">for</span> <span class="sc">$</span>\hat \beta<span class="sc">$</span>.</span>
<span id="cb19-19"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> In particular, the p<span class="sc">-</span>values <span class="cf">for</span> t<span class="sc">-</span>test and F<span class="sc">-</span>test coincide</span>
<span id="cb19-21"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-22"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">2</span><span class="fu">P</span>( t_{n<span class="dv">-2</span>} <span class="sc">&gt;</span> <span class="er">|</span>t<span class="sc">|</span> ) <span class="ot">=</span> <span class="fu">P</span>( <span class="sc">|</span>t_{n<span class="dv">-2</span>}<span class="sc">|</span> <span class="er">&gt;</span> <span class="er">|</span>t<span class="sc">|</span> )  <span class="ot">=</span> <span class="fu">P</span>( F_{<span class="dv">1</span>,n<span class="dv">-2</span>} <span class="sc">&gt;</span> F )</span>
<span id="cb19-23"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-24"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a aria-hidden="true" tabindex="-1"></a><span class="er">:::</span></span>
<span id="cb19-26"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a aria-hidden="true" tabindex="-1"></a><span class="er">**</span>Proof<span class="sc">:</span><span class="er">**</span> Will be left as an exercise</span>
<span id="cb19-28"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a aria-hidden="true" tabindex="-1"></a><span class="do">## Worked Example: Stock and Gold prices {.smaller}</span></span>
<span id="cb19-33"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Recall that </span>
<span id="cb19-35"><a aria-hidden="true" tabindex="-1"></a>    <span class="sc">*</span> <span class="er">$</span>X <span class="ot">=</span><span class="er">$</span> Stock Price</span>
<span id="cb19-36"><a aria-hidden="true" tabindex="-1"></a>    <span class="sc">*</span> <span class="er">$</span>Y <span class="ot">=</span><span class="er">$</span> Gold Price</span>
<span id="cb19-37"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-38"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Consider the simple linear regression model</span>
<span id="cb19-39"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-41"><a aria-hidden="true" tabindex="-1"></a>Y_i <span class="ot">=</span>  \alpha <span class="sc">+</span> \beta x_i <span class="sc">+</span> \e_i </span>
<span id="cb19-42"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-43"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> We want to test the <span class="sc">**</span>Overall Significance<span class="sc">**</span> of the parameter <span class="sc">$</span>\beta<span class="sc">$</span></span>
<span id="cb19-45"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a aria-hidden="true" tabindex="-1"></a><span class="do">## {.smaller}</span></span>
<span id="cb19-48"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> This means deciding which of the two models below gives better predictions</span>
<span id="cb19-50"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a aria-hidden="true" tabindex="-1"></a>\begin{align<span class="sc">*</span>}</span>
<span id="cb19-52"><a aria-hidden="true" tabindex="-1"></a>\textbf{Model <span class="dv">1</span><span class="sc">:</span>} <span class="sc">&amp;</span> \quad Y_i <span class="ot">=</span> \alpha <span class="sc">+</span> \e_i  <span class="sc">&amp;</span> \text{Reduced Model}\\[<span class="dv">15</span>pt]</span>
<span id="cb19-53"><a aria-hidden="true" tabindex="-1"></a>\textbf{Model <span class="dv">2</span><span class="sc">:</span>} <span class="sc">&amp;</span> \quad Y_i <span class="ot">=</span> \alpha  <span class="sc">+</span> \beta x_{i} <span class="sc">+</span> \e_i <span class="sc">&amp;</span> \text{Full Model}</span>
<span id="cb19-54"><a aria-hidden="true" tabindex="-1"></a>\end{align<span class="sc">*</span>}</span>
<span id="cb19-55"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-56"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> <span class="er">**</span>Hypothesis<span class="sc">:</span><span class="er">**</span> Choosing the Full Model <span class="dv">2</span>, is equivalent to rejecting <span class="sc">$</span>H_0<span class="sc">$</span></span>
<span id="cb19-57"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a aria-hidden="true" tabindex="-1"></a>\begin{align<span class="sc">*</span>}</span>
<span id="cb19-59"><a aria-hidden="true" tabindex="-1"></a>H_0 <span class="sc">&amp;</span> \colon \, \beta <span class="ot">=</span> <span class="dv">0</span> \\</span>
<span id="cb19-60"><a aria-hidden="true" tabindex="-1"></a>H_1 <span class="sc">&amp;</span> \colon \, \beta \neq <span class="dv">0</span></span>
<span id="cb19-61"><a aria-hidden="true" tabindex="-1"></a>\end{align<span class="sc">*</span>}</span>
<span id="cb19-62"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Let us perform the F<span class="sc">-</span>test <span class="cf">in</span> R</span>
<span id="cb19-64"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-65"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-67"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-68"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-69"><a aria-hidden="true" tabindex="-1"></a><span class="do">##  {.smaller}</span></span>
<span id="cb19-70"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-71"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Recall that Stock Prices and Gold Prices are stored <span class="cf">in</span> R vectors</span>
<span id="cb19-72"><a aria-hidden="true" tabindex="-1"></a>    <span class="sc">*</span> <span class="st">``</span>stock.price<span class="st">``</span></span>
<span id="cb19-73"><a aria-hidden="true" tabindex="-1"></a>    <span class="sc">*</span> <span class="st">``</span>gold.price<span class="st">``</span></span>
<span id="cb19-74"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-75"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-76"><a aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Fit the simple linear model with the following commands</span>
<span id="cb19-77"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-78"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-79"><a aria-hidden="true" tabindex="-1"></a>\text{gold.price } <span class="ot">=</span> \alpha <span class="sc">+</span> \beta \, \<span class="fu">times</span> ( \text{ stock.price } ) <span class="sc">+</span> \text{ error}</span>
<span id="cb19-80"><a aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span></span>
<span id="cb19-81"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-82"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-83"><a aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">r</span></span>
<span id="cb19-84"><a aria-hidden="true" tabindex="-1"></a><span class="at"># Fit simple linear regression model</span></span>
<span id="cb19-85"><a aria-hidden="true" tabindex="-1"></a><span class="at">fit.model &lt;- lm(gold.price ~ stock.price)</span></span>
<span id="cb19-86"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-87"><a aria-hidden="true" tabindex="-1"></a><span class="at"># Print result to screen</span></span>
<span id="cb19-88"><a aria-hidden="true" tabindex="-1"></a><span class="at">summary(fit.model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="output-f-statistic-and-p-value" class="slide level2 smaller">
<h2>Output: F-statistic and p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_3.png" style="width:80.0%"></p>
</div></div>
<ul>
<li><p>The computed F-statistic is <span class="math inline">F = 20.27</span></p></li>
<li><p>There are <span class="math inline">n = 33</span> data points, and <span class="math inline">p = 2</span> parameters in the Full Model</p></li>
<li><p>Therefore, the degrees of freedom are <span class="math display">
{\rm df}_1 = p - 1 = 2 - 1 = 1 \,, \qquad
{\rm df}_2 = n - p = 33 - 2 = 31
</span> These are listed in the output, after the F-statistic</p></li>
<li><p>In particular, we have that the F-statistic has distribution <span class="math display">
F \ \sim \ F_{{\rm df}_1, {\rm df}_2} = F_{1,31}
</span></p></li>
</ul>
</section>
<section id="output-f-statistic-and-p-value-1" class="slide level2 smaller">
<h2>Output: F-statistic and p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_3.png" style="width:80.0%"></p>
</div></div>
<ul>
<li><p>The computed p-value is <span class="math display">
p = P( F_{1,31} &gt; F ) = 8.904 \times 10^{-5}
</span></p></li>
<li><p><strong>Conclusion:</strong> Strong evidence (<span class="math inline">p=0.000</span>) that the parameter <span class="math inline">\beta</span> is significant</p>
<ul>
<li>Going back to the model, this means that <em>Stock Price</em> affects <em>Gold Price</em></li>
</ul></li>
</ul>
</section>
<section id="output-f-statistic-and-p-value-2" class="slide level2 smaller">
<h2>Output: F-statistic and p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_3.png" style="width:80.0%"></p>
</div></div>
<p>We could also compute F-statistic by hand</p>
<ul>
<li><p>From the output we see that <span class="math inline">R^2 = 0.3953</span></p></li>
<li><p>We have <span class="math inline">p = 2</span> and <span class="math inline">n =33</span></p></li>
<li><p>Therefore</p></li>
</ul>
<p><span class="math display">
F = \frac{ R^2 }{ 1 - R^2  } \, \cdot \, \frac{n-p}{p-1} = \frac{0.395325}{0.604675} \, \cdot \, \frac{31}{1} = 20.267
</span></p>
</section>
<section id="output-f-statistic-and-p-value-3" class="slide level2 smaller">
<h2>Output: F-statistic and p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_3.png" style="width:80.0%"></p>
</div></div>
<ul>
<li>Similarly, the p-value could be computed by hand</li>
</ul>
<p><span class="math display">
p = P( F_{1,31} &gt; F ) = 8.904 \times 10^{-5}
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">20.267</span>    <span class="co"># Input the precise value, rather than the rounded one given in Summary</span></span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">33</span></span>
<span id="cb20-3"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb20-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(F, <span class="at">df1 =</span> p <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> n <span class="sc">-</span> p)</span>
<span id="cb20-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The p-value is"</span>, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is 8.904244e-05</code></pre>
</div>
</div>
</section>
<section id="output-f-statistic-and-p-value-4" class="slide level2 smaller">
<h2>Output: F-statistic and p-value</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/simple_regression_output_cut_3.png" style="width:80.0%"></p>
</div></div>
<ul>
<li><p>We can also find critical value <span class="math inline">F_{1,31} (0.05)</span>, by finding its closest values in <a href="files/Statistics_Tables.pdf">Table 3</a> <span class="math display">
F_{1, 30} (0.05) = 4.17 \,, \qquad \quad  F_{1, 40} (0.05) = 4.08
</span></p></li>
<li><p>Approximate <span class="math inline">F_{1,31} (0.05)</span> by averaging the above values <span class="math display">
F_{1,31}(0.05) \, \approx  \,  \frac{F_{1, 30} (0.05) +  F_{1, 40} (0.05)}{2} = 4.125
</span></p></li>
<li><p>We reject <span class="math inline">H_0</span>, since <span class="math display">
F = 20.267 &gt; F_{1,31}(0.05) = 4.125  \quad \implies \quad  p &lt; 0.05
</span></p></li>
</ul>
</section></section>
<section>
<section id="part-6-worked-example-the-longley-dataset" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 6: <br>Worked Example: <br> The Longley dataset</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="longley-us-macroeconomic-dataset" class="slide level2 smaller">
<h2>Longley US macroeconomic dataset</h2>
<h3 id="economical-variables-observed-yearly-19471962-16-years">7 economical variables, observed yearly 1947–1962 (16 years)</h3>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley.png" style="width:100.0%"></p>
</div></div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="section-18" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<ul>
<li><p>The Longley dataset was analyzed by J.W. Longley in his 1967 paper <span class="citation" data-cites="longley">[<a href="#/references" role="doc-biblioref" onclick="">3</a>]</span></p></li>
<li><p>It is stored in R by default, in the variable <code>longley</code></p></li>
<li><p>The first line of <code>help(longley)</code> reads:</p>
<ul>
<li><em>A macroeconomic data set which provides a well-known example for a highly collinear regression</em></li>
</ul></li>
<li><p>We will see next time what <em>highly collinear</em> means</p></li>
<li><p>For convenience, you can also download the Longley dataset here <a href="datasets/longley.txt">longley.txt</a></p></li>
<li><p>Download the file and place it in current working directory</p></li>
<li><p>Let us load the dataset and read the first 3 lines</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a>longley <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"datasets/longley.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(longley, <span class="at">n =</span> <span class="dv">3</span>)     <span class="co"># Prints the first 3 rows of dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
1949         88.2 258.054      368.2        161.6    109.773 1949   60.171</code></pre>
</div>
</div>
</div>
</section>
<section id="section-19" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
1949         88.2 258.054      368.2        161.6    109.773 1949   60.171</code></pre>
</div>
</div>
<div style="font-size: 0.30em">
<p><br></p>
</div>
<table class="caption-top">
<colgroup>
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 85%">
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">X_2</span></td>
<td>GNP.deflator</td>
<td>Coefficient for adjusting GNP for inflation (<span class="math inline">1954 = 100</span>) (1954 is reference year: other years need adjusting)</td>
</tr>
<tr class="even">
<td><span class="math inline">X_3</span></td>
<td>GNP</td>
<td>Yearly Gross National Product (in Billion Dollars)</td>
</tr>
<tr class="odd">
<td><span class="math inline">X_4</span></td>
<td>Unemployed</td>
<td>Number of unemployed people (in thousands)</td>
</tr>
<tr class="even">
<td><span class="math inline">X_5</span></td>
<td>Armed.Forces</td>
<td>Number of people in the Armed Forces (in thousands)</td>
</tr>
<tr class="odd">
<td><span class="math inline">X_6</span></td>
<td>Population</td>
<td>Non-institutionalized Population <span class="math inline">\geq</span> age 14 (in thousands) (People <span class="math inline">\geq 14</span> not in Armed Forces or care of institutions)</td>
</tr>
<tr class="even">
<td><span class="math inline">X_7</span></td>
<td>Year</td>
<td>The year in which the data is recorded. Range: 1947–1962</td>
</tr>
<tr class="odd">
<td><span class="math inline">Y</span></td>
<td>Employed</td>
<td>Number of employed people (in thousands)</td>
</tr>
</tbody>
</table>
</section>
<section id="analyzing-the-longley-dataset" class="slide level2 smaller">
<h2>Analyzing the Longley Dataset</h2>
<p><strong>Goal:</strong> Explain the number of <em>Employed</em> people <span class="math inline">Y</span> in terms of <span class="math inline">X_i</span> variables</p>
<ul>
<li><p>Longley dataset available here <a href="datasets/longley.txt">longley.txt</a></p></li>
<li><p>Download the file and place it in current working directory</p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Read data file</span></span>
<span id="cb25-2"><a aria-hidden="true" tabindex="-1"></a>longley <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"longley.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store columns in vectors</span></span>
<span id="cb25-5"><a aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> longley[ , <span class="dv">1</span>]        <span class="co"># GNP Deflator</span></span>
<span id="cb25-6"><a aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> longley[ , <span class="dv">2</span>]        <span class="co"># GNP</span></span>
<span id="cb25-7"><a aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> longley[ , <span class="dv">3</span>]        <span class="co"># Unemployed</span></span>
<span id="cb25-8"><a aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> longley[ , <span class="dv">4</span>]        <span class="co"># Armed Forces</span></span>
<span id="cb25-9"><a aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> longley[ , <span class="dv">5</span>]        <span class="co"># Population</span></span>
<span id="cb25-10"><a aria-hidden="true" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> longley[ , <span class="dv">6</span>]        <span class="co"># Year</span></span>
<span id="cb25-11"><a aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> longley[ , <span class="dv">7</span>]         <span class="co"># Employed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fitting-multiple-regression" class="slide level2 smaller">
<h2>Fitting multiple regression</h2>
<ul>
<li>We want to fit the multiple regression model</li>
</ul>
<p><span class="math display">
Y = \beta_1 + \beta_2 \, X_2 + \beta_3 \, X_3 + \beta_4 \, X_4 + \beta_5 \, X_5
    + \beta_6 \, X_6 + \beta_7 \, X_7 + \varepsilon
</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6 <span class="sc">+</span> x7)</span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb26-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li><p>Full code can be downloaded here <a href="codes/longley_regression.R">longley_regression.R</a></p></li>
<li><p>Output is in the next slide</p></li>
</ul>
</section>
<section id="section-20" class="slide level2 smaller">
<h2></h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output.png" style="width:73.0%"></p>
</div></div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="interpreting-r-output" class="slide level2 smaller">
<h2>Interpreting R output</h2>
<p>We are interested in the following information:</p>
<ol type="1">
<li><p>Coefficient of determination <span class="math inline">R^2</span></p></li>
<li><p>Individual t-statistics for the parameters <span class="math inline">\beta_i</span></p></li>
<li><p>F-statistic to assess Overall Significance of parameters <span class="math inline">\beta_i</span></p></li>
</ol>
</section>
<section id="coefficient-of-determination-r2-1" class="slide level2 smaller">
<h2>1. Coefficient of determination <span class="math inline">R^2</span></h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_1.png" style="width:85.0%"></p>
</div></div>
<ul>
<li><p>We have that <span class="math inline">R^2=0.9955</span></p></li>
<li><p><span class="math inline">R^2</span> is very high, which suggests we might have quite a good model</p></li>
<li><p>This means the model explains around 99.6% of the variability in the data</p></li>
<li><p>There is a chance <span class="math inline">R^2</span> is too high to be true<br>
(This means the model is <em>overfitting</em> - More on this later)</p></li>
</ul>
</section>
<section id="individual-t-statistics" class="slide level2 smaller">
<h2>2. Individual t-statistics</h2>
<ul>
<li><p>Look at p-values for each variable <span class="math inline">X_j</span></p></li>
<li><p>Recall: Such p-values refer to the two-sided t-test</p></li>
</ul>
<p><span class="math display">
H_0 \colon \, \beta_j = 0 \qquad  \quad
H_1 \colon \, \beta_j \neq 0
</span></p>
<div class="column" style="width:48%;">
<ul>
<li>Find <span class="math inline">X_j</span> for which <span class="math inline">p &lt; 0.05</span>
<ul>
<li>For <span class="math inline">X_j</span> we reject <span class="math inline">H_0</span></li>
<li>Therefore <span class="math inline">\beta_j \neq 0</span></li>
<li>Hence <span class="math inline">X_j</span> influences <span class="math inline">Y</span></li>
<li><span class="math inline">X_j</span> is statistically significant</li>
</ul></li>
</ul>
</div><div class="column" style="width:48%;">
<ul>
<li>In dissertations <span class="math inline">p &lt; 0.1</span> is OK
<ul>
<li>Weak evidence against <span class="math inline">H_0</span></li>
<li><span class="math inline">X_j</span> has some weak effect on <span class="math inline">Y</span></li>
</ul></li>
</ul>
</div></section>
<section id="section-21" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_3.png" style="width:83.0%"></p>
</div><p><br></p>
<p><strong>Stars in output help you find the significant p-values</strong></p>
<p><br></p>
<table class="caption-top">
<colgroup>
<col style="width: 35%">
<col style="width: 40%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Significance code</th>
<th style="text-align: left;">p-value</th>
<th style="text-align: left;">Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No stars</td>
<td style="text-align: left;"><span class="math inline">0.1 \leq p \leq 1</span></td>
<td style="text-align: left;"><span class="math inline">\beta_j = 0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{.}</span></td>
<td style="text-align: left;"><span class="math inline">0.05 \leq p &lt; 0.1</span></td>
<td style="text-align: left;"><span class="math inline">\beta_j = 0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{*}</span></td>
<td style="text-align: left;"><span class="math inline">0.1 \leq p &lt; 0.05</span></td>
<td style="text-align: left;"><span class="math inline">\beta_j \neq 0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\texttt{**}</span></td>
<td style="text-align: left;"><span class="math inline">0.001 \leq p &lt; 0.01</span></td>
<td style="text-align: left;"><span class="math inline">\beta_j \neq 0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\texttt{***}</span></td>
<td style="text-align: left;"><span class="math inline">p &lt; 0.001</span></td>
<td style="text-align: left;"><span class="math inline">\beta_j \neq 0</span></td>
</tr>
</tbody>
</table>
</section>
<section id="section-22" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><p><strong>Interpretation:</strong> Not all variables are statistically significant</p>
<ul>
<li>This is because some variables have no stars</li>
<li>Significant variables have at least one star</li>
</ul>
</section>
<section id="section-23" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><ol type="1">
<li>Intercept has two stars <span class="math inline">\, \texttt{**}</span> and hence is significant
<ul>
<li>The p-value is <span class="math inline">p = 0.00356</span></li>
<li>Since <span class="math inline">p &lt; 0.05</span>, we conclude that the real intercept is <span class="math inline">\beta_1 \neq 0</span></li>
<li>Estimated intercept is <span class="math inline">\hat \beta_1 = -3.482 \times 10^{3}</span></li>
</ul></li>
</ol>
</section>
<section id="section-24" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><ol start="2" type="1">
<li><span class="math inline">X_2, X_3, X_6</span> have no stars
<ul>
<li>p-values are <span class="math inline">p \geq 0.1</span> and therefore the real <span class="math inline">\beta_2 = \beta_3 = \beta_6 = 0</span></li>
<li>Notice that the ML Estimators <span class="math inline">\hat{\beta}_2, \hat{\beta}_3, \hat{\beta}_6</span> are not zero</li>
<li>However, these estimates have to be ignored as t-test is not significant</li>
<li><span class="math inline">X_2, X_3, X_6</span> have no effect on <span class="math inline">Y</span></li>
<li>Hence <em>GNP Deflator, GNP</em> and <em>Population</em> do not affect <em>Number of Employed</em></li>
</ul></li>
</ol>
</section>
<section id="section-25" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><ol start="3" type="1">
<li><span class="math inline">X_4</span> has two stars <span class="math inline">\, \texttt{**}</span>, and hence is significant
<ul>
<li>Since <span class="math inline">p&lt;0.05</span> we have that <span class="math inline">\beta_4 \neq 0</span></li>
<li>Estimated coefficient is <span class="math inline">\hat \beta_4 &lt; 0</span></li>
<li>Since <span class="math inline">\hat \beta_4 &lt; 0</span>, we have that <span class="math inline">X_4</span> negatively affects <span class="math inline">Y</span></li>
<li>As the <em>Number of Unemployed</em> increases, the <em>Number of Employed</em> decreases</li>
</ul></li>
</ol>
</section>
<section id="section-26" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><ol start="4" type="1">
<li><span class="math inline">X_5</span> has three stars <span class="math inline">\, \texttt{***}</span>, and hence is significant
<ul>
<li>Since <span class="math inline">p&lt;0.05</span>, we have that <span class="math inline">\beta_5 \neq 0</span></li>
<li>Estimated coefficient is <span class="math inline">\hat \beta_5 &lt; 0</span></li>
<li>Therefore <span class="math inline">X_5</span> negatively affects <span class="math inline">Y</span></li>
<li>As the size of <em>Armed Forces</em> increases, the <em>Number of Employed</em> decreases</li>
</ul></li>
</ol>
</section>
<section id="section-27" class="slide level2 smaller">
<h2></h2>
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_2.png" style="width:68.0%"></p>
</div><ol start="5" type="1">
<li><span class="math inline">X_7</span> has two stars <span class="math inline">\, \texttt{**}</span>, and hence is significant
<ul>
<li>Since <span class="math inline">p&lt;0.05</span> we have that <span class="math inline">\beta_7 \neq 0</span></li>
<li>Estimated coefficient is <span class="math inline">\hat \beta_7 &gt; 0</span></li>
<li>Therefore <span class="math inline">X_7</span> positively affects <span class="math inline">Y</span></li>
<li>Remember that <span class="math inline">X_7</span> is the <em>Year</em></li>
<li>The <em>Number of Employed</em> is generally increasing from 1947 to 1962</li>
</ul></li>
</ol>
</section>
<section id="f-statistic-to-assess-overall-significance" class="slide level2 smaller">
<h2>3. F-statistic to assess Overall Significance</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_1.png" style="width:85.0%"></p>
</div></div>
<ul>
<li><p>The F-statistic is <span class="math inline">F = 330.3</span>, with distribution <span class="math inline">F_{6, 9}</span></p></li>
<li><p>The p-value for F-test is <span class="math inline">p = 4.984 \times 10^{-10} &lt; 0.05</span></p></li>
<li><p>Recall: F-statistic and p-value refer to the F-test for</p></li>
</ul>
<p><span class="math display">
H_0 \colon \, \beta_2 =  \ldots = \beta_6 = 0  \,, \qquad
H_1 \colon \, \text{At least one } \beta_j \neq 0
</span></p>
<ul>
<li><p>Since <span class="math inline">p &lt; 0.05</span>, we reject <span class="math inline">H_0</span></p></li>
<li><p>There is evidence that at least one of the <span class="math inline">X</span>-variables affects <span class="math inline">Y</span></p></li>
</ul>
</section>
<section id="conclusions" class="slide level2 smaller">
<h2>Conclusions</h2>
<ul>
<li><p>From F-test: There is evidence that at least one of the <span class="math inline">X</span>-variables affects <span class="math inline">Y</span></p></li>
<li><p>From individual t-tests, we have:</p>
<ul>
<li><span class="math inline">X_2, X_3, X_6</span> do not affect <span class="math inline">Y</span></li>
<li><span class="math inline">X_4</span> and <span class="math inline">X_5</span> negatively affect <span class="math inline">Y</span></li>
<li><span class="math inline">X_7</span> positively affects <span class="math inline">Y</span></li>
</ul></li>
<li><p>Coefficient of determination <span class="math inline">R^2</span> is really high:</p>
<ul>
<li>The model explains around 99.6% of the variability in the data</li>
</ul></li>
</ul>
<p><strong>Warning:</strong> The extremely high <span class="math inline">R^2</span> looks very suspicious</p>
<ul>
<li>Indeed, this is too good to be true, and it happens for 2 reasons</li>
</ul>
</section>
<section id="reason-1-overfitting" class="slide level2 smaller">
<h2>Reason 1: Overfitting</h2>
<ul>
<li><p>There are 16 sample points (16 years observed)</p></li>
<li><p>There are 6 variables</p></li>
<li><p>Sample is small and variables too many: the model can easily <strong>overfit</strong></p></li>
<li><p>Generally, adding more variables to the model improves predictions</p></li>
<li><p>In turn, this can artificially inflate <span class="math inline">R^2</span></p></li>
</ul>
<p><span class="math display">
\hat{y}_i \approx y_i \quad \implies \quad \mathop{\mathrm{RSS}}\approx 0 \quad \implies \quad R^2 = 1 - \frac{\mathop{\mathrm{RSS}}}{\mathop{\mathrm{TSS}}} \approx 1
</span></p>
<ul>
<li>Despite higher <span class="math inline">R^2</span>, the model might not make good predictions</li>
</ul>
</section>
<section id="section-28" class="slide level2 smaller">
<h2></h2>
<p><strong>Overfitting Example:</strong> Think of a polynomial passing through all the data points</p>
<ul>
<li><p>Polynomial explains data perfectly <span class="math display">
\hat{y}_i = y_i \quad \implies \quad \mathop{\mathrm{RSS}}= 0 \quad \implies \quad R^2 = 1 - \frac{\mathop{\mathrm{RSS}}}{\mathop{\mathrm{TSS}}} = 1
</span></p></li>
<li><p>However, the trend is clearly linear</p></li>
<li><p>Polynomial model artificially increases <span class="math inline">R^2</span>, but predictions are not better</p></li>
</ul>

<img data-src="lecture_9_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="reason-2-multicollinearity" class="slide level2 smaller">
<h2>Reason 2: Multicollinearity</h2>
<div style="font-size: 0.95em">
<ul>
<li><p>An assumption of regression is independence of the variables <span class="math inline">X_i</span></p></li>
<li><p>In particular, this implies the <span class="math inline">X_i</span> are uncorrelated</p></li>
<li><p>However, the Longley dataset contains several correlated variables</p></li>
<li><p><strong>Example:</strong> <em>GNP</em>, <em>Population</em> and <em>GNP Deflator</em> are highly correlated</p>
<ul>
<li>Growing economy (higher Population and GNP) increases inflation (GNP Deflator)</li>
</ul></li>
<li><p>Multicollinearity leads to a strange phenomenon:</p>
<ul>
<li>We have seen that <em>GNP</em>, <em>Population</em> and <em>GNP Deflator</em> do not affect <em>Employed</em></li>
<li>However, common sense says they should</li>
<li>At the same time, high <span class="math inline">R^2</span> suggests a good model</li>
<li>What is going on?</li>
</ul></li>
<li><p><strong>Multicollinearity breaks the model: t-tests for individual coefficients are unreliable</strong></p></li>
</ul>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-casella-berger" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Casella, George, Berger, Roger L., Statistical inference, second edition, Brooks/Cole, 2002.</div>
</div>
<div id="ref-degroot" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">DeGroot, Morris H., Schervish, Mark J., Probability and statistics, Fourth Edition, Addison-Wesley, 2012.</div>
</div>
<div id="ref-longley" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">J.W. Longley, An appraisal of least-squares programs from the point of view of the user, Journal of the American Statistical Association. 62 (1967) 819–841.</div>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>