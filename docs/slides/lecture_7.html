<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 7</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="lecture-7-the-chi-squared-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Lecture 7: <br>The chi-squared test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-lecture-7" class="slide level2">
<h2>Outline of Lecture 7</h2>
<ol type="1">
<li>Overview</li>
<li>Chi-squared goodness-of-fit test</li>
<li>Goodness-of-fit test: Examples</li>
<li>Monte Carlo simulations</li>
<li>Contingency tables</li>
<li>Chi-squared test of independence</li>
<li>Test of independence: Examples</li>
</ol>
</section></section>
<section>
<section id="part-1-overview" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Overview</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="problem-statement" class="slide level2 smaller">
<h2>Problem statement</h2>
<p><strong>Data:</strong> in the form of <strong>numerical counts</strong></p>
<p><strong>Test:</strong> difference between observed counts and predictions of theoretical model</p>
<p><strong>Example</strong>: Blood counts</p>
<ul>
<li><p>Suppose to have counts of blood type for some people</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2162</td>
<td style="text-align: center;">738</td>
<td style="text-align: center;">228</td>
<td style="text-align: center;">2876</td>
</tr>
</tbody>
</table></li>
<li><p>We want to compare the above to the probability model</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">1/24</td>
<td style="text-align: center;">1/2</td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="counts-with-multiple-factors" class="slide level2 smaller">
<h2>Counts with multiple factors</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong> Relative performance of Manchester United managers</p>
<ul>
<li>Each football manager has Win, Draw and Loss count</li>
</ul>
</section>
<section id="counts-with-multiple-factors-1" class="slide level2 smaller">
<h2>Counts with multiple factors</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<p><strong>Questions:</strong></p>
<ul>
<li>Is the number of Wins, Draws and Losses uniformly distributed?</li>
<li>Are there differences between the performances of each manager?</li>
</ul>
</section>
<section id="chi-squared-test" class="slide level2 smaller">
<h2>Chi-squared test</h2>
<ul>
<li><p>Hypothesis testing for counts can be done using chi-squared test</p></li>
<li><p>Chi-squared test is simple to use for real-world project datasets (e.g.&nbsp;dissertations)</p></li>
<li><p>Potentially applicable to a whole range of different models</p></li>
<li><p>Easy to compute by hand/software</p></li>
<li><p>Motivates the more advanced study of contingency tables</p></li>
</ul>
</section></section>
<section>
<section id="part-2-chi-squared-goodness-of-fit-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Chi-squared <br> goodness-of-fit test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="chi-squared-goodness-of-fit-test" class="slide level2 smaller">
<h2>Chi-squared goodness-of-fit test</h2>
<p><strong>Categorical Data:</strong></p>
<ul>
<li>Finite number of possible categories or types</li>
<li>Observations can only belong to one category</li>
<li><span class="math inline">O_i</span> refers to <strong>observed count</strong> of category <span class="math inline">i</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Type <span class="math inline">1</span></th>
<th style="text-align: center;">Type <span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;">Type <span class="math inline">n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">O_1</span></td>
<td style="text-align: center;"><span class="math inline">O_2</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_n</span></td>
</tr>
</tbody>
</table>
<ul>
<li><span class="math inline">E_i</span> refers to <strong>expected count</strong> of category <span class="math inline">i</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Type <span class="math inline">1</span></th>
<th style="text-align: center;">Type <span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;">Type <span class="math inline">n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">E_1</span></td>
<td style="text-align: center;"><span class="math inline">E_2</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_n</span></td>
</tr>
</tbody>
</table>
</section>
<section id="chi-squared-goodness-of-fit-test-1" class="slide level2 smaller">
<h2>Chi-squared goodness of fit test</h2>
<p><strong>Goal:</strong> Compare expected counts <span class="math inline">E_i</span> with observed counts <span class="math inline">O_i</span></p>
<p><strong>Method:</strong></p>
<ul>
<li>Null hypothesis: The theoretical model for expected counts is correct</li>
<li>Look for evidence against the null hypothesis</li>
<li>Null hypothesis is wrong
<ul>
<li>If distance between observed counts and expected counts is large</li>
<li>For example if <span class="math display">
  (O_i - E_i)^2 \geq c
  </span> for some chosen constant <span class="math inline">c</span></li>
</ul></li>
</ul>
</section>
<section id="chi-squared-statistic" class="slide level2 smaller">
<h2>Chi-squared statistic</h2>
<div id="Definition*-3.1" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>Global distance between observed and expected counts is defined as <span class="math display">
\chi^2 := \sum_{i=1}^n \frac{(O_i-E_i)^2}{E_i}
</span> The above is called <strong>chi-squared statistic</strong><p></p>
</div></details>
</div>
<p><strong>Note:</strong> We have that <span class="math display">
\chi^2 = 0 \qquad \iff \qquad O_i = E_i  \,\,\,\, \text{ for all } \,\,\,\, i = 1 , \, \ldots , \, n
</span></p>
</section>
<section id="chi-squared-statistic-1" class="slide level2 smaller">
<h2>Chi-squared statistic</h2>
<p><strong>Remarks:</strong></p>
<ul>
<li>We expect small differences between <span class="math inline">O_i</span> and <span class="math inline">E_i</span>
<ul>
<li>Therefore <span class="math inline">\chi^2 &gt; 0</span></li>
</ul></li>
<li>However <span class="math inline">O_i</span> should not be too far away from <span class="math inline">E_i</span>
<ul>
<li>Therefore <span class="math inline">\chi^2</span> should not be too large</li>
</ul></li>
<li>The above imply that tests on <span class="math inline">\chi^2</span> should be one-sided</li>
</ul>
</section>
<section id="modelling-counts" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p><strong>Multinomial distribution:</strong> is a model for the following experiment</p>
<ul>
<li>The experiment consists of <span class="math inline">m</span> independent trials</li>
<li>Each trial results in one of <span class="math inline">n</span> distinct possible outcomes</li>
<li>The probability of the <span class="math inline">i</span>-th outcome is <span class="math inline">p_i</span> on every trial, with <span class="math display">
0 \leq p_i \leq 1 \qquad \qquad \sum_{i=1}^n p_i = 1
</span></li>
<li><span class="math inline">X_i</span> counts the number of times <span class="math inline">i</span>-th outcome occurred in the m trials. It holds <span class="math display">
\sum_{i=1}^n X_i = m
</span></li>
</ul>
</section>
<section id="modelling-counts-1" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p><strong>Multinomial distribution:</strong> Schematic visualization</p>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Outcome type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">X_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">X_n</span></td>
<td style="text-align: center;"><span class="math inline">X_1 + \ldots + X_n = m</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n</span></td>
<td style="text-align: center;"><span class="math inline">p_1 + \ldots + p_n = 1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="modelling-counts-2" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p>For <span class="math inline">n = 2</span> the multinomial reduces to a binomial:</p>
<ul>
<li>Each trial has <span class="math inline">n = 2</span> possible outcomes</li>
<li><span class="math inline">X_1</span> counts the number of <em>successes</em></li>
<li><span class="math inline">X_2 = m âˆ’ X_1</span> counts the number of <em>failures</em> in <span class="math inline">m</span> trials</li>
<li>Probability of <em>success</em> is <span class="math inline">p_1</span></li>
<li>Probability of <em>failure</em> is <span class="math inline">p_2 = 1 - p_1</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Outcome types</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">X_1</span></td>
<td style="text-align: center;"><span class="math inline">X_2 = m - X_1</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">p_2 = 1 - p_1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="multinomial-distribution" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<div id="Definition*-3.2" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>Let <span class="math inline">m,n \in \mathbb{N}</span> and <span class="math inline">p_1, \ldots, p_n</span> numbers such that <span class="math display">
0 \leq p_i \leq 1 \,, \qquad \quad
\sum_{i=1}^n p_i = 1
</span> The random vector <span class="math inline">\mathbf{X}= (X_1, \ldots, X_n)</span> has <strong>multinomial distribution</strong> with <span class="math inline">m</span> trials and cell probabilities <span class="math inline">p_1,\ldots,p_n</span> if joint pmf if <span class="math display">
f (x_1, \ldots , x_n) = \frac{m!}{x_1 ! \cdot \ldots \cdot x_n !} \ p_1^{x_1} \cdot \ldots \cdot p_n^{x_n}  \,, \qquad \forall \, x_i \in \mathbb{N}\, \, \text{ s.t. } \, \sum_{i=1}^n x_i = m
</span> We denote <span class="math inline">\mathbf{X}\sim \mathop{\mathrm{Mult}}(m,p_1,\ldots,p_n)</span><p></p>
</div></details>
</div>
</section>
<section id="multinomial-distribution-1" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<h3 id="properties">Properties</h3>
<p>Suppose that <span class="math inline">\mathbf{X}= (X_1, \ldots, X_n) \sim \mathop{\mathrm{Mult}}(m,p_1,\ldots,p_n)</span></p>
<ul>
<li>Then <span class="math inline">X_i</span> is binomial with <span class="math inline">m</span> trials and probability <span class="math inline">p_i</span></li>
<li>We write <span class="math inline">X_i \sim \mathop{\mathrm{Bin}}(m,p_i)</span> and the pmf is <span class="math display">
f(x_i) = P(X = x_i) = \frac{m!}{x_i! \cdot (1-x_i)!} \, p_i^{x_i} (1-p_i)^{1-x_i}
\qquad \forall \, x_i = 0 , \ldots , m
</span></li>
<li>Since <span class="math inline">X_i \sim \mathop{\mathrm{Bin}}(m,p_i)</span> it holds <span class="math display">
{\rm I\kern-.3em E}[X_i] = m p_i \qquad \qquad
{\rm Var}[X_i] = m p_i (1-p_i)
</span></li>
</ul>
</section>
<section id="counts-with-multinomial-distribution" class="slide level2 smaller">
<h2>Counts with Multinomial distribution</h2>
<ul>
<li><p><span class="math inline">O_i</span> refers to <strong>observed count</strong> of category <span class="math inline">i</span></p></li>
<li><p><span class="math inline">E_i</span> refers to <strong>expected count</strong> of category <span class="math inline">i</span></p></li>
<li><p>We suppose that Type <span class="math inline">i</span> is observed with probability <span class="math inline">p_i</span> and <span class="math display">
0 \leq p_i \leq 1 \,, \qquad \quad p_1 + \ldots + p_n = 1
</span></p></li>
<li><p>Total number of observations is <span class="math inline">m</span></p></li>
<li><p>The counts are modelled by <span class="math display">
(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1, \ldots, p_n)
</span></p></li>
<li><p>The expected counts are modelled by <span class="math display">
E_i := {\rm I\kern-.3em E}[ O_i ] = m p_i
</span></p></li>
</ul>
</section>
<section id="counts-with-multinomial-distribution-1" class="slide level2 smaller">
<h2>Counts with Multinomial distribution</h2>
<p>Consider counts and expected counts <span class="math display">
(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1, \ldots, p_n)
\qquad \qquad
E_i := m p_i
</span></p>
<div id="Definition*-3.3" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>The chi-squared statistic for multinomial counts is defined by <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i-E_i)^2}{E_i}
       = \sum_{i=1}^n \frac{( O_i - m p_i )^2}{ m p_i }
</span><p></p>
</div></details>
</div>
<p><strong>Question</strong>: What is the distribution of <span class="math inline">\chi^2 \,</span>?</p>
</section>
<section id="distribution-of-chi-squared-statistic" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<div id="Theorem*-3.4" class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Suppose the counts <span class="math inline">(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m,p_1, \ldots, p_n)</span>. Then <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{( O_i - m p_i )^2}{ m p_i } \ \stackrel{{\rm d}}{\longrightarrow} \ \chi_{n-1}^2
</span> when sample size <span class="math inline">m \to \infty</span>, where the convergence is in distribution<p></p>
</div></details>
</div>
<ul>
<li><p>Hence the distribution of <span class="math inline">\chi^2</span> is approximately <span class="math inline">\chi_{n-1}^2</span> when <span class="math inline">m</span> is large</p></li>
<li><p>The above Theorem is due to Karl Pearson in 1900 paper <a href="https://www.tandfonline.com/doi/abs/10.1080/14786440009463897">link</a></p></li>
<li><p>Proof is difficult. Seven different proofs are presented in this paper <a href="https://arxiv.org/abs/1808.09171">link</a></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-1" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem">Heuristic proof of Theorem</h3>
<ul>
<li><p>Since <span class="math inline">O_i \sim \mathop{\mathrm{Bin}}(m, p_i)</span>, the Central Limit Theorem implies <span class="math display">
\frac{O_i - m p_i }{ \sqrt{m p_i(1 - p_i) } } \
\stackrel{{\rm d}}{\longrightarrow} \ N(0,1)
</span> as <span class="math inline">m \to \infty</span></p></li>
<li><p>In particular, since <span class="math inline">(1-p_i)</span> in constant, we have <span class="math display">
\frac{O_i - m p_i }{ \sqrt{m p_i } } \ \approx \ \frac{O_i - m p_i }{ \sqrt{m p_i(1 - p_i) } } \ \approx \ N(0,1)
</span></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-2" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem-1">Heuristic proof of Theorem</h3>
<ul>
<li><p>Squaring the above we get <span class="math display">
\frac{(O_i - m p_i)^2 }{ m p_i } \ \approx   \ N(0,1)^2 = \chi_1^2  
</span></p></li>
<li><p>If the above random variables were pairwise independent, we would obtain <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - m p_i)^2 }{ m p_i } \ \approx  \ \sum_{i=1}^n \chi_1^2 = \chi_n^2  
</span></p></li>
<li><p>However the <span class="math inline">O_i</span> are not independent because of linear constraint <span class="math display">
O_1 + \ldots + O_n = m
</span></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-3" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem-2">Heuristic proof of Theorem</h3>
<ul>
<li><p>The idea is that a priori there should be <span class="math inline">n</span> degrees of freedom</p></li>
<li><p>However the linear constraint reduces degrees of freedom by <span class="math inline">1</span></p></li>
<li><p>This is because one can choose the first <span class="math inline">n-1</span> counts and the last one is given by <span class="math display">
O_n = m - O_1 - \ldots - O_{n-1}
</span></p></li>
<li><p>A rather technical proof is needed to actually prove that <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - m p_i)^2 }{ m p_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
</ul>
</section>
<section id="quality-of-chi-squared-approximation" class="slide level2 smaller">
<h2>Quality of chi-squared approximation</h2>
<ul>
<li><p>Define expected counts <span class="math inline">E_i := m p_i</span></p></li>
<li><p>Consider approximation from Theorem: <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>The approximation is:</p>
<table class="caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Good</strong></th>
<th style="text-align: left;"><span class="math inline">E_i \geq 5  \, \text{ for all } \, i = 1 , \ldots n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Bad</strong></td>
<td style="text-align: left;"><span class="math inline">E_i &lt; 5 \,</span> for some <span class="math inline">\, i = 1 , \ldots n</span></td>
</tr>
</tbody>
</table></li>
<li><p><strong>Good:</strong> Use <span class="math inline">\chi_{n-1}^2</span> approximation of <span class="math inline">\chi^2</span></p></li>
<li><p><strong>Bad:</strong> Use Monte Carlo simulations (more on this later)</p></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Setting:</strong></p>
<ul>
<li><p>Population consists of items of <span class="math inline">n</span> different types</p></li>
<li><p><span class="math inline">p_i</span> is probability that an item selected at random is of type <span class="math inline">i</span></p></li>
<li><p><span class="math inline">p_i</span> is unknown and needs to be estimated</p></li>
<li><p>As guess for <span class="math inline">p_1,\ldots,p_n</span> we take <span class="math inline">p_1^0, \ldots, p_n^0</span> such that <span class="math display">
0 \leq p_i^0 \leq 1 \qquad \qquad \sum_{i=1}^n p_i^0 = 1
</span></p></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test-1" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Hypothesis Test:</strong> We test for equality of <span class="math inline">p_i</span> to <span class="math inline">p_i^0</span> <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = p_i^0 \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq p_i^0 \qquad \text{ for at least one } \, i
\end{align*}</span></p>
<p><strong>Sample</strong>:</p>
<ul>
<li>We draw <span class="math inline">m</span> items from population</li>
<li><span class="math inline">O_i</span> denotes the number of items of type <span class="math inline">i</span> drawn</li>
<li>Therefore <span class="math inline">(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m,p_1, \ldots, p_n)</span></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test-2" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Data</strong>: Vector of counts <span class="math inline">(o_1,\ldots,o_n)</span></p>
<p><strong>Schematically:</strong> We can represent probabilities and counts in a table</p>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">o_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_n</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="the-chi-squared-goodness-of-fit-test-3" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure">Procedure</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts and expected counts <span class="math display">
m = \sum_{i=1}^n o_i \qquad \quad E_i = m p_i^0
</span></li>
<li>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{ (o_i - E_i)^2 }{E_i}
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-4" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure-1">Procedure</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_i \geq 5</span> for all <span class="math inline">i = 1, \ldots, n</span></li>
<li>In this case <span class="math inline">\chi^2 \ \approx \ \chi_{n-1}^2</span></li>
<li>Find critical value in chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> <span class="math display">
\chi^2_{n - 1} (0.05)
</span></li>
<li>Alternatively, compute p-value in R <span class="math display">
p := P( \chi^2_{n - 1} &gt; \chi^2 )
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-5" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure-2">Procedure</h3>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>Reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 &gt; \chi_{n - 1}^2 (0.05)  \qquad \text{ or } \qquad p &lt; 0.05
</span></li>
<li>Do not reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 \leq \chi^2_{n - 1} (0.05)  \qquad \text{ or } \qquad
p \geq 0.05
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-in-r" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test in R</h2>
<h3 id="general-commands">General commands</h3>
<ol type="1">
<li>Store the counts <span class="math inline">o_1,\ldots, o_n</span> in R vector
<ul>
<li><code>counts &lt;- c(o1, ..., on)</code></li>
</ul></li>
<li>Store the null hypothesis probabilities <span class="math inline">p_1^0,\ldots, p_n^0</span> in R vector
<ul>
<li><code>null_probs &lt;- c(p1, ..., pn)</code></li>
</ul></li>
<li>Perform a goodness-of-fit test on <code>counts</code> with <code>null_probs</code>
<ul>
<li><code>chisq.test(counts, p = null_probs)</code></li>
</ul></li>
<li>Read output
<ul>
<li>Output is similar to t-test and F-test</li>
<li>The main quantity of interest is p-value</li>
</ul></li>
</ol>
</section>
<section id="comments-on-chisq.test" class="slide level2 smaller">
<h2>Comments on <code>chisq.test</code></h2>
<ol type="1">
<li><p>R performs a goodness-of-fit test on <code>counts</code> with <code>null_probs</code> with</p>
<ul>
<li><code>chisq.test(counts, p = null_probs)</code></li>
</ul></li>
<li><p>R implicitly assumes the null hypothesis is <span class="math display">
H_0 \colon p_i = p_i^0   \qquad \text{ for all } \, i = 1 , \ldots, n
</span></p></li>
<li><p>By default R computes p-value using <span class="math inline">\chi_{n-1}^2</span> approximation</p></li>
<li><p>R can compute p-value with Monte Carlo simulation using option</p>
<ul>
<li><code>simulate.p.value = TRUE</code></li>
</ul></li>
</ol>
</section></section>
<section>
<section id="part-3-goodness-of-fit-test-examples" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>Goodness-of-fit test:<br> Examples</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="example-blood-counts" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<ul>
<li><p>Suppose to have counts of blood type for some people</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2162</td>
<td style="text-align: center;">738</td>
<td style="text-align: center;">228</td>
<td style="text-align: center;">2876</td>
</tr>
</tbody>
</table></li>
<li><p>We want to compare the above to the probability model</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">1/24</td>
<td style="text-align: center;">1/2</td>
</tr>
</tbody>
</table></li>
<li><p>Hence the null hypothesis probabilities are <span class="math display">
p_1^0 = \frac{1}{3} \qquad \quad   p_2^0 = \frac{1}{8} \qquad \quad
p_3^0 = \frac{1}{24} \qquad \quad p_4^0 = \frac{1}{2}
</span></p></li>
</ul>
</section>
<section id="example-blood-counts-1" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts <span class="math display">
m = \sum_{i=1}^n o_i = 2162 + 738 + 228 + 2876 = 6004
</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-2" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-1">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute expected counts <span class="math display">\begin{align*}
E_1 &amp; = m p_1^0 = 6004 \times \frac{1}{3} = 2001.3  \\
E_2 &amp; = m p_2^0 = 6004 \times \frac{1}{8} = 750.5   \\
E_3 &amp; = m p_3^0 = 6004 \times \frac{1}{24} = 250.2   \\
E_4 &amp; = m p_4^0 = 6004 \times \frac{1}{2} = 3002  
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-3" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-2">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute the chi-squared statistic <span class="math display">\begin{align*}
\chi^2 &amp; = \sum_{i=1}^n \frac{ (o_i - E_i)^2 }{E_i} \\
     &amp; = \frac{ (2162 âˆ’ 2001.3)^2 }{ 2001.3 } +
         \frac{ (738 âˆ’ 750.5)^2 }{ 750.5 } \\
     &amp; \phantom{ = } + \frac{ (228 âˆ’ 250.2)^2 }{ 250.2 } +
         \frac{ (2876 âˆ’ 3002)^2 }{ 3002 } \\    
     &amp; = 20.37  
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-4" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-3">Goodness-of-fit test by hand</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables</strong>:
<ul>
<li>Degrees of freedom are <span class="math inline">\, {\rm df} = n - 1 = 3</span></li>
<li>We have computed <span class="math display">
E_1 = 2001.3 \qquad E_2 = 750.5 \qquad E_3 = 250.2 \qquad E_4 = 3002
</span></li>
<li>Hence <span class="math inline">E_i \geq 5</span> for all <span class="math inline">i = 1, \ldots, n</span></li>
<li>In this case <span class="math inline">\chi^2 \ \approx \ \chi_{3}^2</span></li>
<li>In chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> we find critical value <span class="math display">
\chi^2_{3} (0.05) = 7.81
</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-5" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-4">Goodness-of-fit test by hand</h3>
<ol start="3" type="1">
<li><strong>Interpretation:</strong>
<ul>
<li>We have that <span class="math display">
\chi^2 = 20.37  &gt; 7.81 = \chi_{3}^2 (0.05)
</span></li>
<li>Therefore we reject <span class="math inline">H_0</span></li>
</ul></li>
<li><strong>Conclusion:</strong>
<ul>
<li>Observed counts suggest at least one of null probabilities <span class="math inline">p_i^0</span> is wrong</li>
</ul></li>
</ol>
</section>
<section id="example-fair-dice" class="slide level2 smaller">
<h2>Example: Fair dice</h2>
<h3 id="goodness-of-fit-test-in-r">Goodness-of-fit test in R</h3>
<ul>
<li>A dice with <span class="math inline">6</span> faces is rolled <span class="math inline">100</span> times</li>
<li>Counts observed are</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">3</span></th>
<th style="text-align: center;"><span class="math inline">4</span></th>
<th style="text-align: center;"><span class="math inline">5</span></th>
<th style="text-align: center;"><span class="math inline">6</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">13</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">26</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Exercise</strong>: Is the dice fair?
<ul>
<li>Formulate appropriate goodness-of-fit test</li>
<li>Implement this test in R</li>
</ul></li>
</ul>
</section>
<section id="example-fair-dice-1" class="slide level2 smaller">
<h2>Example: Fair dice</h2>
<h3 id="solution">Solution</h3>
<ul>
<li>The dice is fair if probability of rolling <span class="math inline">i</span> is <span class="math inline">1/6</span></li>
<li>Therefore we test the following hypothesis <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = \frac{1}{6} \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq \frac{1}{6} \qquad \text{ for at least one } \, i
\end{align*}</span></li>
</ul>
</section>
<section id="example-fair-dice-2" class="slide level2 smaller">
<h2>Example: Fair dice</h2>
<h3 id="solution-1">Solution</h3>
<ul>
<li>Test can be performed using the code below</li>
<li>Code can be downloaded here <a href="codes/good_fit.R">good_fit.R</a></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">9</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">26</span>)</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>null_probs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform goodness-of-fit test</span></span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null_probs)</span>
<span id="cb1-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb1-9"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-fair-dice-3" class="slide level2 smaller">
<h2>Example: Fair dice</h2>
<h3 id="solution-2">Solution</h3>
<ul>
<li>Running the code in previous slide we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  counts
X-squared = 9.68, df = 5, p-value = 0.08483</code></pre>
</div>
</div>
<p><br></p>
<div class="column" style="width:49%;">
<ul>
<li><p>Chi-squared statistic is <span class="math inline">\, \chi^2 = 9.68</span></p></li>
<li><p>Degrees of freedom are <span class="math inline">\, {\rm df} = 5</span></p></li>
<li><p>p-value is <span class="math inline">p \approx 0.08</span></p></li>
</ul>
</div><div class="column" style="width:35%;">
<ul>
<li><p>Therefore <span class="math inline">p &gt; 0.05</span></p></li>
<li><p>We cannot reject <span class="math inline">H_0</span></p></li>
<li><p>The dice appears to be fair</p></li>
</ul>
</div></section>
<section id="example-voting-data" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="goodness-of-fit-test-in-r-1">Goodness-of-fit test in R</h3>
<ul>
<li>Assume there are two candidates: Republican and Democrat</li>
<li>Voter can choose one of these or be undecided</li>
<li>100 people are surveyed and the results are</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Republican</th>
<th style="text-align: center;">Democrat</th>
<th style="text-align: center;">Undecided</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">35</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">25</td>
</tr>
</tbody>
</table>
</section>
<section id="example-voting-data-1" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="goodness-of-fit-test-in-r-2">Goodness-of-fit test in R</h3>
<ul>
<li>Hystorical data suggest that undecided voters are <span class="math inline">30\%</span> of population</li>
<li><strong>Exercise</strong>: Is difference between Republican and Democratic significant?
<ul>
<li>Formulate appropriate goodness-of-fit test</li>
<li>Implement this test in R</li>
<li>You are not allowed to use <code>chisq.test</code></li>
</ul></li>
</ul>
</section>
<section id="example-voting-data-2" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-3">Solution</h3>
<ul>
<li>Hystorical data suggest that undecided voters are <span class="math inline">30\%</span> of population</li>
<li>Therefore we can assume that probability of undecided voter is <span class="math display">
p_3^0 = 0.3
</span></li>
<li>Want to test if there is difference between Republican and Democrat</li>
<li>Hence null hypothesis is <span class="math display">
p_1^0 = p_2^0
</span></li>
</ul>
</section>
<section id="example-voting-data-3" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-4">Solution</h3>
<ul>
<li><p>Recall that <span class="math display">
p_1^0 + p_2^0 + p_3^0 = 1
</span></p></li>
<li><p>Hence we deduce <span class="math display">
p_1^0 = 0.35 \qquad \quad  p_2^0 = 0.35 \qquad \quad p_3^0 = 0.3
</span></p></li>
<li><p>We test the following hypothesis <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = p_i^0 \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq p_i^0 \qquad \text{ for at least one } \, i
\end{align*}</span></p></li>
</ul>
</section>
<section id="example-voting-data-4" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-5">Solution</h3>
<ul>
<li><p>We want to perform goodness-of-fit test without using <code>chisq.test</code></p></li>
<li><p>First we enter the data</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">40</span> , <span class="dv">25</span>)</span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a>null_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-5" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-6">Solution</h3>
<ul>
<li>Compute the total number of counts <span class="math inline">m = o_1 + \ldots + o_n</span></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute total counts</span></span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>Compute degrees of freedom <span class="math inline">\, {\rm df} = n - 1</span></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute degrees of freedom</span></span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>degrees <span class="ot">&lt;-</span> <span class="fu">length</span>(counts) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-6" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-7">Solution</h3>
<ul>
<li>Compute the expected counts <span class="math inline">E_i = m p_i^0</span></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute expected counts</span></span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a>exp_counts <span class="ot">&lt;-</span> m <span class="sc">*</span> null_probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Compute chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{( o_i - E_i )^2}{E_i}
</span></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute chi-squared statistic</span></span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>chi_squared <span class="ot">&lt;-</span> <span class="fu">sum</span>( (counts <span class="sc">-</span> exp_counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-7" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-8">Solution</h3>
<ul>
<li>Finally compute the p-value <span class="math display">
p = P( \chi_{n-1}^2 &gt; \chi^2 ) = 1 - P( \chi_{n-1}^2 \leq \chi^2 )
</span></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute p-value</span></span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(chi_squared, <span class="at">df =</span> degrees)</span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value</span></span>
<span id="cb8-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The p-value is:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The full code can be downloaded here <a href="codes/good_fit_first_principles.R">good_fit_first_principles.R</a></li>
</ul>
</section>
<section id="example-voting-data-8" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-9">Solution</h3>
<ul>
<li>Running the code gives the following output</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is: 0.4612526</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><p>Therefore p-value is <span class="math inline">p &gt; 0.05</span></p></li>
<li><p>We do not reject <span class="math inline">H_0</span></p></li>
<li><p>There is no reason to believe that Republican and Democrat are not tie</p></li>
</ul>
</section></section>
<section>
<section id="part-4-monte-carlo-simulations" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>Monte Carlo <br> simulations</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="monte-carlo-simulations" class="slide level2 smaller">
<h2>Monte Carlo simulations</h2>
<ul>
<li><p>Recall the approximation <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>We said that</p>
<ul>
<li><span class="math inline">E_i &lt; 5</span> for some <span class="math inline">i \quad \implies \quad</span> approximation of <span class="math inline">\chi^2</span> with <span class="math inline">\chi_{n-1}^2</span> is bad</li>
<li>In this case we use <strong>Monte Carlo simulations</strong></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><strong>Question:</strong> What is a Monte Carlo simulation?</li>
</ul>
</section>
<section id="monte-carlo-methods" class="slide level2 smaller">
<h2>Monte Carlo methods</h2>
<ul>
<li><strong>Monte Carlo methods:</strong>
<ul>
<li>Broad class of computational algorithms</li>
<li>They rely on repeated random sampling to obtain numerical results</li>
<li>Principle: use randomness to solve problems which are deterministic</li>
</ul></li>
<li><strong>Why the name?</strong>
<ul>
<li>Method was developed by <a href="https://en.wikipedia.org/wiki/StanisÅ‚aw_Ulam">Stanislaw Ulam</a></li>
<li>His uncle liked to gamble in the Monteâ€“Carlo Casino in Monaco</li>
</ul></li>
<li><strong>Examples of applications:</strong>
<ul>
<li>First used to solve problem of neutron diffusion in Los Alamos 1946</li>
<li>Can be used to compute p-values</li>
<li>Can be used to compute integrals</li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-simulation-example" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi">Approximating <span class="math inline">\pi</span></h3>

<img data-src="images/pi_monte_carlo.gif" style="width:82.0%" class="r-stretch"></section>
<section id="monte-carlo-simulation-example-1" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi-summarizing-the-idea">Approximating <span class="math inline">\pi</span> â€“ Summarizing the idea</h3>
<ul>
<li>Throw random points inside square of side <span class="math inline">2</span></li>
<li>Count proportion of points falling inside unit circle</li>
<li>Such proportion approximates the area of the circle</li>
<li>Area of unit circle is <span class="math inline">\pi</span></li>
</ul>
</section>
<section id="monte-carlo-simulation-example-2" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi-concrete-steps">Approximating <span class="math inline">\pi</span> â€“ Concrete steps</h3>
<ul>
<li><p>Draw <span class="math inline">x_1, \ldots, x_N</span> and <span class="math inline">y_1, \ldots, y_N</span> from <span class="math inline">{\rm Uniform(-1,1)}</span></p></li>
<li><p>Count the number of points <span class="math inline">(x_i,y_i)</span> falling inside circle of radius <span class="math inline">1</span></p></li>
<li><p>These are points satisfying condition <span class="math display">
x_i^2 + y_i^2 \leq 1
</span></p></li>
<li><p>Area of circle estimated with proportion of points falling inside circle: <span class="math display">
\text{Area} \ = \ \pi \ \approx \ \frac{\text{Number of points } (x_i,y_i) \text{ inside circle}}{N}  \ \times \ 4
</span></p></li>
<li><p>Note: <span class="math inline">4</span> is the area of square of side <span class="math inline">2</span></p></li>
</ul>
</section>
<section id="monte-carlo-simulation-example-3" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="plot-of-1000-random-points-in-square-of-side-2">Plot of 1000 random points in square of side 2</h3>

<img data-src="lecture_7_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="monte-carlo-simulation-example-4" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="implementation-in-r-download-code-monte_carlo_pi.r">Implementation in R â€“ Download code <a href="codes/monte_carlo_pi.R">monte_carlo_pi.R</a></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co"># Counts total number of points</span></span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a>in_circle <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Counts points falling in circle</span></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb10-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb10-7"><a aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>);  <span class="co"># sample point (x,y)</span></span>
<span id="cb10-8"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) {    </span>
<span id="cb10-9"><a aria-hidden="true" tabindex="-1"></a>      in_circle <span class="ot">&lt;-</span> in_circle <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># If (x,y) in circle increase counter</span></span>
<span id="cb10-10"><a aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-11"><a aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increase total counter</span></span>
<span id="cb10-12"><a aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-13"><a aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-14"><a aria-hidden="true" tabindex="-1"></a>  pi_approx <span class="ot">&lt;-</span> ( in_circle <span class="sc">/</span> total ) <span class="sc">*</span> <span class="dv">4</span>  <span class="co"># Compute approximate area</span></span>
<span id="cb10-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"After %8d iterations pi is %.08f, error is %.08f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-17"><a aria-hidden="true" tabindex="-1"></a>     (j <span class="sc">*</span> N), pi_approx, <span class="fu">abs</span>(pi_approx <span class="sc">-</span> pi)))</span>
<span id="cb10-18"><a aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-simulation-example-5" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="implementation-in-r-output">Implementation in R: Output</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>After    10000 iterations pi is 3.11760000, error is 0.02399265
After    20000 iterations pi is 3.13440000, error is 0.00719265
After    30000 iterations pi is 3.13426667, error is 0.00732599
After    40000 iterations pi is 3.13410000, error is 0.00749265
After    50000 iterations pi is 3.13592000, error is 0.00567265
After    60000 iterations pi is 3.13740000, error is 0.00419265
After    70000 iterations pi is 3.13697143, error is 0.00462123
After    80000 iterations pi is 3.13860000, error is 0.00299265
After    90000 iterations pi is 3.13688889, error is 0.00470376
After   100000 iterations pi is 3.13776000, error is 0.00383265</code></pre>
</div>
</div>
</section>
<section id="monte-carlo-p-value" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<p><strong>Goal:</strong> use Monte Carlo simulations to compute p-value of goodness-of-fit test</p>
<ul>
<li>Consider data counts</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed counts</td>
<td style="text-align: center;"><span class="math inline">o_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_n</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Null hypothesis Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1^0</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n^0</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The expected counts are <span class="math inline">E_i = m p_i^0</span></p></li>
<li><p>Under the null hypothesis, the observed counts <span class="math inline">(o_1, \ldots, o_n)</span> come from <span class="math display">
(O_1 , \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)
</span></p></li>
</ul>
</section>
<section id="monte-carlo-p-value-1" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<ul>
<li><p>The chi-squared statistic random variable is <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The observed chi-squared statistics is <span class="math display">
\chi^2_{\rm obs} = \sum_{i=1}^n \frac{(o_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The p-value is defined as <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )
</span></p></li>
</ul>
</section>
<section id="monte-carlo-p-value-2" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="problem">Problem</h3>
<ul>
<li>Suppose <span class="math inline">E_i &lt; 5</span> for some <span class="math inline">i</span></li>
<li>Then the distribution of chi-squared random variable is unknown <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }  \ \, \sim \ \, ???
</span></li>
<li>How do we compute the p-value <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )  \ \ ???
</span></li>
</ul>
<p><strong>Exercise</strong>: Think of Monte Carlo simulation to approximate <span class="math inline">p</span></p>
</section>
<section id="monte-carlo-p-value-3" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-10">Solution</h3>
<ol type="1">
<li><p>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></p></li>
<li><p>Compute the corresponding simulated chi-squared statistic <span class="math display">
\chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i}
</span></p></li>
<li><p>The simulated chi-squared statistic is <strong>extreme</strong> if <span class="math inline">\, \chi^2_{\rm sim} &gt; \chi^2_{\rm obs}</span></p></li>
<li><p>We estimate theoretical p-value in the following way <span class="math display">
p =  P( \chi^2 &gt; \chi^2_{\rm obs} ) \ \approx \ \frac{ \# \text{ of extreme simulated statistics} }{ \text{Total number of simulations} }
</span></p></li>
</ol>
</section>
<section id="monte-carlo-p-value-4" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="exercise">Exercise</h3>
<p><strong>Data:</strong> Number of defects in printed circuit boards</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"># Defects</th>
<th style="text-align: center;"><span class="math inline">0</span></th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Counts</td>
<td style="text-align: center;"><span class="math inline">32</span></td>
<td style="text-align: center;"><span class="math inline">15</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">4</span></td>
</tr>
</tbody>
</table>
<p>Null hypothesis probabilities are</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">p_1^0</span></th>
<th style="text-align: center;"><span class="math inline">p_2^0</span></th>
<th style="text-align: center;"><span class="math inline">p_3^0</span></th>
<th style="text-align: center;"><span class="math inline">p_4^0</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">0.5</span></td>
<td style="text-align: center;"><span class="math inline">0.3</span></td>
<td style="text-align: center;"><span class="math inline">0.15</span></td>
<td style="text-align: center;"><span class="math inline">0.05</span></td>
</tr>
</tbody>
</table>
</section>
<section id="monte-carlo-p-value-5" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="exercise-1">Exercise</h3>
<ul>
<li>Total number of counts is <span class="math inline">m = 60</span>. Expected counts are <span class="math inline">E_i = m p_i^0</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">E_1</span></th>
<th style="text-align: center;"><span class="math inline">E_2</span></th>
<th style="text-align: center;"><span class="math inline">E_3</span></th>
<th style="text-align: center;"><span class="math inline">E_4</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">30</span></td>
<td style="text-align: center;"><span class="math inline">18</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">3</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Note: <span class="math inline">E_4 = 3 &lt; 5</span>
<ul>
<li>Therefore the distribution of <span class="math inline">\chi^2</span> is unknown</li>
</ul></li>
<li><strong>Exercise</strong>: Write an R code for goodness-of-fit test on above data
<ul>
<li>You may not use the function <code>chisq.test</code></li>
<li>p-value should be computed by Monte Carlo simulations</li>
<li>Use the ideas in Slide 60</li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-p-value-6" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-11">Solution</h3>
<ul>
<li>The first part of the code is the same as in Slides 44â€“46
<ul>
<li>Enter observed counts and null probabilities</li>
<li>Compute total counts, expected counts and observed chi-squared statistic</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">15</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a>null_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>)</span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute total counts</span></span>
<span id="cb12-6"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span>
<span id="cb12-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute expected counts</span></span>
<span id="cb12-9"><a aria-hidden="true" tabindex="-1"></a>exp_counts <span class="ot">&lt;-</span> m <span class="sc">*</span> null_probs</span>
<span id="cb12-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the observed chi-squared statistic</span></span>
<span id="cb12-12"><a aria-hidden="true" tabindex="-1"></a>obs_chi_squared <span class="ot">&lt;-</span> <span class="fu">sum</span>( (counts <span class="sc">-</span> exp_counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-p-value-7" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-12">Solution</h3>
<ul>
<li>We approximate the p-value using ideas in Slide 60</li>
<li>We perform <span class="math inline">N</span> Monte Carlo simulations</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Number of Monte Carlo simulations</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To count extreme statistics we initialize a counter</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize counter for extreme statistics</span></span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a>count_extreme_statistics <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-p-value-8" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-13">Solution</h3>
<ul>
<li>For each simulation we do
<ul>
<li>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></li>
<li>Compute the corresponding simulated chi-squared statistic <span class="math display">
  \chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i}
  </span></li>
<li>Check if simulated statistic <span class="math inline">\chi^2_{\rm sim}</span> is <strong>extreme</strong>, that is, if <span class="math display">
  \chi^2_{\rm sim} &gt; \chi^2_{\rm obs}
  </span></li>
<li>If <span class="math inline">\chi^2_{\rm sim}</span> is <strong>extreme</strong> we increase the counter</li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-p-value-9" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-14">Solution</h3>
<ul>
<li>The procedure discussed in the previous slide is coded below</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo simulations</span></span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb15-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate multinomial counts under null hypothesis</span></span>
<span id="cb15-5"><a aria-hidden="true" tabindex="-1"></a>  simul_counts <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="dv">1</span>, m, null_probs)</span>
<span id="cb15-6"><a aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute chi-squared statistic for the simulated counts</span></span>
<span id="cb15-8"><a aria-hidden="true" tabindex="-1"></a>  simul_chi_squared <span class="ot">&lt;-</span> <span class="fu">sum</span>( (simul_counts <span class="sc">-</span> exp_counts )<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_counts)</span>
<span id="cb15-9"><a aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-10"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if simulated chi-squared statistic is extreme</span></span>
<span id="cb15-11"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (simul_chi_squared <span class="sc">&gt;=</span> obs_chi_squared) {</span>
<span id="cb15-12"><a aria-hidden="true" tabindex="-1"></a>    count_extreme_statistics <span class="ot">&lt;-</span> count_extreme_statistics <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-13"><a aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-14"><a aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-p-value-10" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-15">Solution</h3>
<ul>
<li>We compute the Monte Carlo p-value using the below formula <span class="math display">
p \ = \ \frac{ \# \text{ of extreme simulated statistics} }{ \text{Total number of simulations} }
</span></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Monte Carlo p-value</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>monte_carlo_p_value <span class="ot">&lt;-</span> count_extreme_statistics <span class="sc">/</span> N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-p-value-11" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-16">Solution</h3>
<ul>
<li>To check our procedure we also compute Monte-Carlo p-value with <code>chisq.test</code></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test using built-in R function</span></span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>chi_squared_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null_probs, </span>
<span id="cb17-3"><a aria-hidden="true" tabindex="-1"></a>                               <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value from chi-squared test result</span></span>
<span id="cb17-6"><a aria-hidden="true" tabindex="-1"></a>chisq_p_value <span class="ot">&lt;-</span> chi_squared_test<span class="sc">$</span>p.value</span>
<span id="cb17-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-values for comparison</span></span>
<span id="cb17-9"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Custom Monte Carlo p-value:"</span>, monte_carlo_p_value)</span>
<span id="cb17-10"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R Monte Carlo p-value:"</span>, chisq_p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-p-value-12" class="slide level2 smaller">
<h2>Monte Carlo p-value</h2>
<h3 id="solution-17">Solution</h3>
<ul>
<li><p>The previous code can be downloaded here <a href="codes/monte_carlo_p_value.R">monte_carlo_p_value.R</a></p></li>
<li><p>Running the code yields the following output</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Custom Monte Carlo p-value: 0.81956</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
R Monte Carlo p-value: 0.8050975</code></pre>
</div>
</div>
<ul>
<li><strong>Notes</strong>:
<ul>
<li><code>chisq.test</code> runs a more refined Monte Carlo algorithm for p-value</li>
<li>Even if our algorithm is quite elementary, the two p-values are close!</li>
<li>In particular <span class="math inline">p &gt; 0.05</span> and we do not reject <span class="math inline">H_0</span></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="part-5-contingency-tables" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br>Contingency tables</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="contingency-tables-example" class="slide level2 smaller">
<h2>Contingency tables: Example</h2>
<p><strong>Two-way Contigency Tables:</strong> Table in which each observation is classified in 2 ways</p>
<p><strong>Example:</strong> Relative performance of Man Utd managers</p>
<ul>
<li>Two classifications for each game: Result and Manager in charge</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
</section>
<section id="contingency-tables-general-case" class="slide level2 smaller">
<h2>Contingency tables: General case</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Each observation
<ul>
<li>has attached two categories <span class="math inline">X</span> and <span class="math inline">Y</span></li>
<li>can only belong to one category <span class="math inline">(X,Y) = (i,j)</span></li>
</ul></li>
<li><span class="math inline">O_{ij}</span> is the <strong>count</strong> of observations with <span class="math inline">(X,Y) = (i,j)</span></li>
<li>Table has <span class="math inline">R</span> rows and <span class="math inline">C</span> columns for total of <span class="math inline">n = RC</span> categories</li>
</ul>
</section>
<section id="contingency-tables-general-case-1" class="slide level2 smaller">
<h2>Contingency tables: General case</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><em>plus</em> symbol in subscript denotes sum over that subscript. Example</li>
</ul>
<p><span class="math display">
O_{R+} = \sum_{j=1}^C O_{Rj} \qquad \quad
O_{+2} = \sum_{i=1}^R O_{i2}
</span></p>
</section>
<section id="contingency-tables-general-case-2" class="slide level2 smaller">
<h2>Contingency tables: General case</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The total count is</li>
</ul>
<p><span class="math display">
m = O_{++} = \sum_{i=1}^R \sum_{j=1}^C O_{ij}
</span></p>
</section>
<section id="contingency-tables-general-case-3" class="slide level2 smaller">
<h2>Contingency tables: General case</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal counts sum to <span class="math inline">m</span> as well</li>
</ul>
<p><span class="math display">
\sum_{i=1}^R O_{i+} = \sum_{i=1}^R \sum_{j=1}^C O_{ij} = m
</span></p>
</section>
<section id="contingency-tables-general-case-4" class="slide level2 smaller">
<h2>Contingency tables: General case</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal counts sum to <span class="math inline">m</span> as well</li>
</ul>
<p><span class="math display">
\sum_{j=1}^C O_{+j} = \sum_{j=1}^C \sum_{i=1}^R  O_{ij} = m
</span></p>
</section>
<section id="contingency-tables-probabilities" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Observation in cell <span class="math inline">(i,j)</span> happens with probability</li>
</ul>
<p><span class="math display">
p_{ij} := P(X = i , Y = j)
</span></p>
</section>
<section id="contingency-tables-probabilities-1" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal probabilities that <span class="math inline">X = i</span> or <span class="math inline">Y = j</span> are at the margins of table</li>
</ul>
<p><span class="math display">
P(X = i) = \sum_{j=1}^C P(X = i , Y = j) = \sum_{j=1}^C p_{ij} = p_{i+}
</span></p>
</section>
<section id="contingency-tables-probabilities-2" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal probabilities that <span class="math inline">X = i</span> or <span class="math inline">Y = j</span> are at the margins of table</li>
</ul>
<p><span class="math display">
P(Y = j) = \sum_{i=1}^R P(X = i , Y = j) = \sum_{i=1}^R p_{ij} = p_{+j}
</span></p>
</section>
<section id="contingency-tables-probabilities-3" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal probabilities sum to <span class="math inline">1</span></li>
</ul>
<p><span class="math display">
\sum_{i=1}^R p_{i+} = \sum_{i=1}^R  P(X = i) = \sum_{i=1}^R \sum_{j=1}^C P(X = i , Y = j) = 1
</span></p>
</section>
<section id="contingency-tables-probabilities-4" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal probabilities sum to <span class="math inline">1</span></li>
</ul>
<p><span class="math display">
\sum_{j=1}^C p_{+j} = \sum_{j=1}^C  P(X = j) = \sum_{j=1}^R \sum_{j=1}^C P(X = i , Y = j) = 1
</span></p>
</section>
<section id="multinomial-distribution-2" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<ul>
<li><p>Counts <span class="math inline">O_{ij}</span> and probabilities <span class="math inline">p_{ij}</span> can be assembled into <span class="math inline">R \times C</span> matrices <span class="math display">
O =
\left(
\begin{array}{ccc}
O_{11} &amp; \ldots &amp; O_{1C} \\
\vdots &amp; \ddots &amp; \vdots \\
O_{R1} &amp; \ldots &amp; O_{RC} \\
\end{array}
\right)
\qquad \qquad
p =
\left(
\begin{array}{ccc}
p_{11} &amp; \ldots &amp; p_{1C} \\
\vdots &amp; \ddots &amp; \vdots \\
p_{R1} &amp; \ldots &amp; p_{RC} \\
\end{array}
\right)
</span></p></li>
<li><p>This way the random matrix <span class="math inline">O</span> has multinomial distribution <span class="math display">
O \sim \mathop{\mathrm{Mult}}(m,p)
</span></p></li>
<li><p>The counts <span class="math inline">O_{ij}</span> are therefore binomial <span class="math display">
O_{ij} \sim \mathop{\mathrm{Bin}}(m,p_{ij})
</span></p></li>
</ul>
</section>
<section id="multinomial-distribution-3" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<ul>
<li><p>We can also consider the marginal random vectors <span class="math display">
(O_{1+}, \ldots, O_{R+}) \qquad \qquad (O_{+1}, \ldots, O_{+C})
</span></p></li>
<li><p>These have also multinomial distribution <span class="math display">
(O_{1+}, \ldots, O_{R+})  \sim \mathop{\mathrm{Mult}}(m, p_{1+}, \ldots, p_{R+})
</span> <span class="math display">
(O_{+1}, \ldots, O_{+C}) \sim \mathop{\mathrm{Mult}}(m, p_{+1}, \ldots, p_{+C})
</span></p></li>
</ul>
</section>
<section id="expected-counts" class="slide level2 smaller">
<h2>Expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>We have that <span class="math inline">O_{ij} \sim \mathop{\mathrm{Bin}}(m,p_{ij})</span></li>
<li>Therefore we model the <strong>expected counts</strong> for category <span class="math inline">(i,j)</span> as <span class="math display">
E_{ij} := {\rm I\kern-.3em E}[O_{ij}] =  m p_{ij}
</span></li>
</ul>
</section>
<section id="marginal-expected-counts" class="slide level2 smaller">
<h2>Marginal expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">E_{11}</span></td>
<td style="text-align: center;"><span class="math inline">E_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">E_{21}</span></td>
<td style="text-align: center;"><span class="math inline">E_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">E_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">E_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Due to linearity of expectation, it makes sense to define marginal counts <span class="math display">
E_{i+} := \sum_{j=1}^C E_{ij}
\qquad \qquad
E_{+j} := \sum_{i=1}^R  E_{ij}
</span></li>
</ul>
</section>
<section id="marginal-expected-counts-1" class="slide level2 smaller">
<h2>Marginal expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">E_{11}</span></td>
<td style="text-align: center;"><span class="math inline">E_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">E_{21}</span></td>
<td style="text-align: center;"><span class="math inline">E_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">E_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">E_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal expected counts sum to <span class="math inline">m</span>. For example: <span class="math display">
\sum_{i=1}^R E_{i+} = \sum_{i=1}^R \sum_{j=1}^C E_{ij} =  m \sum_{i=1}^R \sum_{j=1}^C p_{ij} = m
</span></li>
</ul>
</section>
<section id="the-chi-squared-statistic" class="slide level2 smaller">
<h2>The chi-squared statistic</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<div id="Definition*-6.1" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>The chi-squared statistic associated to the above contingency table is <span class="math display">
\chi^2 := \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} } =
\sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - m p_{ij})^2 }{ m p_{ij} }
</span><p></p>
</div></details>
</div>
</section>
<section id="distribution-of-chi-squared-statistic-4" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<div id="Theorem*-6.2" class="Theorem">
<details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>
<p>Suppose the counts <span class="math inline">O \sim \mathop{\mathrm{Mult}}(m,p)</span>. Then <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - m p_{ij})^2 }{ m p_{ij} } \
\stackrel{ {\rm d} }{ \longrightarrow } \ \chi_{RC - 1 - {\rm fitted} }^2  
</span> when sample size <span class="math inline">m  \to \infty</span>. The convergence is in distribution and</p>
<ul>
<li><span class="math inline">\rm fitted = \,</span> # of parameters used to estimate cell probabilities <span class="math inline">p_{ij}</span></li>
</ul>
</div></details>
</div>
<p><strong>Quality of approximation:</strong> The chi-squared approximation is good if <span class="math display">
E_{ij} = m p_{ij} \geq 5  \quad \text{ for all } \,\, i = 1 , \ldots , R  \, \text{ and }
j = 1, \ldots, C
</span></p>
</section>
<section id="goodness-of-fit-test-for-contingency-tables" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<p><strong>Setting:</strong></p>
<ul>
<li><p>Population consists of items of <span class="math inline">n = R \times C</span> different types</p></li>
<li><p><span class="math inline">p_{ij}</span> is probability that an item selected at random is of type <span class="math inline">(i,j)</span></p></li>
<li><p><span class="math inline">p_{ij}</span> is unknown and needs to be estimated</p></li>
<li><p>As guess for <span class="math inline">p_{ij}</span> we take <span class="math inline">p_{ij}^0</span> such that <span class="math display">
0 \leq p_{ij}^0 \leq 1 \qquad \qquad \sum_{i=1}^R \sum_{j=1}^C p_{ij}^0 = 1
</span></p></li>
</ul>
</section>
<section id="goodness-of-fit-test-for-contingency-tables-1" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<p><strong>Hypothesis Test:</strong> We test for equality of <span class="math inline">p_{ij}</span> to <span class="math inline">p_{ij}^0</span> <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{ij}^0 \qquad \text{ for all } \, i = 1, \ldots, R  \,, \text{ and } \, j = 1 , \ldots, C \\
&amp; H_1 \colon p_{ij} \neq p_{ij}^0 \qquad \text{ for at least one pair } \, (i,j)
\end{align*}</span></p>
<p><strong>Sample</strong>:</p>
<ul>
<li>We draw <span class="math inline">m</span> items from population</li>
<li><span class="math inline">O_{ij}</span> denotes the number of items of type <span class="math inline">i</span> drawn</li>
<li>Therefore <span class="math inline">O = (O_{ij})_{ij}</span> is <span class="math inline">\mathop{\mathrm{Mult}}(m,p)</span> with <span class="math inline">p = (p_{ij})_{ij}</span></li>
</ul>
<p><strong>Data</strong>: Matrix of counts <span class="math inline">o = (o_{ij})_{ij}</span></p>
</section>
<section id="goodness-of-fit-test-for-contingency-tables-2" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<h3 id="procedure-3">Procedure</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts and expected counts <span class="math display">
m = \sum_{i=1}^R \sum_{j=1}^C o_{ij} \qquad \quad E_{ij} = m p_{ij}^0
</span></li>
<li>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}}
</span></li>
</ul></li>
</ol>
</section>
<section id="goodness-of-fit-test-for-contingency-tables-3" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<h3 id="procedure-4">Procedure</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i, j</span></li>
<li>We did not fit any parameter. Hence the Theorem in Slide 88 gives <span class="math display">
{\rm degrees \,\, freedom} = RC - 1 \qquad \qquad  \chi^2 \ \approx \ \chi_{RC-1}^2
</span></li>
<li>Find critical value in chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> <span class="math display">
\chi^2_{RC - 1} (0.05)
</span></li>
<li>Alternatively, compute p-value in R <span class="math display">
p := P( \chi^2_{RC - 1} &gt; \chi^2 )
</span></li>
</ul></li>
</ol>
</section>
<section id="goodness-of-fit-test-for-contingency-tables-4" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<h3 id="procedure-5">Procedure</h3>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>Reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 &gt; \chi_{RC - 1}^2 (0.05)  \qquad \text{ or } \qquad p &lt; 0.05
</span></li>
<li>Do not reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 \leq \chi^2_{RC - 1} (0.05)  \qquad \text{ or } \qquad
p \geq 0.05
</span></li>
</ul></li>
</ol>
</section>
<section id="goodness-of-fit-test-in-r-3" class="slide level2 smaller">
<h2>Goodness-of-fit test in R</h2>
<h3 id="general-commands-1">General commands</h3>
<ol type="1">
<li>Store the matrix of counts <span class="math inline">O = (o_{ij})_{ij}</span> into a single R vector, proceeding row-by-row
<ul>
<li><code>counts &lt;- c(o_11, o_12, ..., o_RC)</code></li>
</ul></li>
<li>Store the matrix of null probabilities <span class="math inline">p = (p_{ij})_{ij}</span> into a single R vector, proceeding row-by-row
<ul>
<li><code>null_probs_i &lt;- c(p_11, p_12, ..., p_RC)</code></li>
</ul></li>
<li>Perform a chi-squared goodness-of-fit test on <code>counts</code> with <code>null_probs</code>
<ul>
<li><code>chisq.test(counts, p = null_probs)</code></li>
</ul></li>
<li>Read output: In particular look for the p-value</li>
</ol>
<p><strong>Note:</strong> Compute Monte Carlo p-value with option <code>simulate.p.value = TRUE</code></p>
</section>
<section id="example-manchester-united-performance" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<p><strong>Background story:</strong></p>
<ul>
<li>From 1992 to 2013 Man Utd won 13 Premier Leagues out of 21</li>
<li>This is the best performance in the Premier League era</li>
<li>This was under manager Sir Alex Ferguson</li>
<li>Ferguson stepped down in 2014</li>
<li>Since 2014 Man Utd has not won the PL and was managed by 6 different people (excluding interims)</li>
</ul>
<p><strong>Question:</strong> Are the 6 managers to blame for worse Team Performance?</p>
</section>
<section id="example-manchester-united-performance-1" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Table contains Man Utd games since 2014 season</p></li>
<li><p>To each Man Utd game in the sample we associate two categories:</p>
<ul>
<li>Manager and Result</li>
</ul></li>
</ul>
</section>
<section id="example-manchester-united-performance-2" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li><p><strong>Question:</strong> Is the number of Wins, Draws and Losses uniformly distributed?</p>
<ul>
<li>If Yes, this would suggest very poor performance</li>
</ul></li>
<li><p><strong>Hypothesis Test:</strong> To answer the question we perform a goodness-of-fit test on <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{ij}^0 \quad \text { for all pairs } \, (i,j)  \\
&amp; H_1 \colon p_{ij} \neq p_{ij}^0 \quad \text { for at least one pair } \, (i,j)  \\
\end{align*}</span></p></li>
<li><p><strong>Null Probabilities:</strong></p>
<ul>
<li>They have to model that Wins, Draws and Losses are uniformly distributed</li>
<li>To compute them, we need to compute total number of games for each manager</li>
</ul></li>
</ul>
</section>
<section id="example-manchester-united-performance-3" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li>We compute total number of games for each manager</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
<td style="text-align: left;"><span class="math inline">o_{1+} = 51</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
<td style="text-align: left;"><span class="math inline">o_{2+} = 103</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
<td style="text-align: left;"><span class="math inline">o_{3+} = 144</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
<td style="text-align: left;"><span class="math inline">o_{4+} = 168</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
<td style="text-align: left;"><span class="math inline">o_{5+} = 29</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
<td style="text-align: left;"><span class="math inline">o_{6+} = 101</span></td>
</tr>
</tbody>
</table>
<ul>
<li>We also need the total number of games <span class="math display">
m = \sum_{i=1}^R o_{i+} = 596
</span></li>
</ul>
</section>
<section id="example-manchester-united-performance-4" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li><p>If the results are uniformly distributed the expected scores are <span class="math display">
E_{ij} = \frac{o_{i+}}{3}
</span></p></li>
<li><p>Recall that the expected scores are modelled as <span class="math display">
E_{ij} = m p_{ij}^0
</span></p></li>
<li><p>We hence obtain <span class="math display">
p_{ij}^0 = \frac{o_{i+}}{3 m}
</span></p></li>
</ul>
</section>
<section id="example-manchester-united-performance-5" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li>Substituting the values of <span class="math inline">o_{i+}</span> and <span class="math inline">m</span> we finally obtain the null probabilities</li>
</ul>
<p><span class="math display">\begin{align*}
\text{Moyes: } \quad &amp; p_{1j}^0 = \frac{ o_{1+} }{ 3m } = 51 \big/ 1788  \\
\text{Van Gaal: }\quad &amp; p_{2j}^0 = \frac{ o_{2+} }{ 3m } = 103 \big/  1788  \\
\text{Mourinho: } \quad&amp; p_{3j}^0 = \frac{ o_{3+} }{ 3m } =  144 \big/  1788  \\
\text{Solskjaer: } \quad&amp; p_{4j}^0 = \frac{ o_{4+} }{ 3m } =  168 \big/ 1788 \\
\text{Rangnick: }\quad &amp; p_{5j}^0 = \frac{ o_{5+} }{ 3m } =  29 \big/  1788  \\
\text{ten Hag: }\quad &amp; p_{6j}^0 = \frac{ o_{6+} }{ 3m } =  101 \big/  1788
\end{align*}</span></p>
</section>
<section id="example-manchester-united-performance-6" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li><p>We are now ready to perform the goodness-of-fit test in R</p></li>
<li><p>We start by storing the matrix of counts into a single R vector, row-by-row</p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store matrix of counts into single R vector</span></span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">9</span>, <span class="dv">15</span>,</span>
<span id="cb20-3"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">54</span>, <span class="dv">25</span>, <span class="dv">24</span>,</span>
<span id="cb20-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">84</span>, <span class="dv">32</span>, <span class="dv">28</span>, </span>
<span id="cb20-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">91</span>, <span class="dv">37</span>, <span class="dv">40</span>,</span>
<span id="cb20-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">8</span>,</span>
<span id="cb20-7"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">61</span>, <span class="dv">12</span>, <span class="dv">28</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-manchester-united-performance-7" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li>Then we store the matrix of null probabilities into a single R vector, row-by-row</li>
<li>Null probabilities in each row are the same. Hence we can use the command <code>rep</code></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store matrix of null probabilities into single R vector</span></span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># We use repeat to avoid copy pasting </span></span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a>lines_null_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">51</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">103</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">144</span><span class="sc">/</span><span class="dv">1788</span>, </span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a>                      <span class="dv">168</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">29</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">101</span><span class="sc">/</span><span class="dv">1788</span>)</span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a>null_probs <span class="ot">&lt;-</span> <span class="fu">rep</span>(lines_null_probs, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-manchester-united-performance-8" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li>Finally we perform the goodness-of-fit test on <code>counts</code> and <code>null_probs</code></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform goodness-of-fit test</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null_probs)</span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb22-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The code can be downloaded here <a href="codes/good_fit_contingency.R">good_fit_contingency.R</a></li>
</ul>
</section>
<section id="example-manchester-united-performance-9" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li>Running the code we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  counts
X-squared = 137.93, df = 17, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>p-value is <span class="math inline">p \approx 0 &lt; 0.05</span></li>
<li>We therefore reject <span class="math inline">H_0</span></li>
<li>Significant evidence that results of Man Utd games are not uniformly distributed</li>
<li>Low goal-scoring rates in soccer mean roughly <span class="math inline">1/3</span> of games end in a draw</li>
<li>Hence Man Utd is not actually doing too bad</li>
</ul>
</section></section>
<section>
<section id="part-6-chi-squared-test-of-independence" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 6: <br>Chi-squared test <br>of independence</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="testing-for-independence" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Consider a two-way contingency table as above</p></li>
<li><p>To each person we associate two categories:</p>
<ul>
<li>Residential Status: Rental or Owned</li>
<li>Region in which they live: NW, London, SW</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-1" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li>One possible question is:
<ul>
<li>Does Residential Status depend on Region?</li>
<li>In other words: Are rows and columns dependent?</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-2" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Looking at the data, it seems clear that:
<ul>
<li>London: Rentals are almost comparable to Owned</li>
<li>NW and SW: Rentals are almost a third of Owned</li>
<li>It appears Residential Status and Region are dependent features</li>
</ul></li>
<li><strong>Goal:</strong> Formulate test for independence</li>
</ul>
</section>
<section id="testing-for-independence-3" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Consider the general two-way contingency table as above</p></li>
<li><p>They are equivalent:</p>
<ul>
<li>Rows and columns are independent</li>
<li>Random variables <span class="math inline">X</span> and <span class="math inline">Y</span> are independent</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-4" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Hence, testing for independece means testing following hypothesis: <span class="math display">\begin{align*}
&amp; H_0 \colon X \, \text{ and } \, Y \, \text{ are independent } \\
&amp; H_1 \colon X \, \text{ and } \, Y \, \text{ are not independent }
\end{align*}</span></p></li>
<li><p>We need to quantify <span class="math inline">H_0</span> and <span class="math inline">H_1</span></p></li>
</ul>
</section>
<section id="testing-for-independence-5" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>R.v. <span class="math inline">X</span> and <span class="math inline">Y</span> are independent iff cell probabilities factor into marginals <span class="math display">
p_{ij} = P(X = i , Y = j) =  P(X = i) P (Y = j) = p_{i+}p_{+j}
</span></p></li>
<li><p>Therefore the hypothesis test for independence becomes <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C \\
&amp; H_1 \colon p_{ij} \neq p_{i+}p_{+j}  \quad \text{ for some } \, (i,j)
\end{align*}</span></p></li>
</ul>
</section>
<section id="expected-counts-1" class="slide level2 smaller">
<h2>Expected counts</h2>
<ul>
<li><p>Assume the null hypothesis is true <span class="math display">
H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C
</span></p></li>
<li><p>Under <span class="math inline">H_0</span> the expected counts become <span class="math display">
E_{ij} = m p_{ij} = p_{i+}p_{+j}
</span></p></li>
<li><p>We need a way to estimate the marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
</ul>
</section>
<section id="estimating-marginal-probabilities" class="slide level2 smaller">
<h2>Estimating marginal probabilities</h2>
<ul>
<li><p><strong>Goal:</strong> Estimate marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
<li><p>By definition we have <span class="math display">
p_{i+} = P( X = i )
</span></p></li>
<li><p>Hence <span class="math inline">p_{i+}</span> is probability of and observation to be classified in <span class="math inline">i</span>-th row</p></li>
<li><p>Estimate <span class="math inline">p_{i+}</span> with the proportion of observations classified in <span class="math inline">i</span>-th row <span class="math display">
p_{i+} := \frac{o_{i+}}{m} = \frac{ \text{Number of observations in } \, i\text{-th row} }{ \text{ Total number of observations} }
</span></p></li>
</ul>
</section>
<section id="estimating-marginal-probabilities-1" class="slide level2 smaller">
<h2>Estimating marginal probabilities</h2>
<ul>
<li><p><strong>Goal:</strong> Estimate marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
<li><p>Similarly, by definition <span class="math display">
p_{+j} = P( Y = j )
</span></p></li>
<li><p>Hence <span class="math inline">p_{+j}</span> is probability of and observation to be classified in <span class="math inline">j</span>-th column</p></li>
<li><p>Estimate <span class="math inline">p_{+j}</span> with the proportion of observations classified in <span class="math inline">j</span>-th column <span class="math display">
p_{+j} := \frac{o_{+j}}{m} = \frac{ \text{Number of observations in } \, j\text{-th column} }{ \text{ Total number of observations} }
</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<ul>
<li><p>Summary: The marginal probabilities are estimated with <span class="math display">
p_{i+} := \frac{o_{i+}}{m}
\qquad \qquad p_{+j} := \frac{o_{+j}}{m}
</span></p></li>
<li><p>Therefore the expected counts become <span class="math display">
E_{ij} = m p_{ij} = m p_{i+} p_{+j} = m \left( \frac{o_{i+}}{m}  \right) \left( \frac{o_{+j}}{m}  \right) = \frac{o_{i+} \, o_{+j}}{m}
</span></p></li>
<li><p>By the Theorem in Slide 88 the chi-squared statistics satisfies <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} } \ \approx \
\chi^2_{RC - 1 - {\rm fitted}}
</span></p></li>
<li><p>We need to compute the number of <strong>fitted parameters</strong></p></li>
</ul>
</section>
<section id="number-of-fitted-parameters" class="slide level2 smaller">
<h2>Number of fitted parameters</h2>
<ul>
<li><p>We have to estimate the row marginals <span class="math inline">p_{i+}</span></p></li>
<li><p>We estimate the first <span class="math inline">R-1</span> row marginals by <span class="math display">
p_{i+} := \frac{o_{i+}}{m} \,, \qquad i = 1 , \ldots, R - 1
</span></p></li>
<li><p>Since the marginals <span class="math inline">p_{i+}</span> sum to <span class="math inline">1</span>, we can obtain <span class="math inline">p_{R+}</span> by <span class="math display">
p_{R+} = 1 - p_{1+} - \ldots - p_{(R-1)+}
     = 1 - \frac{o_{1+}}{m} - \ldots - \frac{o_{(R-1)+}}{m}
</span></p></li>
</ul>
</section>
<section id="number-of-fitted-parameters-1" class="slide level2 smaller">
<h2>Number of fitted parameters</h2>
<ul>
<li><p>Similarly, we estimate the first <span class="math inline">C-1</span> column marginals by <span class="math display">
p_{+j} = \frac{o_{+j}}{m} \,, \qquad j = 1, \ldots, C - 1
</span></p></li>
<li><p>Since the marginals <span class="math inline">p_{+j}</span> sum to <span class="math inline">1</span>, we can obtain <span class="math inline">p_{+C}</span> by <span class="math display">
p_{+C} = 1 - p_{+1} - \ldots - p_{+(C-1)}
     = 1 - \frac{o_{+1}}{m} - \ldots - \frac{o_{+(C-1)}}{m}
</span></p></li>
<li><p>In total we only have to estimate <span class="math display">
(R - 1) + (C - 1 ) = R + C - 2
</span> parameters</p></li>
</ul>
</section>
<section id="number-of-fitted-parameters-2" class="slide level2 smaller">
<h2>Number of fitted parameters</h2>
<ul>
<li><p>In total we estimate <span class="math inline">R + C -2</span> parameters, so that <span class="math display">
{\rm fitted} = R + C - 2
</span></p></li>
<li><p>Therefore the degrees of freedom are <span class="math display">\begin{align*}
RC - 1 - {\rm fitted} &amp; = RC - 1 - R - C + 2  \\
                    &amp; = RC - R - C + 1 \\
                    &amp; = (R - 1)(C - 1)
\end{align*}</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence-1" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<h3 id="conclusion">Conclusion</h3>
<ul>
<li><p>Assume the null hypothesis of row and column independence <span class="math display">
H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C
</span></p></li>
<li><p>Suppose the counts are <span class="math inline">O \sim \mathop{\mathrm{Mult}}(m,p)</span> and expected counts are <span class="math display">
E_{ij} = \frac{o_{i+} \, o_{+j}}{m}
</span></p></li>
<li><p>By the previous slides and Theorem in Slide 88 we have that <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} }
\approx \ \chi_{RC - 1 - {\rm fitted} }^2 = \chi_{(R-1)(C-1)}^2  
</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence-2" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<h3 id="quality-of-approximation">Quality of approximation</h3>
<p>The chi-squared approximation <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} }
\approx \  \chi_{(R-1)(C-1)}^2  
</span> is good if <span class="math display">
E_{ij} \geq 5  \quad \text{ for all } \,\, i = 1 , \ldots , R  \, \text{ and }
j = 1, \ldots, C
</span></p>
</section>
<section id="the-chi-squared-test-of-independence" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<p><strong>Sample:</strong></p>
<ul>
<li><p>We draw <span class="math inline">m</span> items from population</p></li>
<li><p>Each item can be of type <span class="math inline">(i,j)</span> where</p>
<ul>
<li><span class="math inline">i = 1 , \ldots ,R</span></li>
<li><span class="math inline">j = 1 , \ldots ,C</span></li>
<li>Total of <span class="math inline">n = RC</span> types</li>
</ul></li>
<li><p><span class="math inline">O_{ij}</span> denotes the number of items of type <span class="math inline">(i,j)</span> drawn</p></li>
<li><p><span class="math inline">p_{ij}</span> is probability of observing type <span class="math inline">(i,j)</span></p></li>
<li><p><span class="math inline">p = (p_{ij})_{ij}</span> is probability matrix</p></li>
<li><p>The matrix of counts <span class="math inline">O = (o_{ij})_{ij}</span> has multinomial distribution <span class="math inline">\mathop{\mathrm{Mult}}(m,p)</span></p></li>
</ul>
</section>
<section id="the-chi-squared-test-of-independence-1" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<p><strong>Data:</strong> Matrix of counts, represented by two-way contigency table</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">o_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">o_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">o_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<p><strong>Hypothesis test:</strong> We test for independence of rows and columns <span class="math display">\begin{align*}
&amp; H_0 \colon X \, \text{ and } \, Y \, \text{ are independent } \\
&amp; H_1 \colon X \, \text{ and } \, Y \, \text{ are not independent }
\end{align*}</span></p>
</section>
<section id="the-chi-squared-test-of-independence-2" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<h3 id="procedure-6">Procedure</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts <span class="math display">
m = \sum_{i=1}^R \sum_{j=1}^C o_{ij}
</span></li>
<li>Compute marginal counts <span class="math display">
o_{i+} := \sum_{j=1}^C o_{ij} \qquad \qquad  o_{+j} := \sum_{i=1}^R o_{ij}
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-test-of-independence-3" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<h3 id="procedure-7">Procedure</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute estimated expected counts <span class="math display">
E_{ij} = \frac{o_{i+} \, o_{+j} }{ m }
</span></li>
<li>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}}
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-test-of-independence-4" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<h3 id="procedure-8">Procedure</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i</span> and <span class="math inline">j</span></li>
<li>In this case <span class="math display">
\chi^2 \ \approx \ \chi_{(R-1)(C-1)}^2
</span></li>
<li>Find critical value in chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> <span class="math display">
\chi^2_{(R-1)(C-1)} (0.05)
</span></li>
<li>Alternatively, compute p-value in R <span class="math display">
p := P( \chi^2_{(R-1)(C-1)} &gt; \chi^2 )
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-test-of-independence-5" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<h3 id="procedure-9">Procedure</h3>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>Reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 &gt; \chi_{(R-1)(C-1)}^2 (0.05)  \qquad \text{ or } \qquad p &lt; 0.05
</span></li>
<li>Do not reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 \leq \chi^2_{(R-1)(C-1)} (0.05)  \qquad \text{ or } \qquad
p \geq 0.05
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-test-of-independence-in-r" class="slide level2 smaller">
<h2>The chi-squared test of independence in R</h2>
<h3 id="general-commands-2">General commands</h3>
<ol type="1">
<li>Store each row of counts <span class="math inline">(o_{i1}, o_{i2}, \ldots, o_{iC})</span> in R vector
<ul>
<li><code>row_i &lt;- c(o_i1, o_i2, ..., o_iC)</code></li>
</ul></li>
<li>Assemble the rows into an R matrix
<ul>
<li><code>counts &lt;- rbind(row_1, ..., row_R)</code></li>
<li><code>counts</code> models the matrix of counts <span class="math inline">o = (o_{ij})_{ij}</span></li>
</ul></li>
<li>Perform a chi-squared test of independence on <code>counts</code>
<ul>
<li><code>chisq.test(counts)</code></li>
</ul></li>
<li>Read output: In particular look for the p-value</li>
</ol>
<p><strong>Note:</strong> Compute Monte Carlo p-value with option <code>simulate.p.value = TRUE</code></p>
</section></section>
<section>
<section id="part-7-test-of-independence-examples" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 7: <br>Test of independence: <br> Examples</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="example-residential-status-and-region" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>People are sampled at random in NW, London and SW</p></li>
<li><p>To each person we associate two categories:</p>
<ul>
<li>Residential Status: Rental or Owned</li>
<li>Region in which they live: NW, London, SW</li>
</ul></li>
<li><p><strong>Exercise:</strong> Test for independence of Residential Status and Region</p></li>
</ul>
</section>
<section id="example-residential-status-and-region-1" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand">Chi-squared test of independence by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Rows are <span class="math inline">R = 3</span> and columns are <span class="math inline">C = 2</span></li>
<li>Total and marginal counts are already provided in the table</li>
</ul></li>
</ol>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Tot</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>NW</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+} = 3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lon</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>SW</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Tot</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1} = 5703</span></td>
<td style="text-align: center;"><span class="math inline">o_{+2} = 2885</span></td>
<td style="text-align: center;"><span class="math inline">m = 8588</span></td>
</tr>
</tbody>
</table>
</section>
<section id="example-residential-status-and-region-2" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-1">Chi-squared test of independence by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute the estimated expected counts <span class="math inline">E_{ij} = \dfrac{o_{i+} \, o_{+j} }{ m }</span></li>
</ul></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Tot</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>NW</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{3051{\times}5703}{8588} \approx 2026</span></td>
<td style="text-align: center;"><span class="math inline">\frac{3051{\times}2885}{8588} \approx 1025</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+} = 3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lon</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{3220{\times}5703}{8588} \approx 2138</span></td>
<td style="text-align: center;"><span class="math inline">\frac{3220{\times}2885}{8588} \approx 1082</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>SW</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{2317{\times}5703}{8588} \approx 1539</span></td>
<td style="text-align: center;"><span class="math inline">\frac{2317{\times}1885}{8588} \approx 778</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Tot</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1} = 5703</span></td>
<td style="text-align: center;"><span class="math inline">o_{+2} = 2885</span></td>
<td style="text-align: center;"><span class="math inline">m = 8588</span></td>
</tr>
</tbody>
</table>
</section>
<section id="example-residential-status-and-region-3" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-2">Chi-squared test of independence by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute the chi-squared statistic <span class="math display">\begin{align*}
\chi^2 &amp; = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}} \\
     &amp; = \frac{(2180-2026.066)^2}{2026.066} + \frac{(871-1024.934)^2}{1024.934} \\
     &amp; \, + \frac{(1820-2138.293)^2}{2138.293}+\frac{(1400-1081.707)^2}{1081.707} \\
     &amp; \, + \frac{(1703-1538.641)^2}{1538.641}+\frac{(614-778.359)^2}{778.359} \\
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-residential-status-and-region-4" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-3">Chi-squared test of independence by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute the chi-squared statistic <span class="math display">\begin{align*}
\chi^2 &amp; = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}} \\
     &amp; = 11.695+23.119 \\
     &amp; \, + 47.379+93.658 \\
     &amp; \, + 17.557+34.707 \\
     &amp; = 228.12 \qquad (2\ \text{d.p.})
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-residential-status-and-region-5" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-4">Chi-squared test of independence by hand</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables</strong>:
<ul>
<li>Degrees of freedom are <span class="math inline">\, {\rm df} = (R - 1)(C - 1) = 2</span></li>
<li>We clearly have <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i</span> and <span class="math inline">j</span></li>
<li>Therefore the following approximation holds <span class="math display">
\chi^2 \ \approx \ \chi_{(R - 1)(C - 1)}^2 = \chi_{2}^2
</span></li>
<li>In chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> we find critical value <span class="math display">
\chi^2_{2} (0.05) = 5.99
</span></li>
</ul></li>
</ol>
</section>
<section id="example-residential-status-and-region-6" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-5">Chi-squared test of independence by hand</h3>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>We have that <span class="math display">
\chi^2 = 228.12 &gt; 5.99 = \chi_{2}^2 (0.05)
</span></li>
<li>Therefore we rejct <span class="math inline">H_0</span>, meaning that rows and columns are dependent</li>
</ul></li>
</ol>
</section>
<section id="example-residential-status-and-region-7" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-by-hand-6">Chi-squared test of independence by hand</h3>
<ol start="4" type="1">
<li><strong>Conclusion:</strong></li>
</ol>
<ul>
<li>There is evidence <span class="math inline">(p &lt; 0.05)</span> that Residential Status depends on Region</li>
<li>By rescaling table values, we can compute the table of percentages</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">71.5\%</span></td>
<td style="text-align: center;"><span class="math inline">28.5\%</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">56.5\%</span></td>
<td style="text-align: center;"><span class="math inline">43.5\%</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">73.5\%</span></td>
<td style="text-align: center;"><span class="math inline">26.5\%</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The above suggests that in London fewer homes are Owned and more Rented</li>
</ul>
</section>
<section id="example-residential-status-and-region-8" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-in-r">Chi-squared test of independence in R</h3>
<ul>
<li>Test can be performed using code <a href="codes/independence_test.R">independence_test.R</a></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store each row into and R vector</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a>row_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2180</span>, <span class="dv">871</span>)</span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a>row_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1820</span>, <span class="dv">1400</span>)</span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a>row_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1703</span>, <span class="dv">614</span>)</span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the rows into an R matrix</span></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rbind</span>(row_1, row_2, row_3)</span>
<span id="cb24-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test of independence</span></span>
<span id="cb24-10"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb24-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb24-13"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-residential-status-and-region-9" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<h3 id="chi-squared-test-of-independence-in-r-1">Chi-squared test of independence in R</h3>
<ul>
<li>Running the code we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  counts
X-squared = 228.11, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>This confirms the chi-squared statistic computed by hand <span class="math inline">\chi^2  = 228.11</span></li>
<li>It also confirms the degrees of freedom <span class="math inline">\, {\rm df} = 2</span></li>
<li>The p-value is <span class="math inline">p \approx 0 &lt; 0.05</span></li>
<li>Therefore <span class="math inline">H_0</span> is rejected and Residential Status depends on Region</li>
</ul>
</section>
<section id="example-manchester-united-performance-10" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<p><strong>Recap of Background story:</strong></p>
<ul>
<li>From 1992 to 2013 Man Utd won 13 Premier Leagues out of 21</li>
<li>This is the best performance in the Premier League era</li>
<li>This was under manager Sir Alex Ferguson</li>
<li>Ferguson stepped down in 2014</li>
<li>Since 2014 Man Utd has not won the PL and was managed by 6 different people (excluding interims)</li>
</ul>
<p><strong>Question:</strong> Are the 6 managers to blame for worse Team Performance?</p>
</section>
<section id="example-manchester-united-performance-11" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Table contains Man Utd games since 2014 season</p></li>
<li><p>To each Man Utd game in the sample we associate two categories:</p>
<ul>
<li>Manager and Result</li>
</ul></li>
<li><p><strong>Question:</strong> Is there association between Manager and Team Performance?</p></li>
</ul>
</section>
<section id="example-manchester-united-performance-12" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<ul>
<li><p>To answer the question we perform chi-square test of independence in R</p></li>
<li><p>Test can be performed by suitably modifying the code <a href="codes/independence_test.R">independence_test.R</a></p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store each row into and R vector</span></span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a>row_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">9</span>, <span class="dv">15</span>)</span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a>row_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">54</span>, <span class="dv">25</span>, <span class="dv">24</span>) </span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>row_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">32</span>, <span class="dv">28</span>) </span>
<span id="cb26-5"><a aria-hidden="true" tabindex="-1"></a>row_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">91</span>, <span class="dv">37</span>, <span class="dv">40</span>)</span>
<span id="cb26-6"><a aria-hidden="true" tabindex="-1"></a>row_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span>
<span id="cb26-7"><a aria-hidden="true" tabindex="-1"></a>row_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">12</span>, <span class="dv">28</span>)</span>
<span id="cb26-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the rows into an R matrix</span></span>
<span id="cb26-10"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rbind</span>(row_1, row_2, row_3, row_4, row_5, row_6)</span>
<span id="cb26-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test of independence</span></span>
<span id="cb26-13"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb26-14"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb26-16"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-manchester-united-performance-13" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<h3 id="chi-squared-test-of-independence-in-r-2">Chi-squared test of independence in R</h3>
<ul>
<li>Running the code we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  counts
X-squared = 12.678, df = 10, p-value = 0.2422</code></pre>
</div>
</div>
<ul>
<li>p-value is <span class="math inline">p \approx 0.24 &gt; 0.05</span></li>
<li>We do not reject <span class="math inline">H_0</span></li>
<li>There is no evidence of association between Manager and Team Performance</li>
<li>This suggests that there are deep structural problems that cannot be resolved simply by changing the Manager</li>
</ul>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>