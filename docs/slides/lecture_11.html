<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 11</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="lecture-11-violation-of-regression-assumptions" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Lecture 11: <br>Violation of regression <br> assumptions</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-lecture-11" class="slide level2">
<h2>Outline of Lecture 11</h2>
<ol type="1">
<li>Regression modelling assumptions</li>
<li>Heteroscedasticity</li>
<li>Autocorrelation</li>
<li>Multicollinearity</li>
<li>Stepwise regression and overfitting</li>
<li>Dummy variable regression models</li>
</ol>
</section></section>
<section>
<section id="part-1-regression-assumptions" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Regression assumptions</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="regression-modelling-assumptions" class="slide level2 smaller">
<h2>Regression modelling assumptions</h2>
<p>In Lecture 9 we have introduced the general linear regression model</p>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \beta_2 z_{i2} + \ldots + \beta_p z_{ip} + \varepsilon_i
</span></p>
<ul>
<li>There are <span class="math inline">p</span> predictor random variables</li>
</ul>
<p><span class="math display">
Z_1 \, , \,\, \ldots \, , \, Z_p
</span></p>
<ul>
<li><span class="math inline">Y_i</span> is the conditional distribution</li>
</ul>
<p><span class="math display">
Y | Z_1 = z_{i1} \,, \,\, \ldots \,, \,\, Z_p = z_{ip}
</span></p>
<ul>
<li>The errors <span class="math inline">\varepsilon_i</span> are random variables</li>
</ul>
</section>
<section id="regression-assumptions-on-y_i" class="slide level2 smaller">
<h2>Regression assumptions on <span class="math inline">Y_i</span></h2>
<ol type="1">
<li><p><strong>Predictor is known:</strong> The values <span class="math inline">z_{i1}, \ldots, z_{ip}</span> are known</p></li>
<li><p><strong>Normality:</strong> The distribution of <span class="math inline">Y_i</span> is normal</p></li>
<li><p><strong>Linear mean:</strong> There are parameters <span class="math inline">\beta_1,\ldots,\beta_p</span> such that <span class="math display">
{\rm I\kern-.3em E}[Y_i] = \beta_1 z_{i1} + \ldots + \beta_p z_{ip}  
</span></p></li>
<li><p><strong>Homoscedasticity:</strong> There is a parameter <span class="math inline">\sigma^2</span> such that <span class="math display">
{\rm Var}[Y_i] = \sigma^2
</span></p></li>
<li><p><strong>Independence:</strong> rv <span class="math inline">Y_1 , \ldots , Y_n</span> are independent and thus uncorrelated</p></li>
</ol>
<p><span class="math display">
{\rm Cor}(Y_i,Y_j) = 0 \qquad \forall \,\, i \neq j
</span></p>
</section>
<section id="equivalent-assumptions-on-varepsilon_i" class="slide level2 smaller">
<h2>Equivalent assumptions on <span class="math inline">\varepsilon_i</span></h2>
<ol type="1">
<li><p><strong>Predictor is known:</strong> The values <span class="math inline">z_{i1}, \ldots, z_{ip}</span> are known</p></li>
<li><p><strong>Normality:</strong> The distribution of <span class="math inline">\varepsilon_i</span> is normal</p></li>
<li><p><strong>Linear mean:</strong> The errors have zero mean <span class="math display">
{\rm I\kern-.3em E}[\varepsilon_i] = 0
</span></p></li>
<li><p><strong>Homoscedasticity:</strong> There is a parameter <span class="math inline">\sigma^2</span> such that <span class="math display">
{\rm Var}[\varepsilon_i] = \sigma^2
</span></p></li>
<li><p><strong>Independence:</strong> Errors <span class="math inline">\varepsilon_1 , \ldots , \varepsilon_n</span> are independent and thus uncorrelated</p></li>
</ol>
<p><span class="math display">
{\rm Cor}(\varepsilon_i, \varepsilon_j) = 0 \qquad \forall \,\, i \neq j
</span></p>
</section>
<section id="extra-assumption-on-design-matrix" class="slide level2 smaller">
<h2>Extra assumption on design matrix</h2>
<ol start="6" type="1">
<li>The design matrix <span class="math inline">Z</span> is such that</li>
</ol>
<p><span class="math display">
Z^T Z  \, \text{ is invertible}
</span></p>
<ul>
<li>Assumptions 1-6 allowed us to estimate the parameters</li>
</ul>
<p><span class="math display">
\beta = (\beta_1, \ldots, \beta_p)
</span></p>
<ul>
<li>By maximizing the likelihood we obtained estimator</li>
</ul>
<p><span class="math display">
\hat \beta = (Z^T Z)^{-1} Z^T y
</span></p>
</section>
<section id="violation-of-assumptions" class="slide level2 smaller">
<h2>Violation of Assumptions</h2>
<h3 id="we-consider-3-scenarios">We consider 3 scenarios</h3>
<ol type="i">
<li><strong>Heteroscedasticity:</strong> The violation of Assumption 4 of homoscedasticity</li>
</ol>
<p><span class="math display">
{\rm Var}[\varepsilon_i] \neq {\rm Var}[\varepsilon_j] \qquad \text{ for some } \,\, i \neq j
</span></p>
<ol start="2" type="i">
<li><strong>Autocorrelation:</strong> The violation of Assumption 5 of no-correlation</li>
</ol>
<p><span class="math display">
{\rm Cor}( \varepsilon_i, \varepsilon_j ) \neq 0  \qquad \text{ for some } \,\, i \neq j
</span></p>
<ol start="3" type="i">
<li><strong>Multicollinearity:</strong> The violation of Assumption 6 of invertibilty of the matrix</li>
</ol>
<p><span class="math display">
Z^T Z
</span></p>
</section></section>
<section>
<section id="part-2-heteroscedasticity" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Heteroscedasticity</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="heteroscedasticity" class="slide level2 smaller">
<h2>Heteroscedasticity</h2>
<ul>
<li>The general linear regression model is</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \beta_2 z_{i2} + \ldots + \beta_p z_{ip} + \varepsilon_i
</span></p>
<ul>
<li>Consider Assumption 4
<ul>
<li><strong>Homoscedasticity:</strong> There is a parameter <span class="math inline">\sigma^2</span> such that <span class="math display">
  {\rm Var}[\varepsilon_i] = \sigma^2 \qquad \forall \,\, i
  </span></li>
</ul></li>
<li><strong>Heteroscedasticity:</strong> The violation of Assumption 4</li>
</ul>
<p><span class="math display">
{\rm Var}[\varepsilon_i] \neq {\rm Var}[\varepsilon_j] \qquad \text{ for some } \,\, i \neq j
</span></p>
</section>
<section id="why-is-homoscedasticity-important" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li><p>In Lecture 10 we presented a few methods to assess linear models</p>
<ul>
<li>Coefficient <span class="math inline">R^2</span></li>
<li><span class="math inline">t</span>-tests for parameters significance</li>
<li><span class="math inline">F</span>-test for model selection</li>
</ul></li>
<li><p>The above methods <strong>rely heavily</strong> on homoscedasticity</p></li>
</ul>
</section>
<section id="why-is-homoscedasticity-important-1" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li><p>For example the maximum likelihood estimation relied on the calculation <span class="math display">\begin{align*}
  L &amp; = \prod_{i=1}^n  f_{Y_i} (y_i)  
      = \prod_{i=1}^n \frac{1}{\sqrt{2\pi \sigma^2}} \exp \left( -\frac{(y_i - \hat y_i)^2}{2\sigma^2} \right) \\[15pts]
    &amp; = \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{\sum_{i=1}^n(y_i- \hat y_i)^2}{2\sigma^2}      \right) \\[15pts]
    &amp; = \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{ \mathop{\mathrm{RSS}}}{2\sigma^2}      \right)
  \end{align*}</span></p></li>
<li><p>The calculation is only possible thanks to homoscedasticity</p></li>
</ul>
<p><span class="math display">
{\rm Var}[Y_i] = \sigma^2 \qquad \forall \,\, i
</span></p>
</section>
<section id="why-is-homoscedasticity-important-2" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li>Suppose the calculation in previous slide holds</li>
</ul>
<p><span class="math display">
L = \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{ \mathop{\mathrm{RSS}}}{2\sigma^2}      \right)
</span></p>
<ul>
<li>Then maximizing the likelihood is equivalent to solving</li>
</ul>
<p><span class="math display">
\min_{\beta} \ \mathop{\mathrm{RSS}}
</span></p>
<ul>
<li>The above has the closed form solution</li>
</ul>
<p><span class="math display">
\hat \beta = (Z^T Z)^{-1} Z^T y
</span></p>
</section>
<section id="why-is-homoscedasticity-important-3" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li>Without homoscedasticity we would have</li>
</ul>
<p><span class="math display">
L \neq \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{ \mathop{\mathrm{RSS}}}{2\sigma^2}      \right)
</span></p>
<ul>
<li><p>Therefore <span class="math inline">\hat \beta</span> would no longer maximize the likelihood!</p></li>
<li><p>In this case <span class="math inline">\hat \beta</span> would still be an unbiased estimator for <span class="math inline">\beta</span></p></li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[\hat \beta ] = \beta
</span></p>
</section>
<section id="why-is-homoscedasticity-important-4" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li><p>However the quantity <span class="math display">
S^2 = \frac{ \mathop{\mathrm{RSS}}(\hat \beta) }{n-p}
</span> is not anymore unbiased estimator for the population variance <span class="math inline">\sigma^2</span> <span class="math display">
{\rm I\kern-.3em E}[S^2] \neq \sigma^2
</span></p></li>
<li><p>This is a problem because the estimated standard error for <span class="math inline">\beta_j</span> involves <span class="math inline">S^2</span> <span class="math display">
\mathop{\mathrm{e.s.e.}}(\beta_j) = \xi_{jj}^{1/2} \, S  
</span></p></li>
<li><p>Therefore <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> becomes <strong>unreliable</strong></p></li>
</ul>
</section>
<section id="why-is-homoscedasticity-important-5" class="slide level2 smaller">
<h2>Why is homoscedasticity important?</h2>
<ul>
<li><p>Then also t-statistic for significance of <span class="math inline">\beta_j</span> becomes unreliable</p></li>
<li><p>This is because the t-statistic depends on <span class="math inline">\mathop{\mathrm{e.s.e.}}</span></p></li>
</ul>
<p><span class="math display">
t = \frac{ \hat\beta_j - \beta_j }{ \mathop{\mathrm{e.s.e.}}}
</span></p>
<ul>
<li><strong>Without homoscedasticity the regression maths does not work!</strong>
<ul>
<li>t-tests for significance of <span class="math inline">\beta_j</span></li>
<li>confidence intervals for <span class="math inline">\beta_j</span></li>
<li><span class="math inline">F</span>-tests for model selection</li>
<li>They all break down and become unreliable!</li>
</ul></li>
</ul>
</section>
<section id="is-heteroscedastcity-a-serious-problem" class="slide level2 smaller">
<h2>Is heteroscedastcity a serious problem?</h2>
<ul>
<li><p>Heteroscedasticity in linear regression is no longer a big problem</p></li>
<li><p>This is thanks to 1980s research on <em>robust standard errors</em> (<a href="https://en.wikipedia.org/wiki/Heteroskedasticity-consistent_standard_errors">more info here</a>)</p></li>
<li><p>Moreover heteroscedasticity only becomes a problem when it is <strong>severe</strong></p></li>
</ul>
</section>
<section id="how-to-detect-heteroscedasticity" class="slide level2 smaller">
<h2>How to detect Heteroscedasticity</h2>
<ul>
<li>Heteroscedasticity is commonly present in real-world datasets
<ul>
<li>We should be able to detect it</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>There are formal tests (see <span class="citation" data-cites="gujarati_porter">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span>)
<ul>
<li>Goldfeldt-Quant test</li>
<li>White’s test for heteroscedasticity</li>
</ul></li>
</ul>
</section>
<section id="how-to-detect-heteroscedasticity-1" class="slide level2 smaller">
<h2>How to detect Heteroscedasticity</h2>
<ul>
<li>Alternative: <strong>graphical checks</strong>
<ul>
<li>Simpler and more robust</li>
</ul></li>
<li>They involve studying the model <strong>residuals</strong></li>
</ul>
<p><span class="math display">
e_i := y_i - \hat y_i
</span></p>
<ul>
<li><p>By definition <span class="math inline">e_i</span> is sampled from <span class="math inline">\varepsilon_i</span></p></li>
<li><p>We have heteroscedasticity if</p></li>
</ul>
<p><span class="math display">
{\rm Var}[\varepsilon_i] \neq {\rm Var}[\varepsilon_j] \, \quad \, \text{ for some } \, i \neq j
</span></p>
<ul>
<li>Hence under heteroscedasticity the residuals <span class="math inline">e_i</span> have <strong>different variance</strong></li>
</ul>
</section>
<section id="graphical-checks" class="slide level2 smaller">
<h2>Graphical checks</h2>
<h3 id="first-method-histogram-of-residuals">First method: Histogram of residuals</h3>
<ul>
<li>Yes Heteroscedasticity:
<ul>
<li>Residuals have different variance</li>
<li>Histogram will display <strong>asymetric pattern</strong></li>
</ul></li>
<li>No Heteroscedasticity:
<ul>
<li>Homoscedasticity assumption holds</li>
<li>Residuals have same variance</li>
<li>Histogram will look like <strong>normal</strong> distribution <span class="math inline">N(0,\sigma^2)</span></li>
</ul></li>
</ul>
</section>
<section id="interpretation-of-histograms" class="slide level2 smaller">
<h2>Interpretation of Histograms</h2>
<h3 id="left-homoscedastic-qquadquadquad-right-heteroscedastic">Left: Homoscedastic <span class="math inline">\qquad\quad\quad</span> Right: Heteroscedastic</h3>
<div class="column" style="width:48%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:48%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="graphical-checks-1" class="slide level2 smaller">
<h2>Graphical checks</h2>
<h3 id="second-method-residual-graphs">Second method: Residual graphs</h3>
<ul>
<li>Residual graphs are plots of
<ul>
<li>Residuals against fitted values</li>
<li>Squared residuals against fitted values</li>
</ul></li>
<li>Important:
<ul>
<li>No Heteroscedasticity: Plots will look <strong>random</strong></li>
<li>Yes Heteroscedasticity: Plots will show certain <strong>patterns</strong></li>
</ul></li>
<li>Good reference is the book <span class="citation" data-cites="draper_smith">[<a href="#/references" role="doc-biblioref" onclick="">2</a>]</span></li>
</ul>
</section>
<section id="interepretation-of-residual-graphs" class="slide level2 smaller">
<h2>Interepretation of Residual Graphs</h2>
<div class="column" style="width:50%;">
<ul>
<li><strong>No systematic pattern:</strong>
<ul>
<li>Suggests no heteroscedasticity</li>
<li>Corresponds to constant variance</li>
<li>Homoscedasticity assumption holds</li>
</ul></li>
<li>Residuals resemble sample <span class="math inline">N(0,\sigma^2)</span>
<ul>
<li>About half residuals negative and half positive</li>
<li>Vertical spread is comparable</li>
</ul></li>
</ul>
</div><div class="column" style="width:47%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="interepretation-of-residual-graphs-1" class="slide level2 smaller">
<h2>Interepretation of Residual Graphs</h2>
<h3 id="patterns-implying-heteroscedasticity">Patterns implying Heteroscedasticity</h3>
<ol type="1">
<li><p>Funnelling out of residuals</p></li>
<li><p>Funnelling in of residuals</p></li>
<li><p>Linear residuals – Proportional to <span class="math inline">\hat y_i</span></p></li>
<li><p>Quadratic residuals – Proportional to <span class="math inline">\hat{y}^2_i</span></p></li>
</ol>
<p><strong>In these special cases we can transform the data to avoid heteroscedasticity</strong></p>
</section>
<section id="funnelling-out-of-residuals" class="slide level2 smaller">
<h2>Funnelling out of residuals</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/funnellinplot.png" style="width:100.0%"></p>
</div></div>
</section>
<section id="funnelling-in-of-residuals" class="slide level2 smaller">
<h2>Funnelling in of residuals</h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/funnelloutplot.png" style="width:100.0%"></p>
</div></div>
</section>
<section id="linear-and-quadratic-residuals" class="slide level2">
<h2>Linear and Quadratic residuals</h2>
<div class="column" style="width:48%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:48%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="remedial-transformations" class="slide level2 smaller">
<h2>Remedial transformations</h2>
<ul>
<li>To try and reduce heteroscedasticity we can
<ul>
<li>transform the data <span class="math inline">y</span></li>
</ul></li>
<li>A tranformation which often helps is
<ul>
<li><span class="math inline">\, \log y</span></li>
</ul></li>
<li>For linear and quadratic patterns you can try
<ul>
<li><span class="math inline">\, y^2</span></li>
<li><span class="math inline">\, \sqrt{y}</span></li>
</ul></li>
</ul>
</section>
<section id="remedial-transformations-1" class="slide level2 smaller">
<h2>Remedial transformations</h2>
<ul>
<li><p>Heteroscedasticity can be associated with some of the <span class="math inline">X</span>-variables</p>
<ul>
<li>In this case plot the residuals or squared residuals against <span class="math inline">X</span></li>
</ul></li>
<li><p>The book <span class="citation" data-cites="gujarati_porter">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span> discusses two cases</p>
<ul>
<li>The error variance is proportional to <span class="math inline">X^2_i</span> <span class="math display">
  {\rm Var}[\varepsilon_i] \, \approx \, \sigma^2 \, X^2_i
  </span></li>
<li>The error variance is proportional to <span class="math inline">X_i</span> <span class="math display">
  {\rm Var}[\varepsilon_i] \, \approx \, \sigma^2 \, X_i
  </span></li>
</ul></li>
<li><p><strong>In each case divide through by the square root of the offending <span class="math inline">X</span>-term</strong></p></li>
</ul>
</section>
<section id="error-variance-proportional-to-x_i2" class="slide level2 smaller">
<h2>Error variance proportional to <span class="math inline">X_i^2</span></h2>
<ul>
<li>Start with the model</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 + \beta_2 X_{i} + \varepsilon_i
</span></p>
<ul>
<li>Divide through by <span class="math inline">X_i</span></li>
</ul>
<p><span class="math display">\begin{equation} \tag{1}
\frac{Y_i}{X_i} = \frac{\beta_1}{X_i}+\beta_2+\frac{\varepsilon_i}{X_i}
\end{equation}</span></p>
<ul>
<li>Estimate equation (1) with usual least squares regression approach</li>
</ul>
</section>
<section id="error-variance-proportional-to-x_i" class="slide level2 smaller">
<h2>Error variance proportional to <span class="math inline">X_i</span></h2>
<ul>
<li>Start with the model</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 + \beta_2 X_{i} + \varepsilon_i
</span></p>
<ul>
<li>Divide through by <span class="math inline">\sqrt{X_i}</span></li>
</ul>
<p><span class="math display">\begin{equation} \tag{2}
\frac{Y_i}{\sqrt{X_i}} = \frac{\beta_1}{\sqrt{X_i}}+\beta_2 \sqrt{X_i} + \frac{\varepsilon_i}{\sqrt{X_i}}
\end{equation}</span></p>
<ul>
<li>Estimate equation (2) with usual least squares regression approach</li>
</ul>
</section>
<section id="analysis-of-regression-residuals-in-r" class="slide level2 smaller">
<h2>Analysis of regression residuals in R</h2>
<ul>
<li><p>We need R commands for <strong>residuals</strong> and <strong>fitted values</strong></p></li>
<li><p>Fit a linear model as usual</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To obtain fitted values <span class="math inline">\hat y_i</span></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute fitted values</span></span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a>fitted.values <span class="ot">&lt;-</span> model<span class="sc">$</span>fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To obtain the residual values <span class="math inline">\varepsilon_i = y_i - \hat y_i</span></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute residual values</span></span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> model<span class="sc">$</span>resid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-stock-vs-gold-prices" class="slide level2 smaller">
<h2>Example: Stock Vs Gold prices</h2>
<ul>
<li><p>The full code for the example is available here <a href="codes/residual_graphs.R">residual_graphs.R</a></p></li>
<li><p>Stock Vs Gold prices data is available here <a href="datasets/stock_gold.txt">stock_gold.txt</a></p></li>
<li><p>Read data into R and fit simple regression</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset on Stock Vs Gold prices</span></span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"stock_gold.txt"</span>,</span>
<span id="cb4-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store data-frame into 2 vectors</span></span>
<span id="cb4-6"><a aria-hidden="true" tabindex="-1"></a>stock.price <span class="ot">&lt;-</span> prices[ , <span class="dv">1</span>]</span>
<span id="cb4-7"><a aria-hidden="true" tabindex="-1"></a>gold.price <span class="ot">&lt;-</span> prices[ , <span class="dv">2</span>]</span>
<span id="cb4-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb4-10"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gold.price <span class="sc">~</span> stock.price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Plot:</strong> Residuals look heteroscedastic
<ul>
<li>Most points are below the line</li>
<li>Points under the line appear more distant</li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 60%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stock.price, </span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a>     gold.price, </span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Stock Price"</span>, </span>
<span id="cb5-5"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Gold Price"</span>,</span>
<span id="cb5-6"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb5-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot regression line</span></span>
<span id="cb5-9"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, </span>
<span id="cb5-10"><a aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>, </span>
<span id="cb5-11"><a aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Histogram:</strong> Confirms initial intuition of heteroscedasticity
<ul>
<li>Residuals are not normally distributed</li>
<li>Residuals have different variance (skewed histogram)</li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 60%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute residuals</span></span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> model<span class="sc">$</span>resid</span>
<span id="cb6-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb6-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals,</span>
<span id="cb6-6"><a aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb6-7"><a aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb6-8"><a aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Residual Graph:</strong> Displays funnelling out pattern
<ul>
<li>We definitely have <strong>heteroscedasticity</strong></li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 65%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute fitted values</span></span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> model<span class="sc">$</span>fitted</span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the residual graph</span></span>
<span id="cb7-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitted, residuals,</span>
<span id="cb7-6"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, </span>
<span id="cb7-7"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb7-8"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb7-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add y = 0 line for reference</span></span>
<span id="cb7-11"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Remedial transformation:</strong> To try and reduce heteroscedasticity take
<ul>
<li><span class="math inline">\, \log y</span></li>
</ul></li>
<li>This means we need to fit the model</li>
</ul>
<p><span class="math display">
\log Y_i = \alpha + \beta X_i + \varepsilon_i
</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Transform data via log(y)</span></span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a>log.gold.price <span class="ot">&lt;-</span> <span class="fu">log</span>(gold.price)</span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model with log(y) data</span></span>
<span id="cb8-5"><a aria-hidden="true" tabindex="-1"></a>log.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log.gold.price <span class="sc">~</span> stock.price)</span>
<span id="cb8-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute residuals for log model</span></span>
<span id="cb8-8"><a aria-hidden="true" tabindex="-1"></a>log.residuals <span class="ot">&lt;-</span> log.model<span class="sc">$</span>resid</span>
<span id="cb8-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute fitted values for log model</span></span>
<span id="cb8-11"><a aria-hidden="true" tabindex="-1"></a>log.fitted <span class="ot">&lt;-</span> log.model<span class="sc">$</span>fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section id="section-4" class="title-slide slide level1 smaller center">
<h1></h1>
<ul>
<li>Heteroscedasticity has definitely reduced
<ul>
<li>Left: Residual plot for original model</li>
<li>Right: Residual plot for <span class="math inline">\log y</span> data model</li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 50%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section id="section-5" class="title-slide slide level1 smaller center">
<h1></h1>
<ul>
<li>Heteroscedasticity has definitely reduced
<ul>
<li>Left: Histogram of residuals for original model</li>
<li>Right: Histogram of residuals for <span class="math inline">\log y</span> data model</li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 50%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>

<section>
<section id="part-2-autocorrelation" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Autocorrelation</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="autocorrelation" class="slide level2 smaller">
<h2>Autocorrelation</h2>
<ul>
<li>The general linear regression model is</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \beta_2 z_{i2} + \ldots + \beta_p z_{ip} + \varepsilon_i
</span></p>
<ul>
<li>Consider Assumption 5
<ul>
<li><strong>Independence:</strong> Errors <span class="math inline">\varepsilon_1, \ldots, \varepsilon_n</span> are independent and thus uncorrelated <span class="math display">
  {\rm Cor}(\varepsilon_i , \varepsilon_j) = 0 \qquad \forall \,\, i \neq j
  </span></li>
</ul></li>
<li><strong>Autocorrelation:</strong> The violation of Assumption 5</li>
</ul>
<p><span class="math display">
{\rm Cor}(\varepsilon_i , \varepsilon_j) = 0 \qquad \text{ for some } \,\, i \neq j
</span></p>
</section>
<section id="why-is-independence-important" class="slide level2 smaller">
<h2>Why is independence important?</h2>
<ul>
<li><p>Recall the methods to assess linear models</p>
<ul>
<li>Coefficient <span class="math inline">R^2</span></li>
<li><span class="math inline">t</span>-tests for parameters significance</li>
<li><span class="math inline">F</span>-test for model selection</li>
</ul></li>
<li><p>The above methods <strong>rely heavily</strong> on independence</p></li>
</ul>
</section>
<section id="why-is-independence-important-1" class="slide level2 smaller">
<h2>Why is independence important?</h2>
<ul>
<li><p>Once again let us consider the likelihood calculation <span class="math display">\begin{align*}
  L &amp; = f(y_1, \ldots, y_n) =  \prod_{i=1}^n  f_{Y_i} (y_i)  
       \\[15pts]
    &amp; = \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{\sum_{i=1}^n(y_i- \hat y_i)^2}{2\sigma^2}      \right) \\[15pts]
    &amp; = \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{ \mathop{\mathrm{RSS}}}{2\sigma^2}      \right)
  \end{align*}</span></p></li>
<li><p>The second equality is only possible thanks to independence of</p></li>
</ul>
<p><span class="math display">
Y_1 , \ldots, Y_n
</span></p>
</section>
<section id="why-is-independence-important-2" class="slide level2 smaller">
<h2>Why is independence important?</h2>
<ul>
<li>If we have <strong>autocorrelation</strong> then</li>
</ul>
<p><span class="math display">
{\rm Cor}(\varepsilon_i,\varepsilon_j) \neq 0 \quad \text{ for some } \, i \neq j
</span></p>
<ul>
<li>In particualar we would have</li>
</ul>
<p><span class="math display">
\varepsilon_i \, \text{ and } \, \varepsilon_j \, \text{ dependent } \quad \implies \quad Y_i \, \text{ and } \, Y_j \, \text{ dependent }
</span></p>
<ul>
<li>Therefore the calculation in previous slide breaks down</li>
</ul>
<p><span class="math display">
L \neq \frac{1}{(2\pi \sigma^2)^{n/2}} \, \exp   \left(   -\frac{ \mathop{\mathrm{RSS}}}{2\sigma^2}      \right)
</span></p>
</section>
<section id="why-is-independence-important-3" class="slide level2 smaller">
<h2>Why is independence important?</h2>
<ul>
<li><p>In this case <span class="math inline">\hat \beta</span> does no longer maximize the likelihood!</p></li>
<li><p>As already seen, this implies that</p></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}(\beta_j) \,\, \text{ is unreliable}
</span></p>
<ul>
<li><strong>Without independence the regression maths does not work!</strong>
<ul>
<li>t-tests for significance of <span class="math inline">\beta_j</span></li>
<li>confidence intervals for <span class="math inline">\beta_j</span></li>
<li><span class="math inline">F</span>-tests for model selection</li>
<li>They all break down and become unreliable!</li>
</ul></li>
</ul>
</section>
<section id="causes-of-autocorrelation" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="time-series-data">Time-series data</h3>
<ul>
<li>Autocorrelation means that</li>
</ul>
<p><span class="math display">
{\rm Cor}(\varepsilon_i,\varepsilon_j) \neq 0 \quad \text{ for some } \, i \neq j
</span></p>
<ul>
<li><p>Autocorrelation if often unavoidable</p></li>
<li><p>Typically associated with <strong>time series data</strong></p>
<ul>
<li>Observations ordered wrt time or space are usually correlated</li>
<li>This is because observations taken close together may take similar values</li>
</ul></li>
</ul>
</section>
<section id="causes-of-autocorrelation-1" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="financial-data">Financial data</h3>
<ul>
<li>Autocorrelation is especially likely for datasets in
<ul>
<li>Accounting</li>
<li>Finance</li>
<li>Economics</li>
</ul></li>
<li>Autocorrelation is likely if the data have been recorded over time
<ul>
<li>E.g. daily, weekly, monthly, quarterly, yearly</li>
</ul></li>
<li>Example: Datasetet on <em>Stock prices</em> and <em>Gold prices</em>
<ul>
<li>General linear regression model assumes uncorrelated errors</li>
<li>Not realistic to assume that price observations for say 2020 and 2021 would be independent</li>
</ul></li>
</ul>
</section>
<section id="causes-of-autocorrelation-2" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="inertia">Inertia</h3>
<ul>
<li><p>Economic time series tend to exhibit <strong>cyclical behaviour</strong></p></li>
<li><p>Examples include GNP, price indices, production figures, employment statistics etc.</p></li>
<li><p>Since these series tend to be quite slow moving</p>
<ul>
<li>Effect of inertia is that successive observations are highly correlated</li>
</ul></li>
</ul>
<p><strong>This is an extremely common phenomenon in financial and economic time series</strong></p>
</section>
<section id="causes-of-autocorrelation-3" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="cobweb-phenomenon">Cobweb Phenomenon</h3>
<ul>
<li><p>Characteristic of industries in which a large amount of time passes between</p>
<ul>
<li>the decision to produce something</li>
<li>and its arrival on the market</li>
</ul></li>
<li><p>Cobweb phenomenon is common with agricultural commodities</p></li>
<li><p>Economic agents (e.g.&nbsp;farmers) decide</p>
<ul>
<li>how many goods to supply to the market</li>
<li>based on previous year price</li>
</ul></li>
</ul>
</section>
<section id="causes-of-autocorrelation-4" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="cobweb-phenomenon-1">Cobweb Phenomenon</h3>
<ul>
<li><strong>Example:</strong> the amount of crops farmers supply to the market at time <span class="math inline">t</span> might be</li>
</ul>
<p><span class="math display">\begin{equation} \tag{3}
{\rm Supply}_t = \beta_1 + \beta_2 \, {\rm Price}_{t-1} + \varepsilon_t
\end{equation}</span></p>
<ul>
<li><p>Errors <span class="math inline">\varepsilon_t</span> in equation (3) are unlikely to be completely random and patternless</p></li>
<li><p>This is because they represent actions of intelligent economic agents (e.g.&nbsp;farmers)</p></li>
</ul>
<p><strong>Error terms are likely to be autocorrelated</strong></p>
</section>
<section id="causes-of-autocorrelation-5" class="slide level2 smaller">
<h2>Causes of Autocorrelation</h2>
<h3 id="data-manipulation">Data manipulation</h3>
<p><strong>Examples:</strong></p>
<ul>
<li><p>Quarterly data may smooth out the wild fluctuations in monthly sales figures</p></li>
<li><p>Low frequency economic survey data may be interpolated</p></li>
</ul>
<p><strong>However:</strong> Such data transformations may be inevitable</p>
<ul>
<li><p>In social sciences data quality may be variable</p></li>
<li><p>This may induce systematic patterns and autocorrelation</p></li>
</ul>
<p><strong>No magic solution – Autocorrelation is unavoidable and must be considered</strong></p>
</section>
<section id="detection-of-autocorrelation" class="slide level2 smaller">
<h2>Detection of autocorrelation</h2>
<ul>
<li>Statistical tests
<ul>
<li>Runs test</li>
<li>Durbin-Watson test</li>
</ul></li>
<li>Graphical methods
<ul>
<li>Simpler but can be more robust and more informative</li>
</ul></li>
</ul>
<p><strong>Graphical and statistical methods can be useful cross-check of each other!</strong></p>
</section>
<section id="graphical-tests-for-autocorrelation" class="slide level2 smaller">
<h2>Graphical tests for autocorrelation</h2>
<ul>
<li>Time-series plot of residuals
<ul>
<li>Plot residuals <span class="math inline">e_t</span> over time</li>
<li>Check to see if any evidence of a systematic pattern exists</li>
</ul></li>
<li>Autocorrelation plot of residuals
<ul>
<li>Natural to think that <span class="math inline">\varepsilon_t</span> and <span class="math inline">\varepsilon_{t-1}</span> may be correlated</li>
<li>Plot residual <span class="math inline">e_t</span> against <span class="math inline">e_{t-1}</span></li>
</ul></li>
<li>Important:
<ul>
<li>No Autocorrelation: Plots will look <strong>random</strong></li>
<li>Yes Autocorrelation: Plots will show certain <strong>patterns</strong></li>
</ul></li>
</ul>
</section>
<section id="graphical-tests-in-r" class="slide level2 smaller">
<h2>Graphical tests in R</h2>
<ul>
<li><p>Code for this example is available here <a href="codes/autocorrelation_graph_tests.R">autocorrelation_graph_tests.R</a></p></li>
<li><p>Stock Vs Gold prices data is available here <a href="datasets/stock_gold.txt">stock_gold.txt</a></p></li>
<li><p>Read data into R and fit simple regression</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"stock_gold.txt"</span>,</span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store data-frame into 2 vectors</span></span>
<span id="cb9-6"><a aria-hidden="true" tabindex="-1"></a>stock.price <span class="ot">&lt;-</span> prices[ , <span class="dv">1</span>]</span>
<span id="cb9-7"><a aria-hidden="true" tabindex="-1"></a>gold.price <span class="ot">&lt;-</span> prices[ , <span class="dv">2</span>]</span>
<span id="cb9-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb9-10"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gold.price <span class="sc">~</span> stock.price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-6" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Time-series plot of residuals</strong>
<ul>
<li>Time series plot suggests some evidence for autocorrelation</li>
<li>Look for successive runs of residuals either side of line <span class="math inline">y = 0 \,</span> (see <span class="math inline">t = 15</span>)</li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 60%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute residuals</span></span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> model<span class="sc">$</span>resid</span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Time-series plot of residuals</span></span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals,</span>
<span id="cb10-6"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time"</span>, </span>
<span id="cb10-7"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb10-8"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb10-9"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb10-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add line y = 0 for reference</span></span>
<span id="cb10-12"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; align-items: center;">
<ul>
<li><strong>Autocorrelation plot of residuals</strong>
<ul>
<li>Want to plot <span class="math inline">e_t</span> against <span class="math inline">e_{t-1}</span></li>
<li>Shift <span class="math inline">e_t</span> by 1 to get <span class="math inline">e_{t-1}</span></li>
<li>Can only plot magenta pairs</li>
<li>We have 1 pair less than number of residuals</li>
</ul></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<p><img data-src="images/shifted_vectors.png" style="width:110.0%"> <img data-src="images/shifted_vectors_2.png" style="width:110.0%"></p>
</div></div>
</section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<ul>
<li>We want to plot <span class="math inline">e_t</span> against <span class="math inline">e_{t-1}</span>
<ul>
<li>Residuals are stored in vector <span class="math inline">\,\, \texttt{residuals}</span></li>
<li>We need to create a shifted version of <span class="math inline">\,\, \texttt{residuals}</span></li>
<li>First compute the length of <span class="math inline">\,\, \texttt{residuals}</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute length of residuals</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
</div>
<ul>
<li>Need to generate the <span class="math inline">33-1</span> pairs for plotting</li>
</ul>
</section>
<section id="section-9" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Lag 0:</strong>
<ul>
<li>This is the original vector with no lag</li>
<li>Lose one observation from <span class="math inline">\,\, \texttt{residuals}</span> – the first observation</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a>residuals.lag<span class="fl">.0</span> <span class="ot">&lt;-</span> residuals[<span class="dv">2</span><span class="sc">:</span><span class="dv">33</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Lag 1:</strong>
<ul>
<li>This is the original vector shifted by 1</li>
<li>Lose one observation from <span class="math inline">\,\, \texttt{residuals}</span> – the last observation</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>residuals.lag<span class="fl">.1</span> <span class="ot">&lt;-</span> residuals[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-10" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Autocorrelation plot of residuals</strong>
<ul>
<li>Plot suggests positive autocorrelation of residuals</li>
<li>This means <span class="math inline">\, e_t \, \approx \, a + b \, e_{t-1} \,</span> with <span class="math inline">b &gt; 0</span></li>
</ul></li>
</ul>
<div class="columns" style="display: flex !important; height: 60%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Lag0 Vs Lag1 residuals</span></span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals.lag<span class="fl">.0</span>, </span>
<span id="cb15-4"><a aria-hidden="true" tabindex="-1"></a>     residuals.lag<span class="fl">.1</span>,</span>
<span id="cb15-5"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Residuals Lag 0"</span>, </span>
<span id="cb15-6"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals Lag 1"</span>,</span>
<span id="cb15-7"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb15-8"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-15-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="statistical-tests-for-autocorrelation" class="slide level2 smaller">
<h2>Statistical tests for Autocorrelation</h2>
<ul>
<li>Runs test
<ul>
<li>Under the classical multiple linear regression model residuals are equally likely to be positive or negative</li>
</ul></li>
<li>Durbin-Watson test
<ul>
<li>Test to see if residuals are AR(1)</li>
</ul></li>
<li>We do not cover these</li>
</ul>
</section>
<section id="what-to-do-in-case-of-autocorrelation" class="slide level2 smaller">
<h2>What to do in case of Autocorrelation?</h2>
<ul>
<li>Consider the simple regression model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta x_i + \varepsilon_i
</span></p>
<ul>
<li>Suppose that autocorrelation occurs</li>
</ul>
<p><span class="math display">
{\rm Cor}(\varepsilon_i, \varepsilon_j ) \neq 0 \quad \text{ for some } \, i \neq j
</span></p>
<ul>
<li>Also suppose that autocorrelation is linear in nature</li>
</ul>
<p><span class="math display">
e_t \, \approx \, a + b \, e_{t-1} \quad \text{ for some } \,\, a , \, b \in \mathbb{R}
</span></p>
<ul>
<li>This was for example the case of <em>Stock prices</em> Vs <em>Gold prices</em></li>
</ul>
</section>
<section id="what-to-do-in-case-of-autocorrelation-1" class="slide level2 smaller">
<h2>What to do in case of Autocorrelation?</h2>
<ul>
<li><p>In this case the simple linear model is not the right thing to consider</p></li>
<li><p>The right thing to do is consider <strong>Autoregressive linear models</strong></p></li>
</ul>
<p><span class="math display">
Y_t = \alpha + \beta x_{t} + \varepsilon_t
</span></p>
<ul>
<li><p>These models couple regression with time-series analysis (ARIMA models)</p></li>
<li><p>Good reference is book by Shumway and Stoffer <span class="citation" data-cites="shumway">[<a href="#/references" role="doc-biblioref" onclick="">3</a>]</span></p></li>
</ul>
</section></section>
<section>
<section id="part-3-multicollinearity" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>Multicollinearity</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="multicollinearity" class="slide level2 smaller">
<h2>Multicollinearity</h2>
<ul>
<li>The general linear regression model is</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \beta_2 z_{i2} + \ldots + \beta_p z_{ip} + \varepsilon_i
</span></p>
<ul>
<li>Consider Assumption 6
<ul>
<li>The design matrix <span class="math inline">Z</span> is such that <span class="math display">
  Z^T Z  \, \text{ is invertible}
  </span></li>
</ul></li>
<li><strong>Multicollinearity:</strong> The violation of Assumption 6</li>
</ul>
<p><span class="math display">
\det(Z^T Z ) \, \approx  \, 0  \, \quad \implies \quad Z^T Z \, \text{ is (almost) not invertible}
</span></p>
</section>
<section id="the-nature-of-multicollinearity" class="slide level2 smaller">
<h2>The nature of Multicollinearity</h2>
<p><span class="math display">
\text{Multicollinearity = multiple (linear) relationships between the Z-variables}
</span></p>
<ul>
<li>Multicollinearity arises when there is either
<ul>
<li><strong>exact</strong> linear relationship amongst the <span class="math inline">Z</span>-variables</li>
<li><strong>approximate</strong> linear relationship amongst the <span class="math inline">Z</span>-variables</li>
</ul></li>
</ul>
<p><br></p>
<p><strong><span class="math inline">Z</span>-variables <em>inter-related</em></strong> <span class="math inline">\quad \implies \quad</span> <strong>hard to isolate individual influence on <span class="math inline">Y</span></strong></p>
</section>
<section id="example-of-multicollinear-data" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p>Perfect collinearity for <span class="math inline">Z_1</span> and <span class="math inline">Z_2</span></p>
<ul>
<li>because of exact linear relation <span class="math display">
  Z_2 = 5 Z_1
  </span></li>
</ul></li>
<li><p>No perfect collinearity for <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span></p></li>
<li><p>But <span class="math inline">Z_3</span> is small perturbation of <span class="math inline">Z_2</span></p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-multicollinear-data-1" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li>Approximate collinearity for <span class="math inline">Z_1, Z_3</span>
<ul>
<li>Correlation between <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span> is almost <span class="math inline">1</span></li>
<li>There is approximate linear relation between <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span> <span class="math display">
  Z_3 \, \approx \, 5 Z_1
  </span></li>
</ul></li>
<li><strong>Both instances qualify as multicollinearity</strong></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-multicollinear-data-2" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the data</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">30</span>)</span>
<span id="cb16-3"><a aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">75</span>, <span class="dv">97</span>, <span class="dv">129</span>, <span class="dv">152</span>)</span>
<span id="cb16-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation</span></span>
<span id="cb16-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Z1, Z3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9958817</code></pre>
</div>
</div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="consequences-of-multicollinearity" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>Therefore multicollinearity means that
<ul>
<li>Predictors <span class="math inline">Z_j</span> are (approximately) linearly dependent</li>
<li>E.g. one can be written as (approximate) linear combination of the others</li>
</ul></li>
<li>Recall that the design matrix is</li>
</ul>
<p><span class="math display">
Z
= (Z_1 | Z_2 | \ldots | Z_p) =
\left(
\begin{array}{cccc}
z_{11}  &amp; z_{12} &amp; \ldots &amp; z_{1p} \\
z_{21}  &amp; z_{22} &amp; \ldots &amp; z_{2p} \\
\ldots  &amp; \ldots &amp; \ldots &amp; \ldots \\
z_{n1}  &amp; z_{n2} &amp; \ldots &amp; z_{np} \\
\end{array}
\right)
</span></p>
<ul>
<li>Note that <span class="math inline">Z</span> has <span class="math inline">p</span> columns</li>
</ul>
</section>
<section id="consequences-of-multicollinearity-1" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>If at least one pair <span class="math inline">Z_i</span> and <span class="math inline">Z_j</span> is collinear (linearly dependent) then</li>
</ul>
<p><span class="math display">
{\rm rank} (Z) &lt; p
</span></p>
<ul>
<li>Basic linear algebra tells us that</li>
</ul>
<p><span class="math display">
{\rm rank} \left(  Z^T Z  \right) = {\rm rank} \left(  Z  \right)
</span></p>
<ul>
<li>Therefore if we have collinearity</li>
</ul>
<p><span class="math display">
{\rm rank} \left(  Z^T Z  \right) &lt; p
\qquad \implies \qquad
Z^T Z \,\, \text{ is NOT invertible}
</span></p>
</section>
<section id="consequences-of-multicollinearity-2" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>In this case the least-squares estimator is not well defined</li>
</ul>
<p><span class="math display">
\hat{\beta} = (Z^T Z)^{-1} Z^T y
</span></p>
<p><strong>Multicollinearity is a big problem!</strong></p>
</section>
<section id="example-of-non-invertible-zt-z" class="slide level2 smaller">
<h2>Example of non-invertible <span class="math inline">Z^T Z</span></h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p><span class="math inline">Z_1, Z_2, Z_3</span> as before</p></li>
<li><p>Exact Multicollinearity since <span class="math display">
Z_2 = 5 Z_1
</span></p></li>
<li><p>Thus <span class="math inline">Z^T Z</span> is not invertible</p></li>
<li><p>Let us check with R</p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-non-invertible-zt-z-1" class="slide level2 smaller">
<h2>Example of non-invertible <span class="math inline">Z^T Z</span></h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the data</span></span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">30</span>)</span>
<span id="cb18-3"><a aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>, <span class="dv">120</span>, <span class="dv">150</span>)</span>
<span id="cb18-4"><a aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">75</span>, <span class="dv">97</span>, <span class="dv">129</span>, <span class="dv">152</span>)</span>
<span id="cb18-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble design matrix</span></span>
<span id="cb18-7"><a aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(Z1, Z2, Z3), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb18-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute determinant of Z^T Z</span></span>
<span id="cb18-10"><a aria-hidden="true" tabindex="-1"></a><span class="fu">det</span> ( <span class="fu">t</span>(Z) <span class="sc">%*%</span> Z )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.531172e-07</code></pre>
</div>
</div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-non-invertible-zt-z-2" class="slide level2 smaller">
<h2>Example of non-invertible <span class="math inline">Z^T Z</span></h2>
<ul>
<li><p>R computed that <span class="math inline">\,\, {\rm det} ( Z^T Z) = -3.531172 \times 10^{-7}</span></p></li>
<li><p>Therefore the determinant of <span class="math inline">Z^T Z</span> is almost <span class="math inline">0</span></p></li>
</ul>
<p><span class="math display">
Z^T Z \text{ is not invertible!}
</span></p>
<ul>
<li>If we try to invert <span class="math inline">Z^T Z</span> in R we get an error</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute inverse of Z^T Z</span></span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span> ( <span class="fu">t</span>(Z) <span class="sc">%*%</span> Z )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="verbatim"><code>
Error in solve.default(t(Z) %*% Z) : 
  system is computationally singular: reciprocal condition number = 8.25801e-19
</code></pre>
</section>
<section id="approximate-multicollinearity" class="slide level2 smaller">
<h2>Approximate Multicollinearity</h2>
<ul>
<li><p>In practice one almost never has exact Multicollinearity</p></li>
<li><p>If Multicollinearity is present, it is likely to be <strong>Approximate Multicollinearity</strong></p></li>
<li><p>In case of approximate Multicollinearity it holds that</p>
<ul>
<li>The matrix <span class="math inline">Z^T Z</span> can be inverted</li>
<li>The estimator <span class="math inline">\hat \beta</span> can be computed <span class="math display">
  \hat \beta = (Z^T Z)^{-1} Z^T y
  </span></li>
<li>However the inversion is <strong>numerically instable</strong></li>
</ul></li>
</ul>
<p><strong>Approximate Multicollinearity is still a big problem!</strong></p>
</section>
<section id="numerical-instability" class="slide level2 smaller">
<h2>Numerical instability</h2>
<ul>
<li>Numerical instability means that:
<ul>
<li><strong>We may not be able to trust the estimator <span class="math inline">\hat \beta</span></strong></li>
</ul></li>
</ul>
<p>This is because of:</p>
<ol type="1">
<li>Larger estimated standard errors
<ul>
<li>Lack of precision associated with parameter estimates</li>
<li>Wider confidence intervals</li>
<li>May affect hypothesis tests</li>
</ul></li>
<li>Correlated parameter estimates
<ul>
<li>Another potential source of errors</li>
<li>Potential numerical problems with computational routines</li>
</ul></li>
</ol>
</section>
<section id="the-effects-of-numerical-instability" class="slide level2 smaller">
<h2>The effects of numerical instability</h2>
<ul>
<li>Approximate Multicollinearity implies that
<ul>
<li><span class="math inline">Z^T Z</span> is invertible</li>
<li>The inversion is numerically instable</li>
</ul></li>
<li>Numerically instable inversion means that</li>
</ul>
<p><span class="math display">
\text{Small perturbations in } Z  \quad \implies \quad \text{large variations in } (Z^T Z)^{-1}
</span></p>
<ul>
<li>Denote by <span class="math inline">\xi_{ij}</span> the entries of <span class="math inline">(Z^T Z)^{-1}</span></li>
</ul>
<p><span class="math display">
\text{Small perturbations in } Z  \quad \implies \quad \text{large variations in } \xi_{ij}
</span></p>
<ul>
<li>This in particular might lead to larger than usual values <span class="math inline">\xi_{ij}</span></li>
</ul>
</section>
<section id="why-are-estimated-standard-errors-larger" class="slide level2 smaller">
<h2>Why are estimated standard errors larger?</h2>
<ul>
<li>Recall formula of estimated standard error for <span class="math inline">\beta_j</span></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}(\beta_j) = \xi_{jj}^{1/2} \, S   \,, \qquad \quad S^2 = \frac{\mathop{\mathrm{RSS}}}{n-p}
</span></p>
<ul>
<li>The numbers <span class="math inline">\xi_{jj}</span> are the diagonal entries of <span class="math inline">(Z^T Z)^{-1}</span></li>
</ul>
<p><span class="math display">\begin{align*}
\text{Multicollinearity} &amp; \quad \implies \quad \text{Numerical instability} \\[5pts]
&amp; \quad \implies \quad \text{potentially larger } \xi_{jj} \\[5pts]
&amp; \quad \implies \quad \text{potentially larger } \mathop{\mathrm{e.s.e.}}(\beta_j)
\end{align*}</span></p>
<ul>
<li><strong>It becomes harder to reject incorrect hypotheses</strong></li>
</ul>
</section>
<section id="effect-of-multicollinearity-on-t-tests" class="slide level2 smaller">
<h2>Effect of Multicollinearity on t-tests</h2>
<ul>
<li>To test the null hypothesis that <span class="math inline">\beta_j = 0</span> we use <span class="math inline">t</span>-statistic</li>
</ul>
<p><span class="math display">
t = \frac{\beta_j}{ \mathop{\mathrm{e.s.e.}}(\beta_j) }
</span></p>
<ul>
<li><p>But Multicollinearity increases the <span class="math inline">\mathop{\mathrm{e.s.e.}}(\beta_j)</span></p></li>
<li><p>Therefore the t-statistic reduces in size:</p>
<ul>
<li>t-statistic will be smaller than it should</li>
<li>The p-values will be large <span class="math inline">p &gt; 0.05</span></li>
</ul></li>
</ul>
<p><strong>It becomes harder to reject incorrect hypotheses!</strong></p>
</section>
<section id="example-of-numerical-instability" class="slide level2 smaller">
<h2>Example of numerical instability</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p><span class="math inline">Z_1, Z_2, Z_3</span> as before</p></li>
<li><p>We know we have exact Multicollinearity, since <span class="math display">
Z_2 = 5 Z_1
</span></p></li>
<li><p>Therefore <span class="math inline">Z^T Z</span> is not invertible</p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-numerical-instability-1" class="slide level2 smaller">
<h2>Example of numerical instability</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p>To get rid of Multicollinearity we can add a small perturbation to <span class="math inline">Z_1</span> <span class="math display">
Z_1 \,\, \leadsto \,\, Z_1 + 0.01
</span></p></li>
<li><p>The new dataset <span class="math inline">Z_1 + 0.01, Z_2, Z_3</span> is</p>
<ul>
<li>Not anymore exactly Multicollinear</li>
<li>Still approximately Multicollinear</li>
</ul></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="example-of-numerical-instability-2" class="slide level2 smaller">
<h2>Example of numerical instability</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p>Define the new design matrix <span class="math display">
Z = (Z_1 + 0.01 | Z_2 | Z_3)
</span></p></li>
<li><p>Data is approximately Multicollinear</p></li>
<li><p>Therefore the inverse of <span class="math inline">Z^T Z</span> exists</p></li>
<li><p>Let us compute this inverse in R</p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table class="caption-top">
<thead>
<tr class="header">
<th><span class="math inline">Z_1 + 0.01</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10.01</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15.01</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18.01</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24.01</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30.01</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="section-11" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<ul>
<li>Let us compute the inverse of</li>
</ul>
<p><span class="math display">
Z = (Z_1 + 0.01 | Z_2 | Z_3)
</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Consider perturbation Z1 + 0.01</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>PZ1 <span class="ot">&lt;-</span> Z1 <span class="sc">+</span> <span class="fl">0.01</span></span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble perturbed design matrix</span></span>
<span id="cb22-5"><a aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(PZ1, Z2, Z3), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb22-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of Z^T Z</span></span>
<span id="cb22-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span> ( <span class="fu">t</span>(Z) <span class="sc">%*%</span> Z )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]          [,2]       [,3]
[1,] 17786.804216 -3556.4700048 -2.4186075
[2,] -3556.470005   711.1358432  0.4644159
[3,]    -2.418608     0.4644159  0.0187805</code></pre>
</div>
</div>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li>In particular note that the first coefficient is <span class="math inline">\,\, \xi_{11} \, \approx \, 17786</span></li>
</ul>
</div>
</section>
<section id="section-12" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<ul>
<li>Let us change the perturbation slightly:</li>
</ul>
<p><span class="math display">
\text{ consider } \, Z_1 + 0.02 \,  \text{ instead of } \, Z_1 + 0.01
</span></p>
<ul>
<li>Invert the new design matrix <span class="math inline">\,\, Z = (Z_1 + 0.02 | Z_2 | Z_3)</span></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Consider perturbation Z1 + 0.02</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a>PZ1 <span class="ot">&lt;-</span> Z1 <span class="sc">+</span> <span class="fl">0.02</span></span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble perturbed design matrix</span></span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(PZ1, Z2, Z3), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of Z^T Z</span></span>
<span id="cb24-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span> ( <span class="fu">t</span>(Z) <span class="sc">%*%</span> Z )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]         [,2]       [,3]
[1,] 4446.701047 -888.8947902 -1.2093038
[2,] -888.894790  177.7098841  0.2225551
[3,]   -1.209304    0.2225551  0.0187805</code></pre>
</div>
</div>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li>In particular note that the first coefficient is <span class="math inline">\,\, \xi_{11} \, \approx \, 4446</span></li>
</ul>
</div>
</section>
<section id="section-13" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Summary:</strong>
<ul>
<li>If we perturb the vector <span class="math inline">Z_1</span> by <span class="math inline">0.01</span> the first coefficient of <span class="math inline">Z^T Z</span> is <span class="math display">
  \xi_{11} \, \approx \, 17786
  </span></li>
<li>If we perturb the vector <span class="math inline">Z_1</span> by <span class="math inline">0.02</span> the first coefficient of <span class="math inline">Z^T Z</span> is <span class="math display">
  \xi_{11} \, \approx \, 4446
  </span></li>
</ul></li>
</ul>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<ul>
<li>Note that the average entry in <span class="math inline">Z_1</span> is</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Z1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.4</code></pre>
</div>
</div>
</section>
<section id="section-14" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Therefore the average percentage change in the data is</li>
</ul>
<p><span class="math display">\begin{align*}
\text{Percentage Change} &amp; = \left( \frac{\text{New Value} - \text{Old Value}}{\text{Old Value}} \right) \times 100\% \\[15pts]
                         &amp; = \left(  \frac{(19.4 + 0.02) - (19.4 + 0.01)}{19.4 + 0.01}   \right)  \times 100 \% \ \approx  \ 0.05 \%
\end{align*}</span></p>
<ul>
<li>The percentage change in the coefficients <span class="math inline">\xi_{11}</span> is</li>
</ul>
<p><span class="math display">
\text{Percentage Change in } \, \xi_{11} = \frac{4446 - 17786}{17786} \times 100 \% \ \approx \ −75 \%
</span></p>
</section>
<section id="section-15" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Conclusion:</strong> We have shown that</li>
</ul>
<p><span class="math display">
\text{perturbation of } \, 0.05 \%  \, \text{ in the data } \quad \implies \quad
\text{change of } \, - 75 \%  \, \text{ in } \, \xi_{11}
</span></p>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<ul>
<li>This is precisely <strong>numerical instability</strong></li>
</ul>
<p><span class="math display">
\text{Small perturbations in } Z  \quad \implies \quad \text{large variations in } (Z^T Z)^{-1}
</span></p>
</section>
<section id="sources-of-multicollinearity" class="slide level2 smaller">
<h2>Sources of Multicollinearity</h2>
<ul>
<li>Multicollinearity is a problem
<ul>
<li>When are we likely to encounter it?</li>
</ul></li>
<li>Possible sources of Multicollinearity are</li>
</ul>
<ol type="1">
<li><strong>The data collection method employed</strong>
<ul>
<li>Sampling over a limited range of values taken by the regressors in the population</li>
</ul></li>
<li><strong>Constraints on the model or population</strong>
<ul>
<li>E.g. variables such as income and house size may be interrelated</li>
</ul></li>
<li><strong>Model Specification</strong>
<ul>
<li>E.g. adding polynomial terms to a model when range of <span class="math inline">X</span>-variables is small</li>
</ul></li>
</ol>
</section>
<section id="sources-of-multicollinearity-1" class="slide level2 smaller">
<h2>Sources of Multicollinearity</h2>
<ol start="4" type="1">
<li><strong>An over-determined model</strong>
<ul>
<li>Having too many <span class="math inline">X</span> variables compared to the number of observations</li>
</ul></li>
<li><strong>Common trends</strong>
<ul>
<li>E.g. variables such as consumption, income, wealth, etc may be correlated due to a dependence upon general economic trends and cycles</li>
</ul></li>
</ol>
<p><strong>Often can <em>know</em> in advance when you might experience Multicollinearity</strong></p>
</section>
<section id="how-to-detect-multicollinearity-in-practice" class="slide level2 smaller">
<h2>How to detect Multicollinearity in practice?</h2>
<h3 id="most-important-sign">Most important sign</h3>
<ul>
<li>In practical problems look for something that <em>does not look quite right</em></li>
</ul>
<div id="Important*-7.1" class="Important">
<p></p><details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div><strong>High <span class="math inline">R^2</span> values coupled with small t-values</strong><p></p>
</div></details>
</div>
<ul>
<li><p><strong>This is a big sign of potential Multicollinearity</strong></p></li>
<li><p><strong>Why is this contradictory?</strong></p>
<ul>
<li>High <span class="math inline">R^2</span> suggests model is good and explains a lot of the variation in <span class="math inline">Y</span></li>
<li>But if individual <span class="math inline">t</span>-statistics are small, this suggests <span class="math inline">\beta_j = 0</span></li>
<li>Hence individual <span class="math inline">X</span>-variables do not affect <span class="math inline">Y</span></li>
</ul></li>
</ul>
</section>
<section id="how-to-detect-multicollinearity-in-practice-1" class="slide level2 smaller">
<h2>How to detect Multicollinearity in practice?</h2>
<h3 class="smaller" id="other-signs-of-multicollinearity">Other signs of Multicollinearity</h3>
<p><strong>Numerical instabilities:</strong></p>
<ul>
<li><p>Parameter estimates <span class="math inline">\hat \beta_j</span> become very sensitive to small changes in the data</p></li>
<li><p>The <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> become very sensitive to small changes in the data</p></li>
<li><p>Parameter estimates <span class="math inline">\hat \beta_j</span> <em>take the wrong sign</em> or otherwise <em>look strange</em></p></li>
<li><p>Parameter estimates may be highly correlated</p></li>
</ul>
</section>
<section id="example-of-multicollinearity" class="slide level2 smaller">
<h2>Example of Multicollinearity</h2>
<ul>
<li><p>Consider the following illustrative example</p></li>
<li><p>Want to explain expenditure <span class="math inline">Y</span> in terms of</p>
<ul>
<li>income <span class="math inline">X_2</span></li>
<li>wealth <span class="math inline">X_3</span></li>
</ul></li>
<li><p>It is intuitively clear that <em>income</em> and <em>wealth</em> are highly correlated</p></li>
</ul>
<div id="Important*-7.2" class="Important">
<details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div>
<p><strong>To detect Multicollinearity look out for</strong></p>
<ul>
<li>High <span class="math inline">R^2</span> value</li>
<li>coupled with low t-values</li>
</ul>
</div></details>
</div>
</section>
<section id="example-dataset" class="slide level2 smaller">
<h2>Example dataset</h2>
<div style="font-size: 0.90em">
<table class="caption-top">
<thead>
<tr class="header">
<th>Expenditure <span class="math inline">Y</span></th>
<th>Income <span class="math inline">X_2</span></th>
<th>Wealth <span class="math inline">X_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>70</td>
<td>80</td>
<td>810</td>
</tr>
<tr class="even">
<td>65</td>
<td>100</td>
<td>1009</td>
</tr>
<tr class="odd">
<td>90</td>
<td>120</td>
<td>1273</td>
</tr>
<tr class="even">
<td>95</td>
<td>140</td>
<td>1425</td>
</tr>
<tr class="odd">
<td>110</td>
<td>160</td>
<td>1633</td>
</tr>
<tr class="even">
<td>115</td>
<td>180</td>
<td>1876</td>
</tr>
<tr class="odd">
<td>120</td>
<td>200</td>
<td>2052</td>
</tr>
<tr class="even">
<td>140</td>
<td>220</td>
<td>2201</td>
</tr>
<tr class="odd">
<td>155</td>
<td>240</td>
<td>2435</td>
</tr>
<tr class="even">
<td>150</td>
<td>260</td>
<td>2686</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="fit-the-regression-model-in-r" class="slide level2 smaller">
<h2>Fit the regression model in R</h2>
<ul>
<li>Code for this example is available here <a href="codes/multicollinearity.R">multicollinearity.R</a></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter data</span></span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">110</span>, <span class="dv">115</span>, <span class="dv">120</span>, <span class="dv">140</span>, <span class="dv">155</span>, <span class="dv">150</span>)</span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">140</span>, <span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>, <span class="dv">220</span>, <span class="dv">240</span>, <span class="dv">260</span>)</span>
<span id="cb28-4"><a aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">810</span>, <span class="dv">1009</span>, <span class="dv">1273</span>, <span class="dv">1425</span>, <span class="dv">1633</span>, <span class="dv">1876</span>, <span class="dv">2052</span>, <span class="dv">2201</span>, <span class="dv">2435</span>, <span class="dv">2686</span>)</span>
<span id="cb28-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb28-7"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3)</span>
<span id="cb28-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># We want to display only part of summary</span></span>
<span id="cb28-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># First capture the output into a vector</span></span>
<span id="cb28-11"><a aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">summary</span>(model))</span>
<span id="cb28-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Then print only the lines of interest</span></span>
<span id="cb28-14"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(temp[<span class="dv">9</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-16" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 24.77473    6.75250   3.669  0.00798 **
x2           0.94154    0.82290   1.144  0.29016   
x3          -0.04243    0.08066  -0.526  0.61509   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.808 on 7 degrees of freedom
Multiple R-squared:  0.9635,    Adjusted R-squared:  0.9531 
F-statistic:  92.4 on 2 and 7 DF,  p-value: 9.286e-06</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Three basic statistics</strong></p>
<ul>
<li><span class="math inline">R^2</span> coefficient</li>
<li>t-statistics and related p-values</li>
<li>F-statistic and related p-value</li>
</ul>
</section>
<section id="interpreting-the-r-output" class="slide level2 smaller">
<h2>Interpreting the R output</h2>
<ol type="1">
<li><span class="math inline">R^2 = 0.9635</span>
<ul>
<li>Model explains a substantial amount of the variation (96.35%) in the data</li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li>F-statistic is
<ul>
<li><span class="math inline">F = 92.40196</span></li>
<li>Corresponding p-value is <span class="math inline">p = 9.286 \times 10^{-6}</span></li>
<li>There is evidence <span class="math inline">p&lt;0.05</span> that at least one between <em>income</em> and <em>wealth</em> affect expenditure</li>
</ul></li>
</ol>
</section>
<section id="interpreting-the-r-output-1" class="slide level2 smaller">
<h2>Interpreting the R output</h2>
<ol start="3" type="1">
<li>t-statistics
<ul>
<li>t-statistics for <em>income</em> is <span class="math inline">t = 1.144</span></li>
<li>Corresponding p-value is <span class="math inline">p = 0.29016</span></li>
<li>t-statistic for <em>wealth</em> is <span class="math inline">t = -0.526</span></li>
<li>Corresponding p-value is <span class="math inline">p = 0.61509</span></li>
<li>Both p-values are <span class="math inline">p &gt; 0.05</span></li>
<li>Therefore neither <em>income</em> nor <em>wealth</em> are individually statistically significant</li>
<li>This means regression parameters are <span class="math inline">\beta_2 = \beta_3 = 0</span></li>
</ul></li>
</ol>
<p><strong>Main red flag for Multicollinearity:</strong></p>
<ul>
<li>High <span class="math inline">R^2</span> value coupled with low t-values (corresponding to high p-values)</li>
</ul>
</section>
<section id="the-output-looks-strange" class="slide level2 smaller">
<h2>The output looks strange</h2>
<h3 id="there-are-many-contradictions">There are many contradictions</h3>
<ol type="1">
<li><p>High <span class="math inline">R^2</span> value suggests model is really good</p></li>
<li><p>However low t-values imply neither <em>income</em> nor <em>wealth</em> affect <em>expenditure</em></p></li>
<li><p>F-statistic is high, meaning that at least one between <em>income</em> nor <em>wealth</em> affect <em>expenditure</em></p></li>
<li><p>The <em>wealth</em> variable has the <em>wrong sign</em> (<span class="math inline">\hat \beta_3 &lt; 0</span>)</p>
<ul>
<li>This makes no sense: it is likely that <em>expenditure</em> will increase as <em>wealth</em> increases</li>
<li>Therefore we would expect <span class="math inline">\, \hat \beta_3 &gt; 0</span></li>
</ul></li>
</ol>
<p><strong>Multicollinearity is definitely present!</strong></p>
</section>
<section id="detection-of-multicollinearity" class="slide level2 smaller">
<h2>Detection of Multicollinearity</h2>
<h3 id="computing-the-correlation">Computing the correlation</h3>
<ul>
<li>For further confirmation of Multicollinearity compute correlation of <span class="math inline">X_2</span> and <span class="math inline">X_3</span></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x2, x3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9989624</code></pre>
</div>
</div>
<ul>
<li>Correlation is almost 1: Variables <span class="math inline">X_2</span> and <span class="math inline">X_3</span> are very highly correlated</li>
</ul>
<p><strong>This once again confirms Multicollinearity is present</strong></p>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<p><strong>Conclusion:</strong> The variables <em>Income</em> and <em>Wealth</em> are highly correlated</p>
<ul>
<li>Impossible to isolate individual impact of either <em>Income</em> or <em>Wealth</em> upon <em>Expenditure</em></li>
</ul>
</section>
<section id="detection-of-multicollinearity-1" class="slide level2 smaller">
<h2>Detection of Multicollinearity</h2>
<h3 id="kleins-rule-of-thumb">Klein’s rule of thumb</h3>
<p><strong>Klein’s rule of thumb:</strong> Multicollinearity will be a serious problem if:</p>
<ul>
<li>The <span class="math inline">R^2</span> obtained from regressing predictor variables <span class="math inline">X</span> is greater than the overall <span class="math inline">R^2</span> obtained by regressing <span class="math inline">Y</span> against all the <span class="math inline">X</span> variables</li>
</ul>
<p><strong>Example:</strong> In the <em>Expenditure</em> vs <em>Income</em> and <em>Wealth</em> dataset we have</p>
<ul>
<li><p>Regressing <span class="math inline">Y</span> against <span class="math inline">X_2</span> and <span class="math inline">X_3</span> gives <span class="math inline">R^2=0.9635</span></p></li>
<li><p>Regressing <span class="math inline">X_2</span> against <span class="math inline">X_3</span> gives <span class="math inline">R^2 = 0.9979</span></p></li>
</ul>
<p><strong>Klein’s rule of thumb suggests that Multicollinearity will be a serious problem</strong></p>
</section>
<section id="remedial-measures" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="do-nothing">Do nothing</h3>
<ul>
<li><p>Multicollinearity is essentially a <strong>data-deficiency problem</strong></p></li>
<li><p>Sometimes we have no control over the dataset available</p></li>
<li><p>Important point:</p>
<ul>
<li>Doing nothing should only be an option in quantitative social sciences (e.g.&nbsp;finance, economics) where data is often difficult to collect</li>
<li>For scientific experiments (e.g.&nbsp;physics, chemistry) one should strive to collect good data</li>
</ul></li>
</ul>
</section>
<section id="remedial-measures-1" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="acquire-newmore-data">Acquire new/more data</h3>
<ul>
<li><p><strong>Multicollinearity is a sample feature</strong></p></li>
<li><p>Possible that another sample involving the same variables will have less Multicollinearity</p></li>
<li><p>Acquiring more data might reduce severity of Multicollinearity</p></li>
<li><p>More data can be collected by either</p>
<ul>
<li>increasing the sample size or</li>
<li>including additional variables</li>
</ul></li>
</ul>
</section>
<section id="remedial-measures-2" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="use-prior-information-about-some-parameters">Use prior information about some parameters</h3>
<ul>
<li><p>To do this properly would require advanced Bayesian statistical methods</p></li>
<li><p>This is beyond the scope of this module</p></li>
</ul>
</section>
<section id="remedial-measures-3" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="rethinking-the-model">Rethinking the model</h3>
<ul>
<li>Sometimes a model chosen for empirical analysis is not carefully thought out
<ul>
<li>Some important variables may be omitted</li>
<li>The functional form of the model may have been incorrectly chosen</li>
</ul></li>
<li>Sometimes using more advanced statistical techniques may be required
<ul>
<li>Factor Analysis</li>
<li>Principal Components Analysis</li>
<li>Ridge Regression</li>
</ul></li>
<li>Above techniques are outside the scope of this module</li>
</ul>
</section>
<section id="remedial-measures-4" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="transformation-of-variables">Transformation of variables</h3>
<ul>
<li><p>Multicollinearity may be reduced by transforming variables</p></li>
<li><p>This may be possible in various different ways</p>
<ul>
<li>E.g. for time-series data one might consider forming a new model by taking first differences</li>
</ul></li>
<li><p>Further reading in Chapter 10 of <span class="citation" data-cites="gujarati_porter">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span></p></li>
</ul>
</section>
<section id="remedial-measures-5" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="dropping-variables">Dropping variables</h3>
<ul>
<li><p>Simplest approach to tackle Multicollinearity is to drop one or more of the collinear variables</p></li>
<li><p>Goal: Find the best combination of <span class="math inline">X</span> variables which reduces Multicollinearity</p></li>
<li><p>We present 2 alternatives</p>
<ol type="i">
<li>Dropping variables <em>by hand</em></li>
<li>Dropping variables using <strong>Stepwise regression</strong></li>
</ol></li>
</ul>
</section>
<section id="example-dropping-variables-by-hand" class="slide level2 smaller">
<h2>Example: Dropping variables by hand</h2>
<ul>
<li><p>Consider again the <em>Expenditure</em> vs <em>Income</em> and <em>Wealth</em> dataset</p></li>
<li><p>The variables <em>Income</em> and <em>Wealth</em> are highly correlated</p></li>
<li><p>Intuitively we expect both <em>Income</em> and <em>Wealth</em> to affect <em>Expenditure</em></p></li>
<li><p>Solution can be to drop either <em>Income</em> or <em>Wealth</em> variables</p>
<ul>
<li>We can then fit 2 separate models</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit expenditure as function of income</span></span>
<span id="cb32-2"><a aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2)</span>
<span id="cb32-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit expenditure as function of wealth</span></span>
<span id="cb32-5"><a aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x3)</span>
<span id="cb32-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.1</span>)</span>
<span id="cb32-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="expenditure-vs-income" class="slide level2 smaller">
<h2>Expenditure Vs Income</h2>
<div style="font-size: 0.90em">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 24.45455    6.41382   3.813  0.00514 ** 
x2           0.50909    0.03574  14.243 5.75e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.493 on 8 degrees of freedom
Multiple R-squared:  0.9621,    Adjusted R-squared:  0.9573 
F-statistic: 202.9 on 1 and 8 DF,  p-value: 5.753e-07</code></pre>
</div>
</div>
</div>
<p><br></p>
<div style="font-size: 0.93em">
<ul>
<li><span class="math inline">R^ 2 = 0.9621</span> which is quite high</li>
<li>p-value for <span class="math inline">\beta_2</span> is <span class="math inline">p = 9.8 \times 10^{-7} &lt; 0.5 \quad \implies \quad</span> <em>Income</em> variable is significant</li>
<li>Estimate is <span class="math inline">\hat \beta_2 = 0.50909 &gt; 0</span></li>
</ul>
<p><strong>Strong evidence that <em>Expenditure</em> increases as <em>Income</em> increases</strong></p>
</div>
</section>
<section id="expenditure-vs-wealth" class="slide level2 smaller">
<h2>Expenditure Vs Wealth</h2>
<div style="font-size: 0.90em">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 24.411045   6.874097   3.551   0.0075 ** 
x3           0.049764   0.003744  13.292  9.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.938 on 8 degrees of freedom
Multiple R-squared:  0.9567,    Adjusted R-squared:  0.9513 
F-statistic: 176.7 on 1 and 8 DF,  p-value: 9.802e-07</code></pre>
</div>
</div>
</div>
<p><br></p>
<div style="font-size: 0.93em">
<ul>
<li><span class="math inline">R^ 2 = 0.9567</span> which is quite high</li>
<li>p-value for <span class="math inline">\beta_2</span> is <span class="math inline">p = 9.8 \times 10^{-7} &lt; 0.5 \quad \implies \quad</span> <em>Wealth</em> variable is significant</li>
<li>Estimate is <span class="math inline">\hat \beta_2 = 0.049764 &gt; 0</span></li>
</ul>
<p><strong>Strong evidence that <em>Expenditure</em> increases as <em>Wealth</em> increases</strong></p>
</div>
</section>
<section id="example-conclusion" class="slide level2 smaller">
<h2>Example: Conclusion</h2>
<ul>
<li>We considered the simpler models
<ul>
<li><em>Expenditure</em> vs <em>Income</em></li>
<li><em>Expenditure</em> vs <em>Wealth</em></li>
</ul></li>
<li>Both models perform really well
<ul>
<li><em>Expenditure</em> increases as either <em>Income</em> or <em>Wealth</em> increase</li>
</ul></li>
<li>Multicollinearity effects disappeared after dropping either variable!</li>
</ul>
</section>
<section id="stepwise-regression" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li><p>Stepwise regression: Method of comparing regression models</p></li>
<li><p>Involves iterative selection of predictor variables <span class="math inline">X</span> to use in the model</p></li>
<li><p>It can be achieved through</p>
<ul>
<li>Forward selection</li>
<li>Backward selection</li>
<li>Stepwise selection: Combination of Forward and Backward selection</li>
</ul></li>
</ul>
</section>
<section id="stepwise-regression-methods" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol type="1">
<li><strong>Forward Selection</strong>
<ul>
<li>Start with the <strong>null model</strong> with only intercept <span class="math display">
Y = \beta_1 + \varepsilon
</span></li>
<li>Add each variable <span class="math inline">X_j</span> incrementally, testing for significance</li>
<li>Stop when no more variables are statistically significant</li>
</ul></li>
</ol>
<p><strong>Note:</strong> Significance criterion for <span class="math inline">X_j</span> is in terms of <strong>AIC</strong></p>
<ul>
<li>AIC is a measure of how well a model fits the data</li>
<li>AIC is an alternative to the coefficient of determination <span class="math inline">R^2</span></li>
<li>We will give details about AIC later</li>
</ul>
</section>
<section id="stepwise-regression-methods-1" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol start="2" type="1">
<li><strong>Backward Selection</strong>
<ul>
<li>Start with the <strong>full model</strong> <span class="math display">
Y = \beta_1 + \beta_2 X_{2}+ \ldots+\beta_p X_{p}+ \varepsilon
</span></li>
<li>Delete <span class="math inline">X_j</span> variables which are not significant</li>
<li>Stop when all the remaining variables are significant</li>
</ul></li>
</ol>
</section>
<section id="stepwise-regression-methods-2" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol start="3" type="1">
<li><strong>Stepwise Selection</strong>
<ul>
<li>Start with the <strong>null model</strong> <span class="math display">
Y = \beta_1 + \varepsilon
</span></li>
<li>Add each variable <span class="math inline">X_j</span> incrementally, testing for significance</li>
<li>Each time a new variable <span class="math inline">X_j</span> is added, perform a Backward Selection step</li>
<li>Stop when all the remaining variables are significant</li>
</ul></li>
</ol>
<p><strong>Note:</strong> Stepwise Selection ensures that at each step all the variables are significant</p>
</section>
<section id="stepwise-regression-in-r" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>Suppose given
<ul>
<li>a data vector <span class="math inline">\, \texttt{y}</span></li>
<li>predictors data <span class="math inline">\, \texttt{x2}, \texttt{x3}, \ldots, \texttt{xp}</span></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Begin by fitting the null and full regression models</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null model</span></span>
<span id="cb35-2"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb35-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the full model</span></span>
<span id="cb35-5"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> ... <span class="sc">+</span> xp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-1" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>There are 2 basic differences depending on whether you are doing
<ul>
<li>Forward selection or Stepwise selection: Start with <strong>null model</strong></li>
<li>Backward selection: Start with <strong>full model</strong></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>The command for <em>Stepwise selection</em> is</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection</span></span>
<span id="cb36-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb36-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb36-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-2" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>The command for <em>Forward selection</em> is</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection</span></span>
<span id="cb37-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb37-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb37-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The command for <em>Backward selection</em> is</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Backward selection</span></span>
<span id="cb38-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, </span>
<span id="cb38-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-3" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>The model selected by <em>Stepwise regression</em> is saved in
<ul>
<li><span class="math inline">\texttt{best.model}</span></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>To check which model is best, just print the summary and read first 2 lines</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-longley-dataset" class="slide level2 smaller">
<h2>Example: Longley dataset</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      GNP Unemployed Armed.Forces Population Year Employed
1 234.289      235.6        159.0    107.608 1947   60.323
2 259.426      232.5        145.6    108.632 1948   61.122
3 258.054      368.2        161.6    109.773 1949   60.171</code></pre>
</div>
</div>
<p><strong>Goal:</strong> Explain the number of <em>Employed</em> people <span class="math inline">Y</span> in the US in terms of</p>
<ul>
<li><span class="math inline">X_2</span> <em>GNP</em> Gross National Product</li>
<li><span class="math inline">X_3</span> number of <em>Unemployed</em></li>
<li><span class="math inline">X_4</span> number of people in the <em>Armed Forces</em></li>
<li><span class="math inline">X_5</span> <em>non-institutionalised Population</em> <span class="math inline">\geq</span> age 14 (not in care of insitutions)</li>
<li><span class="math inline">X_6</span> <em>Years</em> from 1947 to 1962</li>
</ul>
</section>
<section id="reading-in-the-data" class="slide level2 smaller">
<h2>Reading in the data</h2>
<ul>
<li><p>Code for this example is available here <a href="codes/longley_stepwise.R">longley_stepwise.R</a></p></li>
<li><p>Longley dataset available here <a href="datasets/longley.txt">longley.txt</a></p></li>
<li><p>Download the data file and place it in current working directory</p></li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Read data file</span></span>
<span id="cb41-2"><a aria-hidden="true" tabindex="-1"></a>longley <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"longley.txt"</span>,</span>
<span id="cb41-3"><a aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store columns in vectors</span></span>
<span id="cb41-6"><a aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> longley[ , <span class="dv">1</span>]</span>
<span id="cb41-7"><a aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> longley[ , <span class="dv">2</span>]</span>
<span id="cb41-8"><a aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> longley[ , <span class="dv">3</span>]</span>
<span id="cb41-9"><a aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> longley[ , <span class="dv">4</span>]</span>
<span id="cb41-10"><a aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> longley[ , <span class="dv">5</span>]</span>
<span id="cb41-11"><a aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> longley[ , <span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="detecting-multicollinearity" class="slide level2 smaller">
<h2>Detecting Multicollinearity</h2>
<ul>
<li>Fit the multiple regression model including all predictors</li>
</ul>
<p><span class="math display">
Y = \beta_1 + \beta_2 \, X_2 + \beta_3 \, X_3 + \beta_4 \, X_4 + \beta_5 \, X_5
    + \beta_6 \, X_6 + \varepsilon
</span></p>
<p><br></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb42-2"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span>
<span id="cb42-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb42-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-17" class="slide level2 smaller">
<h2></h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_4.png" style="width:72.0%"></p>
</div></div>
<div style="font-size: 0.9em">
<ul>
<li>Fitting the full model gives
<ul>
<li>High <span class="math inline">R^2</span> value</li>
<li>Low <span class="math inline">t</span>-values (and high p-values) for <span class="math inline">X_2</span> and <span class="math inline">X_5</span></li>
</ul></li>
<li>These are signs that we might have a problem with Multicollinearity</li>
</ul>
</div>
</section>
<section id="section-18" class="slide level2 smaller">
<h2></h2>
<ul>
<li>To further confirm Multicollinearity we can look at the correlation matrix
<ul>
<li>We can use function <span class="math inline">\, \texttt{cor}</span> directly on first 5 columns of data-frame <span class="math inline">\,\texttt{longley}</span></li>
<li>We look only at correlations larger than <span class="math inline">0.9</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Return correlations larger than 0.9</span></span>
<span id="cb43-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(longley[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">&gt;</span> <span class="fl">0.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               GNP Unemployed Armed.Forces Population  Year
GNP           TRUE      FALSE        FALSE       TRUE  TRUE
Unemployed   FALSE       TRUE        FALSE      FALSE FALSE
Armed.Forces FALSE      FALSE         TRUE      FALSE FALSE
Population    TRUE      FALSE        FALSE       TRUE  TRUE
Year          TRUE      FALSE        FALSE       TRUE  TRUE</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>Hence the following pairs are highly correlated (correlation <span class="math inline">\, &gt; 0.9</span>) <span class="math display">
X_2 \,\, \text{and} \,\, X_5 \qquad \quad
X_2 \,\, \text{and} \,\, X_6 \qquad \quad
X_4 \,\, \text{and} \,\, X_6
</span></li>
</ul>
</section>
<section id="applying-stepwise-regression" class="slide level2 smaller">
<h2>Applying Stepwise regression</h2>
<ul>
<li><strong>Goal:</strong> Want to find best variables which, at the same time
<ul>
<li>Explain <em>Employment</em> variable <span class="math inline">Y</span></li>
<li>Reduce Multicollinearity</li>
</ul></li>
<li><strong>Method:</strong> We use <em>Stepwise regression</em></li>
</ul>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li>Start by by fitting the null and full regression models</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null model</span></span>
<span id="cb45-2"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb45-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the full model</span></span>
<span id="cb45-5"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="applying-stepwise-regression-1" class="slide level2 smaller">
<h2>Applying Stepwise regression</h2>
<ul>
<li>Perform Stepwise regression by
<ul>
<li>Forward selection, Backward selection, Stepwise selection</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection</span></span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb46-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb46-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span>
<span id="cb46-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Backward selection</span></span>
<span id="cb46-7"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, </span>
<span id="cb46-8"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"backward"</span>)</span>
<span id="cb46-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection</span></span>
<span id="cb46-11"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb46-12"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"both"</span>,</span>
<span id="cb46-13"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="applying-stepwise-regression-2" class="slide level2 smaller">
<h2>Applying Stepwise regression</h2>
<ul>
<li>Models obtained by Stepwise regression are stored in
<ul>
<li><span class="math inline">\texttt{best.model.1}, \,\, \texttt{best.model.3}, \,\,\texttt{best.model.3}</span></li>
</ul></li>
</ul>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li>Print the summary for each model obtained</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of each model</span></span>
<span id="cb47-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li><strong>Output:</strong> The 3 methods all yield the same model</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb48-1"><a aria-hidden="true" tabindex="-1"></a>Call:</span>
<span id="cb48-2"><a aria-hidden="true" tabindex="-1"></a>lm(formula = y ~ x2 + x3 + x4 + x6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="interpretation" class="slide level2 smaller">
<h2>Interpretation</h2>
<div style="font-size: 0.93em">
<ul>
<li>All three Stepwise regression methods agree and select a model with the variables
<ul>
<li><span class="math inline">X_2</span>, <span class="math inline">X_3</span>, <span class="math inline">X_4</span> and <span class="math inline">X_6</span></li>
<li><span class="math inline">X_5</span> is excluded</li>
</ul></li>
<li>Explanation: Multicollinearity and inter-relationships between the <span class="math inline">X</span>-variables mean that there is some redundancy
<ul>
<li>the <span class="math inline">X_5</span> variable is not needed in the model</li>
</ul></li>
<li>This means that the number <em>Employed</em> just depends on
<ul>
<li><span class="math inline">X_2</span> <em>GNP</em></li>
<li><span class="math inline">X_3</span> Number of <em>Unemployed</em> people</li>
<li><span class="math inline">X_4</span> Number of people in the <em>Armed Forces</em></li>
<li><span class="math inline">X_6</span> Time in <em>Years</em></li>
</ul></li>
</ul>
</div>
</section>
<section id="re-fitting-the-model-without-x_5" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li>Coefficient of determination is still very high: <span class="math inline">R^2 = 0.9954</span></li>
<li>All the variables <span class="math inline">X_2, X_3,X_4,X_6</span> are significant (high t-values)</li>
<li>This means Multicollinearity effects have disappeared</li>
</ul>
</section>
<section id="re-fitting-the-model-without-x_5-1" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li>The coefficient of <span class="math inline">X_2</span> is negative and statistically significant
<ul>
<li>As <em>GNP</em> increases the number <em>Employed</em> decreases</li>
</ul></li>
</ul>
</section>
<section id="re-fitting-the-model-without-x_5-2" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li>The coefficient of <span class="math inline">X_3</span> is negative and statistically significant
<ul>
<li>As the number of <em>Unemployed</em> increases the number <em>Employed</em> decreases</li>
</ul></li>
</ul>
</section>
<section id="re-fitting-the-model-without-x_5-3" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li>The coefficient of <span class="math inline">X_4</span> is negative and statistically significant
<ul>
<li>As the number of <em>Armed Forces</em> increases the number <em>Employed</em> decreases</li>
</ul></li>
</ul>
</section>
<section id="re-fitting-the-model-without-x_5-4" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li>The coefficient of <span class="math inline">X_6</span> is positive and statistically significant
<ul>
<li>the number <em>Employed</em> is generally increasing over <em>Time</em></li>
</ul></li>
</ul>
</section>
<section id="re-fitting-the-model-without-x_5-5" class="slide level2 smaller">
<h2>Re-fitting the model without <span class="math inline">X_5</span></h2>
<div style="font-size: 0.8em">
<pre class="verbatim"><code>Call:
lm(formula = y ~ x2 + x3 + x4 + x6)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.599e+03  7.406e+02  -4.859 0.000503 ***
x2          -4.019e-02  1.647e-02  -2.440 0.032833 *  
x3          -2.088e-02  2.900e-03  -7.202 1.75e-05 ***
x4          -1.015e-02  1.837e-03  -5.522 0.000180 ***
x6           1.887e+00  3.828e-01   4.931 0.000449 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2794 on 11 degrees of freedom
Multiple R-squared:  0.9954,    Adjusted R-squared:  0.9937 
F-statistic: 589.8 on 4 and 11 DF,  p-value: 9.5e-13

</code></pre>
</div>
<ul>
<li><strong>Apparent contradiction:</strong> The interpretation for <span class="math inline">X_2</span> appears contradictory
<ul>
<li>We would expect that as <em>GNP</em> increases the number of <em>Employed</em> increases</li>
<li>This is not the case because the effect of <span class="math inline">X_2</span> is dwarfed by the general increase in <em>Employment</em> over <em>Time</em> (<span class="math inline">X_6</span> has large coefficient)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="part-4-stepwise-regression-and-overfitting" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>Stepwise regression <br> and overfitting</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="on-the-coefficient-of-determination-r2" class="slide level2 smaller">
<h2>On the coefficient of determination <span class="math inline">R^2</span></h2>
<ul>
<li>Recall the formula for the <span class="math inline">R^2</span> coefficient of determination</li>
</ul>
<p><span class="math display">
R^2 = 1 - \frac{\mathop{\mathrm{RSS}}}{\mathop{\mathrm{TSS}}}
</span></p>
<ul>
<li>We used <span class="math inline">R^2</span> to measure how well a regression model fits the data
<ul>
<li>Large <span class="math inline">R^2</span> implies good fit</li>
<li>Small <span class="math inline">R^2</span> implies bad fit</li>
</ul></li>
</ul>
</section>
<section id="revisiting-the-galileo-example" class="slide level2 smaller">
<h2>Revisiting the Galileo example</h2>
<p><strong>Drawback:</strong> <span class="math inline">R^2</span> increases when number of predictors increases</p>
<ul>
<li><p>We saw this phenomenon in the <strong>Galileo</strong> example in Lecture 10</p></li>
<li><p>Fitting the model <span class="math display">
  \rm{distance} = \beta_1 + \beta_2 \, \rm{height}  + \varepsilon
</span> yielded <span class="math inline">R^2 = 0.9264</span></p></li>
<li><p>In contrast the quadratic, cubic, and quartic models yielded, respectively <span class="math display">
R^2 = 0.9903 \,, \qquad R^2 = 0.9994 \,, \qquad
R^2 = 0.9998
</span></p></li>
<li><p>Fitting a higher degree polynomial gives higher <span class="math inline">R^2</span></p></li>
</ul>
</section>
<section id="section-19" class="slide level2 smaller">
<h2></h2>
<p><strong>Conclusion:</strong> If the degree of the polynomial is sufficiently high, we will get <span class="math inline">R^2 = 1</span></p>
<ul>
<li>Indeed, there always exist a polynomial passing exactly through the data points</li>
</ul>
<p><span class="math display">
(\rm{height}_1, \rm{distance}_1) \,, \ldots , (\rm{height}_n, \rm{distance}_n)
</span></p>
<ul>
<li>For such polynomial model the predictions match the data perfectly</li>
</ul>
<p><span class="math display">
\hat y_i = y_i \,, \qquad \forall \,\, i = 1 , \ldots, n
</span></p>
<ul>
<li>Therefore we have</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}= \sum_{i=1}^n (y_i - \hat y_i )^2 = 0 \qquad \implies
\qquad R^2 = 1
</span></p>
</section>
<section id="overfitting-the-model" class="slide level2 smaller">
<h2>Overfitting the model</h2>
<p><strong>Warning:</strong> Adding increasingly higher number of parameters is not good</p>
<ul>
<li>It leads to a phenomenon called <strong>overfitting</strong>
<ul>
<li>The model fits the data very well</li>
<li>However the model does not make good predictions on unseen data</li>
</ul></li>
<li>We encountered this phenomenon in the <strong>Divorces</strong> example of Lecture 10</li>
</ul>
</section>
<section id="revisiting-the-divorces-example" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<p><br></p>
<ul>
<li><p>The best model seems to be Linear <span class="math display">
y = \beta_1 + \beta_2 x + \varepsilon
</span></p></li>
<li><p>Linear model interpretation:</p>
<ul>
<li>The risk of divorce is decreasing in time</li>
<li>The risk peak in year 2 is explained by unusually low risk in year 1</li>
</ul></li>
</ul>
</div><div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb55-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb55-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb55-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb55-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb55-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb55-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb55-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb55-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb55-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb55-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb55-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb55-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb55-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb55-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb55-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb55-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb55-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb55-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb55-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb55-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb55-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb55-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb55-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-28-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="revisiting-the-divorces-example-1" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<p><br></p>
<ul>
<li>Fitting <em>Order 6</em> polynomial yields better results
<ul>
<li>The coefficient <span class="math inline">R^2</span> decreases (of course!)</li>
<li>F-test for model comparison prefers <em>Order 6</em> model to the linear one</li>
</ul></li>
<li>Statistically <em>Order 6</em> model is better than <em>Linear</em> model</li>
</ul>
</div><div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb56-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb56-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb56-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb56-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb56-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb56-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb56-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb56-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb56-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb56-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb56-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb56-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb56-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb56-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb56-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb56-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb56-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb56-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb56-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb56-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb56-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb56-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb56-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="revisiting-the-divorces-example-2" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<ul>
<li>However, looking at the plot:
<ul>
<li><em>Order 6</em> model introduces unnatural spike at 27 years</li>
<li>This is a sign of <em>overfitting</em></li>
</ul></li>
<li>Question:
<ul>
<li><span class="math inline">R^2</span> coefficient and F-test are in favor of <em>Order 6</em> model</li>
<li>How do we rule out the <em>Order 6</em> model?</li>
</ul></li>
<li>Answer: We need a new measure for comparing regression models</li>
</ul>
</div><div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb57-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb57-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb57-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb57-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb57-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb57-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb57-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb57-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb57-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb57-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb57-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb57-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb57-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb57-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb57-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb57-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb57-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb57-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb57-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb57-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb57-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb57-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb57-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-30-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="akaike-information-criterion-aic" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li><p>The AIC is a number which measures how well a regression model fits the data</p></li>
<li><p>Also <span class="math inline">R^2</span> measures how well a regression model fits the data</p></li>
<li><p>The difference between AIC and <span class="math inline">R^2</span> is that AIC also <strong>accounts for overfitting</strong></p></li>
<li><p>The formal definition of AIC is</p></li>
</ul>
<p><span class="math display">
{\rm AIC} := 2p - 2 \log ( \hat{L} )
</span></p>
<ul>
<li><p><span class="math inline">p =</span> number of parameters in the model</p></li>
<li><p><span class="math inline">\hat{L} =</span> maximum value of the likelihood function</p></li>
</ul>
</section>
<section id="akaike-information-criterion-aic-1" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li>In past lectures we have shown that for the general regression model</li>
</ul>
<p><span class="math display">
\ln(\hat L)=
-\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\hat\sigma^2) - \frac{1}{2\hat\sigma^2} \mathop{\mathrm{RSS}}\,, \qquad \hat \sigma^2 := \frac{\mathop{\mathrm{RSS}}}{n}
</span></p>
<ul>
<li>Therefore</li>
</ul>
<p><span class="math display">
\ln(\hat L)= - \frac{n}{2}  \log \left( \frac{\mathop{\mathrm{RSS}}}{n}  \right) + C
</span></p>
<ul>
<li><p><span class="math inline">C</span> is constant depending only on the number of sample points</p></li>
<li><p>Thus <span class="math inline">C</span> does not change if the data does not change</p></li>
</ul>
</section>
<section id="akaike-information-criterion-aic-2" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li>We obtain the following equivalent formula for AIC</li>
</ul>
<p><span class="math display">
{\rm AIC} = 2p + n \log \left( \frac{ \mathop{\mathrm{RSS}}}{n} \right) - 2C
</span></p>
<ul>
<li>We now see that AIC accounts for
<ul>
<li><strong>Data fit:</strong> since the data fit term <span class="math inline">\mathop{\mathrm{RSS}}</span> is present</li>
<li><strong>Model complexity:</strong> Since the number of degrees of freedom <span class="math inline">p</span> is present</li>
</ul></li>
<li>Therefore a model with low AIC is such that:
<ol type="1">
<li>Model fits data well</li>
<li>Model is not too complex, preventing overfitting</li>
</ol></li>
<li>Conclusion: sometimes AIC is better than <span class="math inline">R^2</span> when comparing two models</li>
</ul>
</section>
<section id="stepwise-regression-and-aic" class="slide level2 smaller">
<h2>Stepwise regression and AIC</h2>
<ul>
<li><em>Stepwise regression</em> function in R uses AIC to compare models
<ul>
<li>the model with <strong>lowest AIC</strong> is selected</li>
</ul></li>
<li>Hence Stepwise regression outputs the model which, at the same time
<ol type="1">
<li>Best fits the given data</li>
<li>Prevents overfitting</li>
</ol></li>
<li><strong>Example:</strong> Apply Stepwise regression to <strong>divorces</strong> examples to compare
<ul>
<li>Linear model</li>
<li>Order 6 model</li>
</ul></li>
</ul>
</section>
<section id="example-divorces" class="slide level2 smaller">
<h2>Example: Divorces</h2>
<h3 id="the-dataset">The dataset</h3>
<ul>
<li>Code for this example is available here <a href="codes/divorces_stepwise.R">divorces_stepwise.R</a></li>
</ul>
<p><br></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Years of Marriage</strong></th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
<th style="text-align: left;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>% divorces adultery</strong></td>
<td style="text-align: left;">3.51</td>
<td style="text-align: left;">9.50</td>
<td style="text-align: left;">8.91</td>
<td style="text-align: left;">9.35</td>
<td style="text-align: left;">8.18</td>
<td style="text-align: left;">6.43</td>
<td style="text-align: left;">5.31</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Years of Marriage</strong></th>
<th style="text-align: left;">8</th>
<th style="text-align: left;">9</th>
<th style="text-align: left;">10</th>
<th style="text-align: left;">15</th>
<th style="text-align: left;">20</th>
<th style="text-align: left;">25</th>
<th style="text-align: left;">30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>% divorces adultery</strong></td>
<td style="text-align: left;">5.07</td>
<td style="text-align: left;">3.65</td>
<td style="text-align: left;">3.80</td>
<td style="text-align: left;">2.83</td>
<td style="text-align: left;">1.51</td>
<td style="text-align: left;">1.27</td>
<td style="text-align: left;">0.49</td>
</tr>
</tbody>
</table>
</section>
<section id="fitting-the-null-model" class="slide level2 smaller">
<h2>Fitting the null model</h2>
<ul>
<li>First we import the data into R</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb58-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb58-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb58-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The null model is</li>
</ul>
<p><span class="math display">
{\rm percent} = \beta_1 + \varepsilon
</span></p>
<ul>
<li>Fit the null model with</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fitting-the-full-model" class="slide level2 smaller">
<h2>Fitting the full model</h2>
<ul>
<li>The full model is the <em>Order 6</em> model</li>
</ul>
<p><span class="math display">
\rm{percent} = \beta_1 + \beta_2 \, {\rm year} +
\beta_3 \, {\rm year}^2 + \ldots + \beta_7 \, {\rm year}^6
</span></p>
<ul>
<li>Fit the full model with</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb60-2"><a aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb60-3"><a aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-1" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li>We run stepwise regression and save the best model</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb61-2"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb61-3"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(full.model)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The best model is <em>Linear</em>, and not <em>Order 6</em>!</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="verbatim"><code>
Call:
lm(formula = percent ~ year)

.....
</code></pre>
</section>
<section id="conclusions" class="slide level2 smaller">
<h2>Conclusions</h2>
<ul>
<li>Old conclusions:
<ul>
<li><em>Linear model</em> has lower <span class="math inline">R^2</span> than <em>Order 6 model</em></li>
<li>F-test for model selection chooses <em>Order 6 model</em> over <em>Linear model</em></li>
<li>Hence <em>Order 6 model</em> seems better than <em>Linear model</em></li>
</ul></li>
<li>New conclusions:
<ul>
<li><em>Order 6 model</em> is more complex than the <em>Linear model</em></li>
<li>In particular <em>Order 6 model</em> has higher AIC than the <em>Linear model</em></li>
<li>Stepwise regression chooses <em>Linear model</em> over <em>Order 6 model</em></li>
</ul></li>
<li><strong>Bottom line:</strong> The new findings are in line with our intuition:
<ul>
<li><em>Order 6</em> model overfits</li>
<li>Therefore the <em>Linear model</em> should be preferred</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="part-5-dummy-variable-regression-models" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br>Dummy variable <br> regression models</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<ol type="1">
<li>Dummy variable regression</li>
<li>Factors in R</li>
<li>ANOVA models</li>
<li>ANOVA F-test and regression</li>
<li>Two-way ANOVA</li>
<li>Two-way ANOVA with interactions</li>
<li>ANCOVA</li>
</ol>
</section></section>
<section>
<section id="part-1-dummy-variable-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Dummy variable <br> regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="explaining-the-terminology" class="slide level2 smaller">
<h2>Explaining the terminology</h2>
<ul>
<li><p><strong>Dummy variable:</strong> Variables <span class="math inline">X</span> which are quantitative in nature</p></li>
<li><p><strong>ANOVA:</strong> refers to situations where regression models contain</p>
<ul>
<li><strong>only</strong> dummy variables <span class="math inline">X</span></li>
</ul></li>
<li><p><strong>ANCOVA:</strong> refers to situations where regression models contain a combination of</p>
<ul>
<li>dummy variables <strong>and</strong> quantitative (the usual) variables</li>
</ul></li>
</ul>
</section>
<section id="dummy-variables" class="slide level2 smaller">
<h2>Dummy variables</h2>
<ul>
<li><p><strong>Dummy variable:</strong></p>
<ul>
<li>A variable <span class="math inline">X</span> which is qualitative in nature</li>
<li>Often called <strong>cathegorical variables</strong></li>
</ul></li>
<li><p>Regression models can include dummy variables</p></li>
<li><p>Qualitatitve <strong>binary</strong> variables can be represented by <span class="math inline">X</span> with</p>
<ul>
<li><span class="math inline">X = 1 \,</span> if effect present</li>
<li><span class="math inline">X = 0 \,</span> if effect not present</li>
</ul></li>
<li><p>Examples of <strong>binary</strong> quantitative variables are</p>
<ul>
<li>On / Off</li>
<li>Yes / No</li>
<li>Sample is from Population A / B</li>
</ul></li>
</ul>
</section>
<section id="dummy-variables-1" class="slide level2 smaller">
<h2>Dummy variables</h2>
<ul>
<li>Dummy variables can also take several values
<ul>
<li>These values are often called <strong>levels</strong></li>
<li>Such variables are represented by <span class="math inline">X</span> taking discrete values</li>
</ul></li>
<li>Examples of dummy variables with several levels
<ul>
<li>Season: Summer, Autumn, Winter, Spring</li>
<li>Sex: Male, Female, Non-binary, …</li>
<li>Priority: Low, Medium, High</li>
<li>Quarterly sales data: Q1, Q2, Q3, Q4</li>
<li>UK regions: East Midlands, London Essex, North East/Yorkshire, …</li>
</ul></li>
</ul>
</section>
<section id="example-fridge-sales-data" class="slide level2 smaller">
<h2>Example: Fridge sales data</h2>
<div style="font-size: 0.90em">
<ul>
<li>Consider the dataset on quarterly fridge sales <a href="datasets/fridge_sales.txt">fridge_sales.txt</a>
<ul>
<li>Each entry represents sales data for 1 quarter</li>
<li>4 consecutive entries represent sales data for 1 year</li>
</ul></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   fridge.sales durable.goods.sales Q1 Q2 Q3 Q4 Quarter
1          1317               252.6  1  0  0  0       1
2          1615               272.4  0  1  0  0       2
3          1662               270.9  0  0  1  0       3
4          1295               273.9  0  0  0  1       4
5          1271               268.9  1  0  0  0       1
6          1555               262.9  0  1  0  0       2
7          1639               270.9  0  0  1  0       3
8          1238               263.4  0  0  0  1       4
9          1277               260.6  1  0  0  0       1
10         1258               231.9  0  1  0  0       2
11         1417               242.7  0  0  1  0       3
12         1185               248.6  0  0  0  1       4
13         1196               258.7  1  0  0  0       1
14         1410               248.4  0  1  0  0       2
15         1417               255.5  0  0  1  0       3
16          919               240.4  0  0  0  1       4
17          943               247.7  1  0  0  0       1
18         1175               249.1  0  1  0  0       2
19         1269               251.8  0  0  1  0       3
20          973               262.0  0  0  0  1       4
21         1102               263.3  1  0  0  0       1
22         1344               280.0  0  1  0  0       2
23         1641               288.5  0  0  1  0       3
24         1225               300.5  0  0  0  1       4
25         1429               312.6  1  0  0  0       1
26         1699               322.5  0  1  0  0       2
27         1749               324.3  0  0  1  0       3
28         1117               333.1  0  0  0  1       4
29         1242               344.8  1  0  0  0       1
30         1684               350.3  0  1  0  0       2
31         1764               369.1  0  0  1  0       3
32         1328               356.4  0  0  0  1       4</code></pre>
</div>
</div>
</div>
</section>
<section id="section-20" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.90em">
<ul>
<li>Below are the first 4 entries of the <em>Fridge sales dataset</em>
<ul>
<li>These correspond to 1 year of sales data</li>
</ul></li>
<li>First two variables are quantitative
<ul>
<li><em>Fridge Sales</em> <span class="math inline">=</span> total quarterly fridge sales (in million $)</li>
<li><em>Duarable Goods Sales</em> <span class="math inline">=</span> total quarterly durable goods sales (in billion $)</li>
</ul></li>
<li>Remaining variables are qualitative:
<ul>
<li><em>Q1</em>, <em>Q2</em>, <em>Q3</em>, <em>Q4</em> <span class="math inline">\,</span> take values 0 / 1 <span class="math inline">\quad</span> (representing 4 yearly quarters)</li>
<li><em>Quarter</em> <span class="math inline">\,</span> takes values 1 / 2 / 3 / 4 <span class="math inline">\quad</span> (equivalent representation of quarters)</li>
</ul></li>
</ul>
<div style="font-size: 0.40em">
<p><br></p>
</div>
<table class="caption-top">
<thead>
<tr class="header">
<th>Fridge Sales</th>
<th>Durable Goods Sales</th>
<th>Q1</th>
<th>Q2</th>
<th>Q3</th>
<th>Q4</th>
<th>Quarter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1317</td>
<td>252.6</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1615</td>
<td>272.4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td>1662</td>
<td>270.9</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td>1295</td>
<td>273.9</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="encoding-quarter-in-regression-model" class="slide level2 smaller">
<h2>Encoding Quarter in regression model</h2>
<p><strong>Two alternative approaches:</strong></p>
<ol type="1">
<li>Include <span class="math inline">4-1 = 3</span> dummy variables with values 0 / 1
<ul>
<li>Each dummy variable represents 1 Quarter</li>
<li>We need 3 variables to represent 4 Quarters (if we include intercept)</li>
</ul></li>
<li>Include one variable which takes values 1 / 2 / 3 / 4</li>
</ol>
<p><strong>Differences between the two approaches:</strong></p>
<ol type="1">
<li><p>This method is good to first understand dummy variable regression</p></li>
<li><p>This is the most efficient way of organising cathegorical data in R</p>
<ul>
<li>usese the command <span class="math inline">\, \texttt{factor}</span></li>
</ul></li>
</ol>
</section>
<section id="the-dummy-variable-trap" class="slide level2 smaller">
<h2>The dummy variable trap</h2>
<ul>
<li>Suppose you follow the first approach:
<ul>
<li>Encode each quarter with a separate variable</li>
</ul></li>
<li>If you have 4 different levels you would need
<ul>
<li><span class="math inline">4-1=3</span> dummy variables</li>
<li>the intercept term</li>
</ul></li>
<li>In general: if you have <span class="math inline">m</span> different levels you would need
<ul>
<li><span class="math inline">m-1</span> dummy variables</li>
<li>the intercept term</li>
</ul></li>
</ul>
<p><strong>Question:</strong> Why only <span class="math inline">m - 1</span> dummy variables?</p>
<p><strong>Answer:</strong> To avoid the <strong>dummy variable trap</strong></p>
</section>
<section id="example-dummy-variable-trap" class="slide level2 smaller">
<h2>Example: Dummy variable trap</h2>
<p>To illustrate the dummy variable trap consider the following</p>
<ul>
<li>Encode each Quarter with one dummy variable <span class="math inline">D_i</span></li>
</ul>
<p><span class="math display">
D_i = \begin{cases}
1 &amp; \text{ if data belongs to Quarter i} \\
0 &amp; \text{ otherwise} \\
\end{cases}
</span></p>
<ul>
<li>Consider the regression model with intercept</li>
</ul>
<p><span class="math display">
Y = \beta_0 \cdot (1) + \beta_1 D_1 + \beta_2 D_2 + \beta_3 D_3 + \beta_4 D_4   + \varepsilon
</span></p>
<ul>
<li>In the above <span class="math inline">Y</span> is the quartely <em>Fridge sales data</em></li>
</ul>
</section>
<section id="section-21" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Each data entry belongs to exactly one Quarter, so that</li>
</ul>
<p><span class="math display">
D_1 + D_2 + D_3 + D_4 = 1
</span></p>
<ul>
<li><p><strong>Dummy variable trap:</strong> Variables are collinear (linearly dependent)</p></li>
<li><p>Indeed the design matrix is</p></li>
</ul>
<p><span class="math display">
Z =
\left(
\begin{array}{ccccc}
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
\end{array}
\right)
</span></p>
<ul>
<li>First column is the sum of remaining columns <span class="math inline">\quad \implies \quad</span> Multicollinearity</li>
</ul>
</section>
<section id="example-avoiding-dummy-variable-trap" class="slide level2 smaller">
<h2>Example: Avoiding dummy variable trap</h2>
<ul>
<li><p>We want to avoid Multicollinearity (or dummy variable trap)</p></li>
<li><p><strong>How?</strong> Drop one dummy variable (e.g.&nbsp;the first) and consider the model</p></li>
</ul>
<p><span class="math display">
Y = \beta_1 \cdot (1) + \beta_2 D_2 + \beta_3 D_3 + \beta_4 D_4  + \varepsilon
</span></p>
<ul>
<li><p>If data belongs to Q1 then <span class="math inline">D_2 = D_3 = D_4 = 0</span></p></li>
<li><p>Therefore, in general, we have</p></li>
</ul>
<p><span class="math display">
D_2 + D_3 + D_4 \not\equiv 1
</span></p>
<ul>
<li>This way we <strong>avoid</strong> Multicollinearity <span class="math inline">\quad \implies \quad</span> <strong>no trap!</strong></li>
</ul>
</section>
<section id="section-22" class="slide level2 smaller">
<h2></h2>
<ul>
<li><strong>Question:</strong> How do we interpret the coefficients in the model</li>
</ul>
<p><span class="math display">
Y = \beta_1 \cdot (1)  + \beta_2 D_2 + \beta_3 D_3 + \beta_4 D_4  + \varepsilon\qquad ?
</span></p>
<ul>
<li><strong>Answer:</strong> Recall the relationship</li>
</ul>
<p><span class="math display">
D_1 + D_2 + D_3 + D_4 = 1
</span></p>
<ul>
<li>Substituting in the regression model we get</li>
</ul>
<p><span class="math display">\begin{align*}
Y &amp; = \beta_1 \cdot ( D_1 + D_2 + D_3 + D_4 ) + \beta_2 D_2 + \beta_3 D_3 + \beta_4 D_4  + \varepsilon\\[10pts]
&amp; = \beta_1 D_1 + (\beta_1 + \beta_2) D_2 + (\beta_1 + \beta_3) D_3 + (\beta_1 + \beta_4 ) D_4 + \varepsilon
\end{align*}</span></p>
</section>
<section id="section-23" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Therefore the regression coefficients are such that
<ul>
<li><span class="math inline">\beta_1</span> describes increase for <span class="math inline">D_1</span></li>
<li><span class="math inline">\beta_1 + \beta_2</span> describes increase for <span class="math inline">D_2</span></li>
<li><span class="math inline">\beta_1 + \beta_3</span> describes increase for <span class="math inline">D_3</span></li>
<li><span class="math inline">\beta_1 + \beta_4</span> describes increase for <span class="math inline">D_4</span></li>
</ul></li>
</ul>
<p><strong>Conclusion:</strong> When fitting regression model with dummy variables</p>
<ul>
<li><p>Increase for first dummy variable <span class="math inline">D_1</span> is intercept term <span class="math inline">\beta_1</span></p></li>
<li><p>Increase for successive dummy variables <span class="math inline">D_i</span> with <span class="math inline">i &gt; 1</span> is computed by <span class="math inline">\beta_1 + \beta_i</span></p></li>
</ul>
<p><strong>Intercept coefficient acts as base reference point</strong></p>
</section>
<section id="general-case-dummy-variable-trap" class="slide level2 smaller">
<h2>General case: Dummy variable trap</h2>
<ul>
<li>Suppose to have a qualitative <span class="math inline">X</span> variable which takes <span class="math inline">m</span> different levels
<ul>
<li>E.g. the previous example has <span class="math inline">m = 4</span> quarters</li>
</ul></li>
<li>Encode each level of <span class="math inline">X</span> in one dummy variable <span class="math inline">D_i</span></li>
</ul>
<p><span class="math display">
D_i = \begin{cases}
1 &amp; \text{ if X has level i} \\
0 &amp; \text{ otherwise} \\
\end{cases}
</span></p>
<ul>
<li>To each data entry corresponds one and only one level of <span class="math inline">X</span>, so that</li>
</ul>
<p><span class="math display">
D_1 + D_2 + \ldots + D_m = 1
</span></p>
<ul>
<li>Hence <strong>Multicollinearity</strong> if intercept is present <span class="math inline">\, \implies \,</span> <strong>Dummy variable trap!</strong></li>
</ul>
</section>
<section id="general-case-avoid-the-trap" class="slide level2 smaller">
<h2>General case: Avoid the trap!</h2>
<ul>
<li>We drop the first dummy variable <span class="math inline">D_1</span> and consider the model</li>
</ul>
<p><span class="math display">
Y = \beta_1 \cdot (1)  + \beta_2 D_2 + \beta_3 D_3 + \ldots + \beta_m D_m  + \varepsilon
</span></p>
<ul>
<li>For data points such that <span class="math inline">X = 1</span> we have</li>
</ul>
<p><span class="math display">
D_2 = D_3 = \ldots = D_m = 0
</span></p>
<ul>
<li>Therefore, in general, we get</li>
</ul>
<p><span class="math display">
D_2 + D_3 + \ldots + D_m \not \equiv 1
</span></p>
<ul>
<li>This way we avoid Multicollinearity <span class="math inline">\quad \implies \quad</span> <strong>no trap!</strong></li>
</ul>
</section>
<section id="general-case-interpret-the-output" class="slide level2 smaller">
<h2>General case: Interpret the output</h2>
<ul>
<li>How to interpret the coefficients in the model</li>
</ul>
<p><span class="math display">
Y = \beta_1 \cdot (1)  + \beta_2 D_2 + \beta_3 D_3 + \ldots + \beta_m D_m  + \varepsilon\quad ?
</span></p>
<ul>
<li>We can argue similarly to the case <span class="math inline">m = 4</span> and use the constraint</li>
</ul>
<p><span class="math display">
D_1 + D_2 + \ldots + D_m = 1
</span></p>
<ul>
<li>Substituting in the regression model we get</li>
</ul>
<p><span class="math display">
Y = \beta_1 D_1 + (\beta_1 + \beta_2) D_2 + \ldots + (\beta_1 + \beta_m) D_m + \varepsilon
</span></p>
</section>
<section id="section-24" class="slide level2 smaller">
<h2></h2>
<p><strong>Conclusion:</strong> When fitting regression model with dummy variables</p>
<ul>
<li><p>Increase for first dummy variable <span class="math inline">D_1</span> is intercept term <span class="math inline">\beta_1</span></p></li>
<li><p>Increase for successive dummy variables <span class="math inline">D_i</span> with <span class="math inline">i &gt; 1</span> is computed by <span class="math inline">\beta_1 + \beta_i</span></p></li>
</ul>
<p><strong>Intercept coefficient acts as base reference point</strong></p>
</section></section>
<section>
<section id="part-2-factors-in-r" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Factors in R</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="factors-in-r" class="slide level2 smaller">
<h2>Factors in R</h2>
<ul>
<li><p>Before proceeding we need to introduce <strong>factors</strong> in R</p></li>
<li><p><strong>Factors:</strong> A way to represent discrete variables taking a finite number of values</p></li>
<li><p><strong>Example:</strong> Suppose to have a vector of people’s names</p></li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" tabindex="-1"></a>firstname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Liz"</span>, <span class="st">"Jolene"</span>, <span class="st">"Susan"</span>, <span class="st">"Boris"</span>, <span class="st">"Rochelle"</span>, <span class="st">"Tim"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Let us store the sex of each person as either
<ul>
<li>Numbers: <span class="math inline">\, \texttt{1}</span> represents female and <span class="math inline">\texttt{0}</span> represents male</li>
<li>Strings: <span class="math inline">\, \texttt{"female"}</span> and <span class="math inline">\texttt{"male"}</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a aria-hidden="true" tabindex="-1"></a>sex.num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb66-2"><a aria-hidden="true" tabindex="-1"></a>sex.char <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-factor-command" class="slide level2 smaller">
<h2>The factor command</h2>
<ul>
<li>The <span class="math inline">\, \texttt{factor}</span> command turns a vector into a factor</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Turn sex.num into a factor</span></span>
<span id="cb67-2"><a aria-hidden="true" tabindex="-1"></a>sex.num.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(sex.num)</span>
<span id="cb67-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print the factor obtained</span></span>
<span id="cb67-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sex.num.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 0 1 0
Levels: 0 1</code></pre>
</div>
</div>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li><p>The factor <span class="math inline">\, \texttt{sex.num.factor}</span> looks like the original vector <span class="math inline">\, \texttt{sex.num}</span></p></li>
<li><p>The difference is that the factor <span class="math inline">\, \texttt{sex.num.factor}</span> contains <strong>levels</strong></p>
<ul>
<li>In this case the levels are <span class="math inline">\, \texttt{0}</span> and <span class="math inline">\, \texttt{1}</span></li>
<li>Levels are all the (discrete) values assumed by the vector <span class="math inline">\, \texttt{sex.num}</span></li>
</ul></li>
</ul>
</section>
<section id="the-factor-command-1" class="slide level2 smaller">
<h2>The factor command</h2>
<ul>
<li>In the same way we can convert <span class="math inline">\, \texttt{sex.char}</span> into a factor</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Turn sex.char into a factor</span></span>
<span id="cb69-2"><a aria-hidden="true" tabindex="-1"></a>sex.char.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(sex.char)</span>
<span id="cb69-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print the factor obtained</span></span>
<span id="cb69-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sex.char.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] female female female male   female male  
Levels: female male</code></pre>
</div>
</div>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li><p>Again, the factor <span class="math inline">\, \texttt{sex.char.factor}</span> looks like the original vector <span class="math inline">\, \texttt{sex.char}</span></p></li>
<li><p>Again, the difference is that the factor <span class="math inline">\, \texttt{sex.char.factor}</span> contains <strong>levels</strong></p>
<ul>
<li>In this case the levels are strings <span class="math inline">\, \texttt{"female"}</span> and <span class="math inline">\, \texttt{"male"}</span></li>
<li>These 2 strings are all the values assumed by the vector <span class="math inline">\, \texttt{sex.char}</span></li>
</ul></li>
</ul>
</section>
<section id="subsetting-factors" class="slide level2 smaller">
<h2>Subsetting factors</h2>
<ul>
<li>Factors can be subset exactly like vectors</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a aria-hidden="true" tabindex="-1"></a>sex.num.factor[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 0 1
Levels: 0 1</code></pre>
</div>
</div>
</section>
<section id="subsetting-factors-1" class="slide level2 smaller">
<h2>Subsetting factors</h2>
<ul>
<li><strong>Warning:</strong> After subsetting a factor, all defined levels are still stored
<ul>
<li>This is true even if some of the levels are no longer represented in the subsetted factor</li>
</ul></li>
</ul>
<div style="font-size: 0.30em">
<p><br></p>
</div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a aria-hidden="true" tabindex="-1"></a>subset.factor <span class="ot">&lt;-</span> sex.char.factor[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>)]</span>
<span id="cb73-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(subset.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] female female female female
Levels: female male</code></pre>
</div>
</div>
<div style="font-size: 0.30em">
<p><br></p>
</div>
<ul>
<li><p>The levels of <span class="math inline">\, \texttt{subset.factor}</span> are still <span class="math inline">\, \texttt{"female"}</span> and <span class="math inline">\, \texttt{"male"}</span></p></li>
<li><p>This is despite <span class="math inline">\, \texttt{subset.factor}</span> only containing <span class="math inline">\, \texttt{"female"}</span></p></li>
</ul>
</section>
<section id="the-levels-function" class="slide level2 smaller">
<h2>The levels function</h2>
<ul>
<li>The levels of a factor can be extracted with the function <span class="math inline">\, \texttt{levels}</span></li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex.char.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0" "1"</code></pre>
</div>
</div>
<div style="font-size: 0.30em">
<p><br></p>
</div>
<ul>
<li><strong>Note:</strong> Levels of a factor are always stored as <strong>strings</strong>, even if originally numbers</li>
</ul>
<div style="font-size: 0.10em">
<p><br></p>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex.num.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0" "1"</code></pre>
</div>
</div>
<div style="font-size: 0.10em">
<p><br></p>
</div>
<ul>
<li><p>The levels of <span class="math inline">\, \texttt{sex.num.factor}</span> are the strings <span class="math inline">\, \texttt{"0"}</span> and <span class="math inline">\, \texttt{"1"}</span></p></li>
<li><p>This is despite the original vector <span class="math inline">\, \texttt{sex.num}</span> being numeric</p></li>
<li><p>The command <span class="math inline">\, \texttt{factor}</span> converted numeric levels into strings</p></li>
</ul>
</section>
<section id="relabelling-a-factor" class="slide level2 smaller">
<h2>Relabelling a factor</h2>
<ul>
<li><p>The function <span class="math inline">\, \texttt{levels}</span> can also be used to <strong>relabel</strong> factors</p></li>
<li><p>For example we can relabel</p>
<ul>
<li><span class="math inline">\, \texttt{female}</span> into <span class="math inline">\, \texttt{f}</span></li>
<li><span class="math inline">\, \texttt{male}</span> into <span class="math inline">\, \texttt{m}</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Relabel levels of sex.char.factor</span></span>
<span id="cb79-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex.char.factor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"f"</span>, <span class="st">"m"</span>)</span>
<span id="cb79-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print relabelled factor</span></span>
<span id="cb79-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sex.char.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] f f f m f m
Levels: f m</code></pre>
</div>
</div>
</section>
<section id="logical-subsetting-of-factors" class="slide level2 smaller">
<h2>Logical subsetting of factors</h2>
<ul>
<li><p>Logical subsetting is done exactly like in the case of vectors</p></li>
<li><p><strong>Important:</strong> Need to remember that levels are always <strong>strings</strong></p></li>
<li><p><strong>Example:</strong> To identify all the men in <span class="math inline">\, \texttt{sex.num.factor}</span> we do</p></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a aria-hidden="true" tabindex="-1"></a>sex.num.factor <span class="sc">==</span> <span class="st">"0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li>To retrieve names of men stored in <span class="math inline">\, \texttt{firstname}</span> use logical subsetting</li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a aria-hidden="true" tabindex="-1"></a>firstname[ sex.num.factor <span class="sc">==</span> <span class="st">"0"</span> ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Boris" "Tim"  </code></pre>
</div>
</div>
</section></section>
<section>
<section id="part-3-anova-models" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br> ANOVA models</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="analysis-of-variance-anova-models-in-r" class="slide level2 smaller">
<h2>Analysis of variance (ANOVA) models in R</h2>
<ul>
<li>The data in <a href="datasets/fridge_sales.txt">fridge_sales.txt</a> links
<ul>
<li><em>Sales of fridges</em> and <em>Sales of durable goods</em></li>
<li>to the time of year (<em>Quarter</em>)</li>
</ul></li>
<li>For the moment ignore the data on the <em>Sales of durable goods</em></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li><strong>Goal:</strong> Fit regression and analysis of variance models to link
<ul>
<li><em>Fridge sales</em> to the <em>time of the year</em></li>
</ul></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li>There are two ways this can be achieved in R
<ol type="1">
<li>A regression approach using the command <span class="math inline">\, \texttt{lm}</span></li>
<li>An analysis of variance (ANOVA) approach using the command <span class="math inline">\, \texttt{aov}</span></li>
</ol></li>
</ul>
</section>
<section id="section-25" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>Code for this example is available here <a href="datasets/anova.R">anova.R</a></p></li>
<li><p>Data is in the file <a href="datasets/fridge_sales.txt">fridge_sales.txt</a></p></li>
<li><p>The first 4 rows of the data-set are given below</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  fridge.sales durable.goods.sales Q1 Q2 Q3 Q4 Quarter
1         1317               252.6  1  0  0  0       1
2         1615               272.4  0  1  0  0       2
3         1662               270.9  0  0  1  0       3
4         1295               273.9  0  0  0  1       4</code></pre>
</div>
</div>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li>Therefore we have the variables
<ul>
<li><em>Fridge sales</em></li>
<li><em>Durable goods sales</em> <span class="math inline">\quad</span> (ignored for now)</li>
<li><em>Q1, Q2, Q3, Q4</em></li>
<li><em>Quarter</em></li>
</ul></li>
</ul>
</section>
<section id="reading-the-data-into-r" class="slide level2 smaller">
<h2>Reading the data into R</h2>
<ul>
<li>We read the data into a data-frame as usual</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset on Fridge Sales</span></span>
<span id="cb86-2"><a aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"fridge_sales.txt"</span>,</span>
<span id="cb86-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assign data-frame columns to vectors</span></span>
<span id="cb86-6"><a aria-hidden="true" tabindex="-1"></a>fridge <span class="ot">&lt;-</span> sales[ , <span class="dv">1</span>]</span>
<span id="cb86-7"><a aria-hidden="true" tabindex="-1"></a>durables <span class="ot">&lt;-</span> sales[ , <span class="dv">2</span>]</span>
<span id="cb86-8"><a aria-hidden="true" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> sales[ , <span class="dv">3</span>]</span>
<span id="cb86-9"><a aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> sales[ , <span class="dv">4</span>]</span>
<span id="cb86-10"><a aria-hidden="true" tabindex="-1"></a>q3 <span class="ot">&lt;-</span> sales[ , <span class="dv">5</span>]</span>
<span id="cb86-11"><a aria-hidden="true" tabindex="-1"></a>q4 <span class="ot">&lt;-</span> sales[ , <span class="dv">6</span>]</span>
<span id="cb86-12"><a aria-hidden="true" tabindex="-1"></a>quarter <span class="ot">&lt;-</span> sales[ , <span class="dv">7</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="processing-dummy-variables-in-r" class="slide level2 smaller">
<h2>Processing dummy variables in R</h2>
<ul>
<li>The variables <span class="math inline">\, \texttt{q1, q2, q3, q4} \,</span> are vectors taking the values <span class="math inline">\, \texttt{0}</span> and <span class="math inline">\, \texttt{1}</span>
<ul>
<li>No further data processing is needed for <span class="math inline">\, \texttt{q1, q2, q3, q4}</span></li>
<li><strong>Remember:</strong> To avoid dummy variable trap only 3 of these 4 dummy variables can be included (if the model also includes an intercept term)</li>
</ul></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li>The variable <span class="math inline">\, \texttt{quarter}</span> is a vector taking the values <span class="math inline">\, \texttt{1}, \texttt{2}, \texttt{3}, \texttt{4}</span>
<ul>
<li>Need to tell R this is a qualitative variable</li>
<li>This is done with the <span class="math inline">\, \texttt{factor}</span> command</li>
</ul></li>
</ul>
<div style="font-size: 0.10em">
<p><br></p>
</div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4
Levels: 1 2 3 4</code></pre>
</div>
</div>
</section>
<section id="regression-and-anova" class="slide level2 smaller">
<h2>Regression and ANOVA</h2>
<p>As already mentioned, there are 2 ways of fitting regression and ANOVA models in R</p>
<ol type="1">
<li>A regression approach using the command <span class="math inline">\, \texttt{lm}</span></li>
<li>An analysis of variance approach using the command <span class="math inline">\, \texttt{aov}</span></li>
</ol>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li>Both approaches lead to the same numerical answers in our example</li>
</ul>
</section>
<section id="regression-approach" class="slide level2 smaller">
<h2>Regression approach</h2>
<p>We can proceed in 2 equivalent ways</p>
<ol type="1">
<li>Use a dummy variable approach (and arbitrarily excluding <span class="math inline">\, \texttt{q1}</span>)</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># We drop q1 to avoid dummy variable trap</span></span>
<span id="cb89-2"><a aria-hidden="true" tabindex="-1"></a>dummy.lm <span class="ot">&lt;-</span> <span class="fu">lm</span> (fridge <span class="sc">~</span> q2 <span class="sc">+</span> q3 <span class="sc">+</span> q4)</span>
<span id="cb89-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dummy.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="font-size: 0.10em">
<p><br></p>
</div>
<ol start="2" type="1">
<li>Using the <span class="math inline">\, \texttt{factor}</span> command on <span class="math inline">\, \texttt{quarter}</span></li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Need to convert quarter to a factor</span></span>
<span id="cb90-2"><a aria-hidden="true" tabindex="-1"></a>quarter.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(quarter)</span>
<span id="cb90-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a aria-hidden="true" tabindex="-1"></a>factor.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(fridge <span class="sc">~</span> quarter.f)</span>
<span id="cb90-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(factor.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="font-size: 0.10em">
<p><br></p>
</div>
<ul>
<li>Get the same numerical answers using both approaches</li>
</ul>
</section>
<section id="output-for-dummy-variable-approach" class="slide level2 smaller">
<h2>Output for dummy variable approach</h2>
<div style="font-size: 0.83em">
<pre class="verbatim"><code>Call:
lm(formula = fridge ~ q2 + q3 + q4)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1222.12      59.99  20.372  &lt; 2e-16 ***
q2            245.37      84.84   2.892 0.007320 ** 
q3            347.63      84.84   4.097 0.000323 ***
q4            -62.12      84.84  -0.732 0.470091    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 169.7 on 28 degrees of freedom
Multiple R-squared:  0.5318,    Adjusted R-squared:  0.4816 
F-statistic:  10.6 on 3 and 28 DF,  p-value: 7.908e-05</code></pre>
</div>
<div style="font-size: 0.1em">
<p><br></p>
</div>
</section>
<section id="output-for-factor-approach" class="slide level2 smaller">
<h2>Output for factor approach</h2>
<div style="font-size: 0.83em">
<pre class="verbatim"><code>Call:
lm(formula = fridge ~ quarter.f)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1222.12      59.99  20.372  &lt; 2e-16 ***
quarter.f2    245.37      84.84   2.892 0.007320 ** 
quarter.f3    347.63      84.84   4.097 0.000323 ***
quarter.f4    -62.12      84.84  -0.732 0.470091    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 169.7 on 28 degrees of freedom
Multiple R-squared:  0.5318,    Adjusted R-squared:  0.4816 
F-statistic:  10.6 on 3 and 28 DF,  p-value: 7.908e-05
</code></pre>
</div>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li><p>The two outputs are essentially the same (only difference is variables names)</p></li>
<li><p><span class="math inline">\, \texttt{quarter.f}</span> is a factor with four levels <span class="math inline">\, \texttt{1}, \texttt{2}, \texttt{3}, \texttt{4}</span></p></li>
<li><p>Variables <span class="math inline">\, \texttt{quarter.f2}, \texttt{quarter.f3}, \texttt{quarter.f4}</span> refer to the levels <span class="math inline">\, \texttt{2}, \texttt{3}, \texttt{4}</span> in <span class="math inline">\, \texttt{quarter.f}</span></p></li>
</ul>
</section>
<section id="output-for-factor-approach-1" class="slide level2 smaller">
<h2>Output for factor approach</h2>
<div style="font-size: 0.83em">
<pre class="verbatim"><code>Call:
lm(formula = fridge ~ quarter.f)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1222.12      59.99  20.372  &lt; 2e-16 ***
quarter.f2    245.37      84.84   2.892 0.007320 ** 
quarter.f3    347.63      84.84   4.097 0.000323 ***
quarter.f4    -62.12      84.84  -0.732 0.470091    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 169.7 on 28 degrees of freedom
Multiple R-squared:  0.5318,    Adjusted R-squared:  0.4816 
F-statistic:  10.6 on 3 and 28 DF,  p-value: 7.908e-05
</code></pre>
</div>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li><p><span class="math inline">\, \texttt{lm}</span> is treating <span class="math inline">\, \texttt{quarter.f2}, \texttt{quarter.f3}, \texttt{quarter.f4}</span> as if they were dummy variables</p></li>
<li><p>Note that <span class="math inline">\, \texttt{lm}</span> automatically drops <span class="math inline">\, \texttt{quarter.f1}</span> to prevent dummy variable trap</p></li>
<li><p>Thus <span class="math inline">\, \texttt{lm}</span> behaves the same way as if we passed dummy variables <span class="math inline">\, \texttt{q2}, \texttt{q3}, \texttt{q4}</span></p></li>
</ul>
</section>
<section id="computing-regression-coefficients" class="slide level2 smaller">
<h2>Computing regression coefficients</h2>
<div style="font-size: 0.86em">
<pre class="verbatim"><code>Call:
lm(formula = fridge ~ q2 + q3 + q4)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1222.12      59.99  20.372  &lt; 2e-16 ***
q2            245.37      84.84   2.892 0.007320 ** 
q3            347.63      84.84   4.097 0.000323 ***
q4            -62.12      84.84  -0.732 0.470091    </code></pre>
</div>
<div style="font-size: 0.3em">
<p><br></p>
</div>
<ul>
<li><p>Recall that <span class="math inline">\, \texttt{Intercept}</span> refers to coefficient for <span class="math inline">\, \texttt{q1}</span></p></li>
<li><p>Coefficients for <span class="math inline">\, \texttt{q2}, \texttt{q3}, \texttt{q4}</span> are obtained by summing <span class="math inline">\, \texttt{Intercept}</span> to coefficient in appropriate row</p></li>
</ul>
</section>
<section id="computing-regression-coefficients-1" class="slide level2 smaller">
<h2>Computing regression coefficients</h2>
<div style="font-size: 0.86em">
<pre class="verbatim"><code>Call:
lm(formula = fridge ~ q2 + q3 + q4)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1222.12      59.99  20.372  &lt; 2e-16 ***
q2            245.37      84.84   2.892 0.007320 ** 
q3            347.63      84.84   4.097 0.000323 ***
q4            -62.12      84.84  -0.732 0.470091    </code></pre>
</div>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<div style="font-size: 0.9em">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Dummy variable</th>
<th style="text-align: center;">Coefficient formula</th>
<th style="text-align: center;">Estimated coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\texttt{q1}</span></td>
<td style="text-align: center;"><span class="math inline">\beta_1</span></td>
<td style="text-align: center;"><span class="math inline">1222.12</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\texttt{q2}</span></td>
<td style="text-align: center;"><span class="math inline">\beta_1 + \beta_2</span></td>
<td style="text-align: center;"><span class="math inline">1222.12 + 245.37 = 1467.49</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\texttt{q3}</span></td>
<td style="text-align: center;"><span class="math inline">\beta_1 + \beta_3</span></td>
<td style="text-align: center;"><span class="math inline">1222.12 + 347.63 = 1569.75</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\texttt{q4}</span></td>
<td style="text-align: center;"><span class="math inline">\beta_1 + \beta_4</span></td>
<td style="text-align: center;"><span class="math inline">1222.12 - 62.12 = 1160</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="regression-formula" class="slide level2 smaller">
<h2>Regression formula</h2>
<ul>
<li>Therefore the linear regression formula obtained is</li>
</ul>
<p><span class="math display">\begin{align*}
{\rm I\kern-.3em E}[\text{ Fridge sales } ] = &amp; \,\, 1222.12 \times \, \text{Q1} +
1467.49 \times \, \text{Q2} + \\[15pts]
&amp; \,\, 1569.75 \times \, \text{Q3} + 1160 \times \, \text{Q4}
\end{align*}</span></p>
<ul>
<li>Recall that Q1, Q2, Q3 and Q4 assume only values 0 / 1 and</li>
</ul>
<p><span class="math display">
\text{Q1} + \text{Q2} + \text{Q4} + \text{Q4} = 1
</span></p>
</section>
<section id="sales-estimates" class="slide level2 smaller">
<h2>Sales estimates</h2>
<p>Therefore the expected sales for each quarter are</p>
<p><span class="math display">\begin{align*}
{\rm I\kern-.3em E}[\text{ Fridge sales } | \text{ Q1 } = 1] &amp; = 1222.12 \\[15pts]
{\rm I\kern-.3em E}[\text{ Fridge sales } | \text{ Q2 } = 1] &amp; = 1467.49 \\[15pts]
{\rm I\kern-.3em E}[\text{ Fridge sales } | \text{ Q3 } = 1] &amp; = 1569.75 \\[15pts]
{\rm I\kern-.3em E}[\text{ Fridge sales } | \text{ Q4 } = 1] &amp; = 1160 \\[15pts]
\end{align*}</span></p>
</section>
<section id="anova-for-the-same-problem" class="slide level2 smaller">
<h2>ANOVA for the same problem</h2>
<ul>
<li><p>First of all: <strong>What is ANOVA?</strong></p></li>
<li><p>ANOVA stands for Analysis of Variance</p></li>
<li><p>ANOVA is used to compare means of independent populations:</p>
<ul>
<li>Suppose to have <span class="math inline">M</span> normally distributed populations <span class="math inline">N(\mu_k, \sigma^2)</span> <span class="math inline">\,\,\,\,\qquad</span> (with same variance)</li>
<li>The goal is to compare the populations averages <span class="math inline">\mu_k</span></li>
<li>For <span class="math inline">M = 2</span> this can be done with the two-sample t-test</li>
<li>For <span class="math inline">M &gt; 2</span> we use ANOVA</li>
</ul></li>
</ul>
<p><strong>ANOVA is a generalization of two-sample t-test to multiple populations</strong></p>
</section>
<section id="the-anova-f-test" class="slide level2 smaller">
<h2>The ANOVA F-test</h2>
<ul>
<li>To compare populations averages we use the hypotheses</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \mu_{1} =  \mu_{2} =  \ldots =  \mu_{M}  \\
H_1 &amp; \colon  \mu_i \neq \mu_j \, \text{ for at least one pair i and j}
\end{align*}</span></p>
<ul>
<li><p>To decide on the above hypothesis we use the <strong>ANOVA F-test</strong></p></li>
<li><p>We omit mathematical details. All you need to know is that</p>
<ul>
<li>ANOVA F-test is performed in R with the function <span class="math inline">\, \texttt{aov}</span></li>
<li>This function outputs the so-called ANOVA table</li>
<li>ANOVA table contains the F-statistic and relative p-value for ANOVA F-test</li>
</ul></li>
</ul>
<p><strong>If <span class="math inline">p &lt; 0.05</span> we reject <span class="math inline">H_0</span> and there is a difference in populations averages</strong></p>
</section>
<section id="anova-f-test-for-fridge-sales" class="slide level2 smaller">
<h2>ANOVA F-test for fridge sales</h2>
<ul>
<li>In the <em>Fridge Sales</em> example we wish to compare <em>Fridge sales numbers</em>
<ul>
<li>We have <em>Fridge Sales</em> data for each quarter</li>
<li>Each <em>Quarter</em> represents a population</li>
<li>We want to compare average fridge sales for each Quarter</li>
</ul></li>
</ul>
<div style="font-size: 0.20em">
<p><br></p>
</div>
<ul>
<li><strong>ANOVA hypothesis test:</strong> is there a difference in average sales for each Quarter?
<ul>
<li>If <span class="math inline">\mu_{i}</span> is average sales in Quarter <span class="math inline">i</span> then <span class="math display">\begin{align*}
  H_0 &amp; \colon \mu_{1} =  \mu_{2} =  \mu_{3} =  \mu_{4}  \\
  H_1 &amp; \colon  \mu_i \neq \mu_j \, \text{ for at least one pair i and j}
  \end{align*}</span></li>
</ul></li>
</ul>
</section>
<section id="plotting-the-data" class="slide level2 smaller">
<h2>Plotting the data</h2>
<div class="column" style="width:44%;">
<p><br></p>
<p><br></p>
<ul>
<li>Plot Quarter against Fridge sales</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(quarter, fridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>We clearly see 4 populations</p></li>
<li><p>Averages appear different</p></li>
</ul>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_files/figure-revealjs/unnamed-chunk-43-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></section>
<section id="anova-f-test-for-fridge-sales-1" class="slide level2 smaller">
<h2>ANOVA F-test for fridge sales</h2>
<ul>
<li>To implement ANOVA F-test in R you need to use command <span class="math inline">\, \texttt{factor}</span></li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Turn vector quarter into a factor</span></span>
<span id="cb97-2"><a aria-hidden="true" tabindex="-1"></a>quarter.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="font-size: 0.3em">
<p><br></p>
</div>
<ul>
<li>The factor <span class="math inline">\, \texttt{quarter.f} \,</span> allows to <em>label</em> the <em>fridge sales</em> data
<ul>
<li>Factor level <span class="math inline">\, \texttt{k} \,</span> corresponds to <em>fridge sales</em> in Quarter <span class="math inline">k</span></li>
</ul></li>
</ul>
<div style="font-size: 0.3em">
<p><br></p>
</div>
<ul>
<li>To perform the ANOVA F-test do</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA model</span></span>
<span id="cb98-2"><a aria-hidden="true" tabindex="-1"></a>factor.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(fridge <span class="sc">~</span> quarter.f)</span>
<span id="cb98-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print output</span></span>
<span id="cb98-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(factor.aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="anova-output" class="slide level2 smaller">
<h2>ANOVA output</h2>
<ul>
<li>The summary gives the following analysis of variance (ANOVA) table</li>
</ul>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<pre class="verbatim"><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
quarter.f    3 915636  305212    10.6 7.91e-05 ***
Residuals   28 806142   28791                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</code></pre>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<ul>
<li><p>The F-statistic for the ANOVA F-test is <span class="math inline">\,\, F = 10.6</span></p></li>
<li><p>The p-value for ANOVA F-test is <span class="math inline">\,\, p = 7.91 \times 10^{-5}</span></p></li>
<li><p>Therefore <span class="math inline">p &lt; 0.05</span> and we reject <span class="math inline">H_0</span></p>
<ul>
<li>Evidence that average Fridge sales are different in at least two quarters</li>
</ul></li>
</ul>
</section>
<section id="anova-f-statistic-from-regression" class="slide level2 smaller">
<h2>ANOVA F-statistic from regression</h2>
<p><strong>Alternative way to get ANOVA F-statistic:</strong> Look at output of dummy variable model</p>
<p><span class="math display">
\texttt{lm(fridge} \, \sim \, \texttt{q2 + q3 + q4)}
</span></p>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<pre class="verbatim"><code>Residual standard error: 169.7 on 28 degrees of freedom
Multiple R-squared:  0.5318,    Adjusted R-squared:  0.4816 
F-statistic:  10.6 on 3 and 28 DF,  p-value: 7.908e-05</code></pre>
<div style="font-size: 0.5em">
<p><br></p>
</div>
<ul>
<li>The F-test for <strong>overall fit</strong> gives
<ul>
<li>F-statistic <span class="math inline">\,\, F = 10.6</span></li>
<li>p-value <span class="math inline">\,\, p = 7.908 \times 10^{-5}</span></li>
</ul></li>
</ul>
<p><strong>These always coincide with F-statistic and p-value for ANOVA F-test! <span class="math inline">\quad</span> Why?</strong></p>
</section></section>
<section>
<section id="part-5-anova-f-test-and-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br> ANOVA F-test <br> and regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="anova-f-test-and-regression" class="slide level2 smaller">
<h2>ANOVA F-test and regression</h2>
<ul>
<li><strong>ANOVA F-test equivalent to F-test for overall significance</strong></li>
</ul>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li>This happens because
<ul>
<li><strong>Linear regression can be used to perform ANOVA F-test</strong></li>
</ul></li>
</ul>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li>We have already seen a particular instance of this fact in the Homework
<ul>
<li><strong>Simple linear regression can be used to perform two-sample t-test</strong></li>
</ul></li>
</ul>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<ul>
<li>This was done by considering the model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta \, 1_B (i) + \varepsilon_i
</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<p>In more details:</p>
<ul>
<li><p><span class="math inline">A</span> and <span class="math inline">B</span> are two normal populations <span class="math inline">N(\mu_A, \sigma^2)</span> and <span class="math inline">N(\mu_B, \sigma^2)</span></p></li>
<li><p>We have two samples</p>
<ul>
<li>Sample of size <span class="math inline">n_A</span> from population <span class="math inline">A</span> <span class="math display">
a = (a_1, \ldots, a_{n_A})
</span></li>
<li>Sample of size <span class="math inline">n_B</span> from population <span class="math inline">B</span> <span class="math display">
b = (b_1, \ldots, b_{n_B})
</span></li>
</ul></li>
</ul>
</section>
<section id="simple-regression-for-two-sample-t-test-1" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>The data vector <span class="math inline">y</span> is obtained by concatenating <span class="math inline">a</span> and <span class="math inline">b</span></li>
</ul>
<p><span class="math display">
y = (a,b) = (a_1, \ldots, a_{n_A}, b_1, \ldots, b_{n_B} )
</span></p>
<ul>
<li>We then considered the dummy variable model</li>
</ul>
<p><span class="math display">
Y_i = \alpha + \beta \, 1_B (i) + \varepsilon_i
</span></p>
<ul>
<li>Here <span class="math inline">1_B (i)</span> is the dummy variable relative to population <span class="math inline">B</span></li>
</ul>
<p><span class="math display">
1_B(i) = \begin{cases}
1 &amp; \text{ if i-th sample belongs to population B} \\
0 &amp; \text{ otherwise}
\end{cases}
</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test-2" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>The regression function is therefore</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = x] = \alpha + \beta x
</span></p>
<ul>
<li>By construction we have that</li>
</ul>
<p><span class="math display">
Y | \text{sample belongs to population A}  \ \sim \ N(\mu_A, \sigma^2)
</span></p>
<ul>
<li>Therefore by definition of <span class="math inline">1_B</span> we get</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = 0] = {\rm I\kern-.3em E}[Y | \text{ sample belongs to population A}] = \mu_A
</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test-3" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>On the other hand, the regression function is</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = x] = \alpha + \beta x
</span></p>
<ul>
<li>Thus</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = 0] = \alpha + \beta \cdot 0 = \alpha
</span></p>
<ul>
<li><p>Recall that <span class="math inline">\, {\rm I\kern-.3em E}[Y | 1_B = 0] = \mu_A</span></p></li>
<li><p>Hence we get</p></li>
</ul>
<p><span class="math display">
\alpha = \mu_A
</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test-4" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>Similarly, we get that</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = 1] = {\rm I\kern-.3em E}[Y | \text{ sample belongs to population B}] = \mu_B
</span></p>
<ul>
<li>On the other hand, using the regression function we get</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_B = 1] = \alpha + \beta \cdot 1 = \alpha + \beta
</span></p>
<ul>
<li>Therefore</li>
</ul>
<p><span class="math display">
\alpha + \beta = \mu_B
</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test-5" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>Since <span class="math inline">\alpha = \mu_A</span> we get</li>
</ul>
<p><span class="math display">
\alpha + \beta = \mu_B  \quad \implies \quad \beta = \mu_B - \mu_A
</span></p>
<ul>
<li>In particular we have shown that the regression model is</li>
</ul>
<p><span class="math display">\begin{align*}
Y_i &amp; = \alpha + \beta \, 1_{B} (i) + \varepsilon_i \\[10pts]
    &amp; = \mu_A + (\mu_B - \mu_A) \, 1_{B} (i) + \varepsilon_i
\end{align*}</span></p>
</section>
<section id="simple-regression-for-two-sample-t-test-6" class="slide level2 smaller">
<h2>Simple regression for two-sample t-test</h2>
<ul>
<li>F-test for overall significance for previous slide model is</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon \beta = 0 \\
H_1 \colon \beta \neq 0
\end{align*}</span></p>
<ul>
<li>Since <span class="math inline">\beta = \mu_B - \mu_A</span> the above is equivalent to</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 \colon \mu_A = \mu_B \\
H_1 \colon \mu_A \neq \mu_B
\end{align*}</span></p>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<p><strong>F-test for overall significance is equivalent to two-sample t-test</strong></p>
</section>
<section id="anova-f-test-and-regression-1" class="slide level2 smaller">
<h2>ANOVA F-test and regression</h2>
<p>We now consider the general ANOVA case</p>
<ul>
<li>Suppose to have <span class="math inline">M</span> populations <span class="math inline">A_i</span> with normal distribution <span class="math inline">N(\mu_i,\sigma^2)</span> <span class="math inline">\qquad</span> (with same variance)</li>
</ul>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li><strong>Example:</strong> In Fridge sales example we have <span class="math inline">M = 4</span> populations (the 4 quarters)</li>
</ul>
<div style="font-size: 0.1em">
<p><br></p>
</div>
<ul>
<li>The ANOVA F-test for difference in populations means is</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \mu_1 = \mu_2 = \ldots =  \mu_M  \\
H_1 &amp; \colon \mu_i \neq \mu_j \text{ for at least one pair i and j}
\end{align*}</span></p>
<ul>
<li><strong>Goal:</strong> Show that the above test can be obtained with regression</li>
</ul>
</section>
<section id="setting-up-dummy-variable-model" class="slide level2 smaller">
<h2>Setting up dummy variable model</h2>
<ul>
<li><p>We want to introduce dummy variable regression model which models ANOVA</p></li>
<li><p>To each population <span class="math inline">A_i</span> associate a dummy variable</p></li>
</ul>
<p><span class="math display">
1_{A_i}(i) = \begin{cases}
1 &amp; \text{ if i-th sample belongs to population } A_i \\
0 &amp; \text{ otherwise} \\
\end{cases}
</span></p>
<ul>
<li><p>Suppose to have samples <span class="math inline">a_i</span> of size <span class="math inline">n_{A_i}</span> from population <span class="math inline">A_i</span></p></li>
<li><p>Concatenate these samples into a long vector (length <span class="math inline">n_{A_1} + \ldots + n_{A_M}</span>)</p></li>
</ul>
<p><span class="math display">
y = (a_1, \ldots, a_M)
</span></p>
</section>
<section id="setting-up-dummy-variable-model-1" class="slide level2 smaller">
<h2>Setting up dummy variable model</h2>
<ul>
<li>Consider the dummy variable model (with <span class="math inline">1_{A_1}</span> omitted)</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 + \beta_2 \, 1_{A_2} (i) + \beta_3 \, 1_{A_3} (i) +  \ldots  + \beta_M \, 1_{A_M} (i) + \varepsilon_i
</span></p>
<ul>
<li>The regression function is therefore</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[Y | 1_{A_2} = x_2 , \, \ldots, \, 1_{A_M} = x_M ] = \beta_1 + \beta_2 \, x_2 +  \ldots  + \beta_M \, x_M
</span></p>
<ul>
<li>By construction we have that</li>
</ul>
<p><span class="math display">
Y | \text{sample belongs to population } A_i \ \sim \ N(\mu_i , \sigma^2)
</span></p>
</section>
<section id="conditional-expectations" class="slide level2 smaller">
<h2>Conditional expectations</h2>
<ul>
<li>The sample belongs to population <span class="math inline">A_1</span> if and only if</li>
</ul>
<p><span class="math display">
1_{A_2} = 1_{A_3} = \ldots = 1_{A_M} = 0
</span></p>
<ul>
<li>Hence we can compute the conditional expectation</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[ Y | 1_{A_2} = 0 , \, \ldots, \, 1_{A_M} = 0] =
{\rm I\kern-.3em E}[Y | \text{sample belongs to population } A_1] = \mu_1
</span></p>
<ul>
<li>On the other hand, by definition of regression function, we get</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[ Y | 1_{A_2} = 0 , \, \ldots, \, 1_{A_M} = 0] = \beta_1 + \beta_2 \cdot 0 + \ldots + \beta_M \cdot 0 = \beta_1
</span></p>
<ul>
<li>We conclude that <span class="math inline">\,\, \mu_1 = \beta_1</span></li>
</ul>
</section>
<section id="conditional-expectations-1" class="slide level2 smaller">
<h2>Conditional expectations</h2>
<ul>
<li>Similarly, the sample belongs to population <span class="math inline">A_2</span> if and only if</li>
</ul>
<p><span class="math display">
1_{A_2} = 1 \quad \text{and} \quad 1_{A_1} = 1_{A_3} = \ldots = 1_{A_M} = 0
</span></p>
<ul>
<li>Hence we can compute the conditional expectation</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[ Y | 1_{A_2} = 1 , \, \ldots, \, 1_{A_M} = 0] =
{\rm I\kern-.3em E}[Y | \text{sample belongs to population } A_2] = \mu_2
</span></p>
<ul>
<li>On the other hand, by definition of regression function, we get</li>
</ul>
<p><span class="math display">
{\rm I\kern-.3em E}[ Y | 1_{A_2} = 1 , \, \ldots, \, 1_{A_M} = 0] = \beta_1 + \beta_2 \cdot 1 + \ldots + \beta_M \cdot 0 = \beta_1 + \beta_2
</span></p>
<ul>
<li>We conclude that <span class="math inline">\,\, \mu_2 = \beta_1 + \beta_2</span></li>
</ul>
</section>
<section id="conditional-expectations-2" class="slide level2 smaller">
<h2>Conditional expectations</h2>
<ul>
<li>We have shown that</li>
</ul>
<p><span class="math display">
\mu_1 = \beta_1 \quad \text{ and } \quad \mu_2 = \beta_1 + \beta_2
</span></p>
<ul>
<li>Therefore we obtain</li>
</ul>
<p><span class="math display">
\beta_1 = \mu_1 \quad \text{ and } \quad \beta_2 = \mu_2 - \mu_1
</span></p>
<ul>
<li>Arguing in a similar way, we can show that also</li>
</ul>
<p><span class="math display">
\beta_i = \mu_i - \mu_1  \qquad \forall \, i &gt; 1
</span></p>
</section>
<section id="conclusion" class="slide level2 smaller">
<h2>Conclusion</h2>
<ul>
<li>The considered dummy variable model is</li>
</ul>
<p><span class="math display">\begin{align*}
Y_i &amp; = \beta_1 + \beta_2 \, 1_{A_2} (i) +   \ldots  + \beta_M \, 1_{A_M} (i) + \varepsilon_i
\end{align*}</span></p>
<ul>
<li>The F-test of overall significance for the above regression model is</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon  \beta_2 = \beta_3 = \ldots = \beta_M = 0 \\
H_1 &amp; \colon \text{ At least one of the above } \beta_j \neq 0
\end{align*}</span></p>
<ul>
<li>We have also shown that</li>
</ul>
<p><span class="math display">
\beta_1 = \mu_1 \,, \qquad \beta_i = \mu_i - \mu_1 \quad \forall \,  i &gt; 1
</span></p>
</section>
<section id="section-26" class="slide level2 smaller">
<h2></h2>
<ul>
<li>In particular we obtain</li>
</ul>
<p><span class="math display">\begin{align*}
\beta_2 =  \ldots = \beta_M = 0 &amp; \quad \iff
\quad \mu_2 - \mu_1 =  \ldots = \mu_M - \mu_1 = 0 \\[10pts]
&amp; \quad \iff \quad \mu_2 = \ldots = \mu_M = \mu_1
\end{align*}</span></p>
<ul>
<li>Thefore the F-test for overall significance is equivalent to ANOVA F-test</li>
</ul>
<p><span class="math display">\begin{align*}
H_0 &amp; \colon \mu_1 = \mu_2 = \ldots = \mu_M \\
H_1 &amp; \colon \mu_i \neq \mu_j \text{ for at least one pair i and j}
\end{align*}</span></p>
<div style="font-size: 0.2em">
<p><br></p>
</div>
<p><strong>F-test for overall significance is equivalent to ANOVA F-test</strong></p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-gujarati_porter" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Gujarati, D. N., Porter, D. C., Basic econometric, fifth edition, McGraw-Hill, 2009.</div>
</div>
<div id="ref-draper_smith" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Draper, N. R., Smith, H., Applied regression analysis, Wiley, 1998.</div>
</div>
<div id="ref-shumway" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">Shumway, R. H., Stoffer, D. S., Time series analysis and its applications, fourth edition, Springer, 2017.</div>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>